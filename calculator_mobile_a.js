var insert_flag="yes";   
var PIMUL2S ="6.283185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234135964296173026564613294187689219101164463450718816256962234900568205403877042211119289245897909860763928857621951331866892256951296467573566330542403818291297133846920697220908653296426787214520498282547";
var PIS ="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245";
var PIDIV2S="1.5707963267948966192313216916397514420985846996875529104874722961539082031431044993140174126710585339910740432566411533235469223047752911158626797040642405587251420513509692605527798223114744774651909822144054878329667230642378241168933915826356009545728242834617301743052271633241066968036301245706368";
var PIDIV4S="0.7853981633974483096156608458198757210492923498437764552437361480769541015715522496570087063355292669955370216283205766617734611523876455579313398520321202793625710256754846302763899111557372387325954911072027439164833615321189120584466957913178004772864121417308650871526135816620533484018150622853184";
var SQRT2S="1.41421356237309504880168872420969807856967187537694807317667973799073247846210703885038753432764157273501384623091229702492483605585073721264412149709993583141322266592750559275579995050115278206057147010955997160597027453459686201472851741864088919860955232923048430871432145083976260362799525140798968";
var LN2S  = "0.6931471805599453094172321214581765680755001343602552541206800094933936219696947156058633269964186875420014810205706857336855202357581305570326707516350759619307275708283714351903070386238916734711233501153644979552391204751726815749320651555247341395258829504530070953263666426541042391578149520437404";
var LN3S  = "1.0986122886681096913952452369225257046474905578227494517346943336374942932186089668736157548137320887879700290659578657423680042259305198210528018707672774106031627691833813671793736988443609599037425703167959115211455919177506713470549401667755802222031702529468975606901065215056428681380363173732985";
var LN5S  = "1.6094379124341003746007593332261876395256013542685177219126478914741789877076577646301338780931796107999663030217155628997240052293246761996336166174637057275521796374971832456534928562023415250572701551936008797773897256881935407127661547312218095279485212928213580597225676722852872404615894481783646";
var LN7S  = "1.9459101490553133051053527434431797296370847295818611884593901499375798627520692677876584985878715269930616942058511409117237522576777868431489580951639007759078244681042747833822593490084673744125049737048535517678355774862401510277418088686710751412134809387974183108102518231684930140733063932877119";
var LN10S = "2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051";
var LN11S = "2.3978952727983705440619435779651292998217068539374171752185677091305736239132367130750547080026347914147157258881379985222555691585957873953553023908011080650516419066806750965894606679379382466690546638056872869953971661606329027001611370030676832876130320305318941401705761951443383638182978552274969";
var LN13S = "2.5649493574615367360534874415653186048052679447602071164190455106634646673244101793995746634404894887692581920927627216315321544919865870138252681169722977517836970804775620441045659011793899943427395947399275040613896086334005538985298095873079411675803665011875546489947041820286026814195009782150288";
var LN17S = "2.8332133440562160802495346178731265355882030125857447872972377378822925758009312809120948680375029475183482620471870572913975928419467383642997545657420212712599132080720904790764716817251666602966085069091968139613451492951641920944718693932548133184689444503758003156460299305896372700032736297592739";
var LN19S = "2.9444389791664404600090274318878535372373792612991288185379602364092927020641972887141583838157398957970406332207501363490219537906813206112646333285371564314166986137818787130140620007209672701647218906225848088488147724018499106539837744249253566419861248378838520868607729597915909767238024363159602";
var LN23S ="3.13549421592914969080675283181019611844238031484043574199863537748299324598479829819840109215299481435419721357133013689585872863503633780457549695796427532985074182631471880860698595650613051454941206818505396376031512059740356185507004513807926994392730239218403575591302511033746709648063038993832212";
var LN29S ="3.36729582998647402718327203236191160549451291392274407892167035164278078113785233329336711481785642264599958472516683472655830331117918460754327457697561925885486559225938944924029126511577900660161839735856341783877161179091219923099329170080618186301317693093618300890107554579422597460636881461370638";
var LN31S ="3.43398720448514624592916432454235721044993893048059197175671807247498141659755123221386483133608663057297693688903984481487054321435271299977686434916127045522026613063121621192885988191474687820292206438258321801055613699318202665762285216351765751197686266435798409373427098779253021588461857911760483";
var LN37S ="3.61091791264422444436809567103144716390007758716763616364491268119298974699036106539902153367216866078180895229089566738578157929844395474651021206889102611499814162216423038070230892316272517737133653198554154119834176310377277745819864987957152948772127335288472904455496265318412325272474757135631645";
var LN41S ="3.71357206670430780386676337303740758837641046939930163361926291025997861640565750596231714137198681103799048939537449184675063116423590603925401159243975910508421649825728218170963216183649210170922095212021516868760488805913486307917619093044354565313418416123583997070473180925370972951740272285748007";
var LN43S ="3.76120011569356242347284251334584703555913618488155541519168526492285917387298643853759199808399728689750568036809679154775955038191048362058129712653262783417110712689914315423672982007294380523145271775050314154886446131747852976981579044443487178590121043053242522052238561294819569993785993817979141";
var LN47S ="3.85014760171005858682095066977217370889605050202022403320050834680681821350580107261068975343474598095645157390101751072903275706164311500960585173392958279355185374019004187991444864627580628305346062377464174819660878721477589933308131992257703115308296821275973224121950002301201794701939039751021661";
var LN53S ="3.97029191355212183414446913902905777035997775291121760304812947001800463394348985853465994448592122984211382048109086301833621007767775711087880293989916368027572043299327961994309740818843320362415251325105258784461125850209718226881277299622106638217827319946454587197432999528547572212827740028931722";
var LN59S ="4.07753744390571945061605037371969762406334678933045452951203669705920011426542747735933995980263376901044387955588496228305125710651956003151847194836288904935031098896396889860519826422310167357324609726681794417230416397555688048697681900994633711150790052197660379362734818345066003851772851537820207";
var LN61S ="4.11087386417331124875138910342561474631568174308126106293738364641943980684494873118542920610010377302347289224263257059796525983033780950939532747727959938847220861090150604902169038128959726042157767354476003648651139330475591739634925460107710482405066237628692081461923128661027218059731252198167401";
var LN67S ="4.20469261939096605967007199636372275056693290322189533713778413077526850552808689663891418782102548453396219126466001419698720648332753636883180775491804238331353536396333386077365980233691946169579949106709218350883742056315697021043589143311570072268864644743736561762148459920098519462846773059187028";
var LN71S ="4.26267987704131542132945453251303409675957652671056610812142580202735150682423036596624332427263513354094635034572111238545755799639688206266765239254674923810062974892487169559122200442268580284110267162045223803586972840487333244378667812806156676733507408058626798186864504113261853558321299296568376";
var LN73S ="4.29045944114839112909210885743854257090475284487159766459569885716178997592059729327632932283485889425403142440139172174212010860468753849949378149965177228663712529885591191696179839525477087827647572785741344551494521434796739711854268571457797021290375233008628630894478156018848580503283151869313668";
var LN79S ="4.36944785246702149417294554148141092217354122442260962541217111755980606112443227814594036577407960663830281749583465259214701543466829497850735521975082630360531456361746147622547844870468858318135175671939271042998498873016191917764911498938060957183245220317205815159871371166015212771275339627991184";
var LN83S ="4.41884060779659792347547222329137045302931305666323637018794346293857898988899060583842729697057343422795273806345062907970222335648501183150082770508554549673874879555677338289537273552805774289663755882964082158486827429101075480902576631562671542705652562320362111568225064188983371406351312685555184";
var LN89S ="4.48863636973213983831781554066984921940466038713295936410669757728795389277945624644706355194947574301728816622678194714310095034438802222658767018741210056849701848239812367294972348674604818120240337854339535380817419252123065234910706404141443973084475397983425427140378272957594778877876539624226184";
var LN97S ="4.57471097850338282211672162170396171380891490265878135597623436876017729177818712534228274503427454992695068064837970662753799135355895969188445273029578412840687860839556310976343588148642308813748063599091829860864826338491545526791275011755833456490759004954331070405689280108596198228987118639202017";
var E1S="2.71828182845904523536028747135266249775724709369995957496696762772407663035354759457138217852516642742746639193200305992181741359662904357290033429526059563073813232862794349076323382988075319525101901157383418793070215408914993488416750924476146066808226480016847741185374234544243710753907774499206955170";
var DEGS="0.0174532925199432957692369076848861271344287188854172545609719144017100911460344944368224156963450948221230449250737905924838546922752810123984742189340471173191682450150107695616975535812386053051687886912711720870329635896026424901877043509181733439396980475940192241589469684813789632978181124952292984";
var π= PIS;
var ln10 = LN10S;
var ln2 = LN2S ;
var SIN09DS="0.156434465040230869010105319467166892313899892085660790084641346057758793305623579336695872676848688375140300847680446937398178819070625499302226840832214122991451599282569833595264414776895836512260377580456827300235182216762796982183068184753704096064807513823680089021403524065849605203125283418644";
var SIN15DS="0.258819045102520762348898837624048328349068901319930513814003207315056974748801996922367974694249665520895188748925473024983507350996755032245415613534335680353922520400042744622957538692439747040727460142356679811915542204487185504770072880183424092309255598782704958888987191333609808668021584599962";
var SIN18DS="0.309016994374947424102293417182819058860154589902881431067724311352630231409451224853603602094695568742377044037693445876063316931111768465896590030383363177216694543297969791452819161330659964145133940337604383446250855848103516110521608134774313148156807219074879350610170402943977227374623092847682";
var SIN30DS="0.5";
var SIN36DS="0.587785252292473129168705954639072768597652437643145991072272480757278474162351957508504049862741335960053131602752659366338930325935907730532605932244639247267533498281326306790797948584416132696440466930435833235417980827509164031065494672950798448105477094420362852413584676448742934769004069073154";
var SIN45DS="0.707106781186547524400844362104849039284835937688474036588339868995366239231053519425193767163820786367506923115456148512462418027925368606322060748549967915706611332963752796377899975250576391030285735054779985802985137267298431007364258709320444599304776164615242154357160725419881301813997625703995";
var SIN54DS="0.809016994374947424102293417182819058860154589902881431067724311352630231409451224853603602094695568742377044037693445876063316931111768465896590030383363177216694543297969791452819161330659964145133940337604383446250855848103516110521608134774313148156807219074879350610170402943977227374623092847682";
var SIN60DS="0.866025403784438646763723170752936183471402626905190314027903489725966508454400018540573093378624287837813070707703351514984972547499476239405827756047186824264046615951152791033987410050542337461632507656171633451661443325336127334460918985613523565830183930794009524993268689929694733825173753288025";
var SIN72DS="0.951056516295153572116439333379382143405698634125750222447305644430153170085193501718792810970811381675899717551403004208987066193769699926315212270313182378785777437970401032718217100921001518052604005695211699183668732032878420145205980594031520561291124183948360178127527540337397868520519684337034";
var SIN75DS="0.965925826289068286749743199728897367633904839008404550402343076310423213979855516347561741858070451888402111864381621537445925378922123638567476362084303596060533853363795541000857513943016138071013195197136665614900679471785616512134331589503868691614031763397947113246147916753491110482019210303957";
var SIN81DS="0.987688340595137726190040247693437260758406861589880434923904801638072935969712735711963037999886778605449981748257641105970244202505528807531433432617808310698084481494121549758473111216920693873913511276165559873875280532147510835968826679358670689044673496371042570295426618293297186754705269834527";
var SIN00RS="0";
var SIN01RS="0.841470984807896506652502321630298999622563060798371065672751709991910404391239668948639743543052695854349037907920674293259118920991898881193410327729212409480791955826766606999907764011978408782732566347484802870298656157017962455394893572924670127086486281053382030561377218203868449667761674266239";
var SIN02RS="0.909297426825681695396019865911744842702254971447890268378973011530967301540783544620126688924959380309967896742399486261280953108675328120270020339746773782848379310196966997749843570475165175480987342455168848662665993978420585604835287376524606630194296559211884583581948950133499869188358271006255";
var SIN03RS="0.141120008059867222100744802808110279846933264252265584151882641232422009967014471911282172853449863750413672948267327416844457031668857573754033657854911217811785476834820782166764137215566658864689844031538330125152783590765223504441950944889833925545622241603836241829395442591744103664574056654115";
var SIN04RS="-0.756802495307928251372639094511829094135912887336472571485416773401310493619179416423572810562422748087699697166423078137728647574273235152577790455830940809499933219033922843754176855488705163947463293752718443712970922914610954499177374304528799220093082086761450519018556008947020563039572501508396";
var SIN05RS="-0.958924274663138468893154406155993973352461543964601778131672454235102558086559603076995955429532866596530638461663378937191401701120565790172296474531101710920588004560894397857837660160741993818639433618112356829349413078037023872411662624745736372086015471133622853226224330628952660508525457264421";
var SIN06RS="-0.279415498198925872811555446611894759627994864318204318483351369653311154058644334854668938452842247623009736379177458452620380344623149407006295290693016672658901761640585763467633834009777446707151639293104039508812599058838925988166441673040886825102273436493122153995911858982709238009609891424743";
var SIN07RS="0.656986598718789090396999091593635177936870010497490074657854334189292837131227031509935121601055212681293170521097576396750874788286308574284783147258984567314139201741938088915189369580601969604956840193564350394979178450477779671163046350319798958992833116986450125823190684902413307952627801971673";
var SIN08RS="0.989358246623381777808123598245288672116419080885761262817715219858877985644726205054060840325174808455697743639196573231779909207373577652843253268416650379431050190336409421266026963522517336067695835166895572610320153771171544956645181294940329481441691792952623838588555052321583577109253704587858";
var SIN09RS="0.412118485241756569756272566352435179343876526886972762235605161556096710307575159827093909398853575190443450970759832116639142193467234556830063924484776961469438131320787118896781131738955478024163912371754746844122713377090056828535643535287056923555908708148016009703745207499541199942638332196537";
var SIN10RS="-0.544021110889369813404747661851377281683643012916223891574184012616757209640493425707075673894983216158293824238262832285519507056438299703130824294610633640263216281984856329264047656795666320463779269274025377272906112767064510484871104571263794146821392894208757208458350619671501579644817858541759";
var COS00RS="1";
var COS01RS="0.540302305868139717400936607442976603732310420617922227670097255381100394774471764517951856087183089343571731160030089097860633760021663456406512265417318584717971164474479494233117924551393254335943517756702892596375736154327549641754491775115131222730100631357078232236771401517468995936678730674228";
var COS02RS="-0.416146836547142386997568229500762189766000771075544890755149973781964936124079169074531777860169140367366791365215728559288656399891172385683442074019964695321532618247978386250585148546251586628021039179201508829008648012416615537851303259175578275065958817677317196598571678562538407277081794726803";
var COS03RS="-0.989992496600445457271572794731261302393679096615588328814085932928329197513133220428294479355692602171495993112414169189571629286320229688602168542679234871819986249622389187501026624033235996418291729908639186429576430944877190434698005571502342677770615379990457137990442605088096402385557645431448";
var COS04RS="-0.653643620863611914639168183097750381424133596646218247007010283852737655810603379901230645646178858234462081537887333595639485251672433112747165847657468138012495992726980764262359205074677879217353430169182455841747662802238129910035734942344900944194480306728723955560057642188598404512784505041511";
var COS05RS="0.283662185463226264466639171513557308334422592252215944930359066586151456767382702286176981668344573238827368717546699736605498967134195925662330011169857957583560591062122401585694560677264692834622969349992413836584669775759014598539953353931061810137777676107069628717658164364389323503504767942392";
var COS06RS="0.960170286650366020545652297922924405451937679211012698129286426053545858554993106646441611363761299485599518077612785048269652302941746536485639179908388039655559539248640628711629430843805240962963388449024897873849153861007020594592648086217187773219809817260149552695599562524157222834864389163555";
var COS07RS="0.753902254343304638141197521719182012218313391460126839543613880813876026720717405625428391089302482541417434794653362444524366917576006777736347840940059153981321090443660927425120703355647047556719594874838624263855978731340296625566714544856958432948114753806944765117194159014574164757026155889596";
var COS08RS="-0.14550003380861352586884138183119468260931968554552122535096447869568030828787340061628617137263581839478566404779617940634167938322796277411599441503899897400897892682606126665000184085547355204247101445329192648536443054531314551964122689492596451269998550978239318751538900203885675932005015239321";
var COS09RS="-0.911130261884676988368294711181165311246347566569347262124782765780546406650078935226315978205792346135828567868989790119819689706132906908361330994448253030377671667833897359669715248821298043543527574489168940099942170789060744468320586727887692492139280336226873740771296457958195758262515880859364";
var COS10RS="-0.839071529076452452258863947824064834519930165133168546835953731048792586866270768400933712760422138927451054405350243623698423379879577519696186361385990162405761991820064001009665509654690410482844596668980386754716971171010520826921307324183412567072265618301100931356149209028142233252908147897126";
var PIMUL2 =PIMUL2S;
var PI =PIS;
var PIDIV2=PIDIV2S;
var PIDIV4=PIDIV4S;
var SQRT2=SQRT2S;
var LN2  =LN2S;
var LN3  =LN3S;
var LN5  =LN5S;
var LN7  =LN7S;
var LN10  =LN10S;
var LN11  =LN11S;
var LN13  =LN13S;
var LN17  =LN17S;
var LN19  =LN19S;
var LN23  =LN23S;
var LN29  =LN29S;
var LN31  =LN31S;
var LN37  =LN37S;
var LN41  =LN41S;
var LN43  =LN43S;
var LN47  =LN47S;
var LN53  =LN53S;
var LN59  =LN59S;
var LN61  =LN61S;
var LN67  =LN67S;
var LN71  =LN71S;
var LN73  =LN73S;
var LN79  =LN79S;
var LN83  =LN83S;
var LN89  =LN89S;
var LN97  =LN97S;
var E1=E1S;
var DEG=DEGS;
var SIN09D=SIN09DS;
var SIN15D=SIN15DS;
var SIN18D=SIN18DS;
var SIN30D=SIN30DS;
var SIN36D=SIN36DS;
var SIN45D=SIN45DS;
var SIN54D=SIN54DS;
var SIN60D=SIN60DS;
var SIN72D=SIN72DS;
var SIN75D=SIN75DS;
var SIN81D=SIN81DS;
var SIN00R=SIN00RS;
var SIN01R=SIN01RS;
var SIN02R=SIN02RS;
var SIN03R=SIN03RS;
var SIN04R=SIN04RS;
var SIN05R=SIN05RS;
var SIN06R=SIN06RS;
var SIN07R=SIN07RS;
var SIN08R=SIN08RS;
var SIN09R=SIN09RS;
var SIN10R=SIN10RS;
var COS00R=COS00RS;
var COS01R=COS01RS;
var COS02R=COS02RS;
var COS03R=COS03RS;
var COS04R=COS04RS;
var COS05R=COS05RS;
var COS06R=COS06RS;
var COS07R=COS07RS;
var COS08R=COS08RS;
var COS09R=COS09RS;
var COS10R=COS10RS;
var MTX_COL =400;  
var FIX_COL =2000;
var DECI_DGT=200 ; 
function m_deci_dgt(){           
  var deci_dgt= parseInt(document.getElementById('5_0').value); 
    if( deci_dgt <= 16){      
        var MTX_COL = 15; }   
     else { var MTX_COL =  80 ;}    
   return  MTX_COL;                           
}

function m_deci_dgt_1(){           
  var DECI_DGT= parseInt(document.getElementById('5_0').value); 
   return  DECI_DGT;                   
}
function m_gol_fix(){   
  if( DECI_DGT <=16){ var nub_col=75;}    
   else{var nub_col=300 ;}
  PIMUL2 =m_fix(PIMUL2S,nub_col);
  PIDIV2=m_fix(PIDIV2S,nub_col);
  PIDIV4=m_fix(PIDIV4S,nub_col);
  SQRT2=m_fix(SQRT2S,nub_col);
  LN2 =m_fix( LN2S,nub_col);
  LN3 =m_fix(LN3S,nub_col);
  LN5 =m_fix(LN5S,nub_col);
  LN7 =m_fix(LN7S,nub_col); 
  LN10 =m_fix(LN10S,nub_col);
  LN11=m_fix(LN11S,nub_col); 
  LN13=m_fix(LN13S,nub_col); 
  LN17=m_fix(LN17S ,nub_col);
  LN19=m_fix(LN19S ,nub_col);
  LN23=m_fix(LN23S ,nub_col);
  LN29 =m_fix(LN29S,nub_col);
  LN31=m_fix(LN31S ,nub_col);
  LN37=m_fix(LN37S,nub_col); 
  LN41 =m_fix(LN41S,nub_col);
  LN43 =m_fix(LN43S,nub_col);
  LN47 =m_fix(LN47S,nub_col);
  LN53=m_fix(LN53S,nub_col);
  LN59=m_fix(LN59S,nub_col); 
  LN61=m_fix(LN61S,nub_col);
  LN67=m_fix(LN67S,nub_col); 
  LN71 =m_fix(LN71S,nub_col);
  LN73=m_fix(LN73S,nub_col); 
  LN79=m_fix(LN79S,nub_col); 
  LN83=m_fix(LN83S,nub_col); 
  LN89=m_fix(LN89S,nub_col); 
  LN97=m_fix(LN97S,nub_col); 
  E1=m_fix(E1S,nub_col);
  SIN09D=m_fix(SIN09DS,nub_col);
  SIN15D=m_fix(SIN15DS,nub_col);
  SIN18D=m_fix(SIN18DS,nub_col);
  SIN36D=m_fix(SIN36DS,nub_col);
  SIN45D=m_fix(SIN45DS,nub_col);
  SIN54D=m_fix(SIN54DS,nub_col);
  SIN60D=m_fix(SIN60DS,nub_col);
  SIN72D=m_fix(SIN72DS,nub_col);
  SIN75D=m_fix(SIN75DS,nub_col);
  SIN81D=m_fix(SIN81DS,nub_col);
  SIN00R=m_fix(SIN00RS,nub_col);
  SIN01R=m_fix(SIN01RS,nub_col);
  SIN02R=m_fix(SIN02RS,nub_col);
  SIN03R=m_fix(SIN03RS,nub_col);
  SIN04R=m_fix(SIN04RS,nub_col);
  SIN05R=m_fix(SIN05RS,nub_col);
  SIN06R=m_fix(SIN06RS,nub_col);
  SIN07R=m_fix(SIN07RS,nub_col);
  SIN08R=m_fix(SIN08RS,nub_col);
  SIN09R=m_fix(SIN09RS,nub_col);
  SIN10R=m_fix(SIN10RS,nub_col);
  COS02R=m_fix(COS02RS,nub_col);
  COS03R=m_fix(COS03RS,nub_col);
  COS04R=m_fix(COS04RS,nub_col);
  COS05R=m_fix(COS05RS,nub_col);
  COS06R=m_fix(COS06RS,nub_col);
  COS07R=m_fix(COS07RS,nub_col);
  COS08R=m_fix(COS08RS,nub_col);
  COS09R=m_fix(COS09RS,nub_col);
  COS10R=m_fix(COS10RS,nub_col);
return ;
 }

  function m_add_sub_fix_cols(){       
      var FIX_COL = MTX_COL*5+20;  
      return  FIX_COL;
  }

   var display_width = 35;   
   function doGetCaretPosition (ctrl) {
   	var CaretPos = 0;
    	if (document.selection) {
   		ctrl.focus ();
    		var Sel = document.selection.createRange ();
   		Sel.moveStart ('character', -ctrl.value.length);
   		CaretPos = Sel.text.length;
    	}
     	else if (ctrl.selectionStart || ctrl.selectionStart == '0')
    		CaretPos = ctrl.selectionStart;
    	return (CaretPos);
    }

    function setCaretPosition(ctrl, pos)
   {
    	if(ctrl.setSelectionRange)
    	{
    		ctrl.focus();
    		ctrl.setSelectionRange(pos,pos);
    	}
    	else if (ctrl.createTextRange) {
    		var range = ctrl.createTextRange();
    		range.collapse(true);
    		range.moveEnd('character', pos);
    		range.moveStart('character', pos);
    		range.select();
    	}
    }

 function string_lg(it){        
        var this_it = it ;    
        var str_lg = this_it.length;
        return (str_lg);
      }

 function string_lg_1(){        
   var str_lg = string_lg(calc.input.value);
        return (str_lg);
      }

 function cursor_position(){   
     var nub = doGetCaretPosition(document.getElementById('input'));
        return (nub);
    }

   function cursor_position_set(n){     
     var string_s = document.getElementById('input');
       var nub_set = setCaretPosition(string_s , n) ;
     }

     function cursor_left_1(){         
       s_chang_visible_all();     
        var no = cursor_position();
        var lg = string_lg_1();
        var input_str = calc.input.value.trim();
        var new_str = input_str.substr(0,no) + input_str.substr(no,lg-1);
          document.getElementById('input').value = new_str;
         cursor_position_set(no-1) ;    
         if(no==0){cursor_position_set(0); }    
         click_init() ;
      }

    function cursor_right_1(){          
    s_chang_visible_all();     
       var no = cursor_position();
       var lg = string_lg_1();
        if(no <= lg){
    	 setCaretPosition(document.getElementById('input'),no+1);
                    }
    }

 function cursor_up_1(){               
     s_chang_visible_all();     
    var arry = m_count_newline();
    var arry_lg =arry.length;
    var arry_ref=[];                 
        arry_ref.push(0);
      for(i=0; i<arry_lg ;i++){
                   arry_ref.push(arry[i]+1);
                               }
    var no = cursor_position();
    var arry_ref_lg=arry_ref.length; 
    var arry_small=[];
            for(i=0; i<arry_ref_lg ;i++){
                if(arry_ref[i] <= no){             
                   arry_small.push(arry_ref[i]);
                                 }
                                     }   
        arry_small_lg = arry_small.length;
      var arry_small_2=[];   
          arry_small_2=arry_small.reverse(); 
      var  test_lg = arry_small_2.length;
            if(test_lg >=2){
               var ref_down = arry_small_2[0];    
               var ref_up = arry_small_2[1];      
                 if(((ref_down-ref_up)>(no-ref_down))&&((no-ref_down)< display_width)) {    
                    var new_no = ref_up+no-ref_down;}
                 if(((ref_down-ref_up)<=(no-ref_down))&&((no-ref_down)< display_width)){   
                    var new_no = ref_down-1;}
                  if((no-ref_down) > display_width){     
                    var new_no = no-display_width;}
                                                  } 
               if((test_lg ==1)&&(no > display_width)){ 
                  var new_no = no-display_width;}
                if((test_lg ==1)&&(no <= display_width)){ 
                  var new_no = no;}      
       setCaretPosition(document.getElementById('input'),new_no);
          scroll_cursor();
   }
 
   function cursor_down_1(){                
      s_chang_visible_all();     
      var arry = m_count_newline();
      var arry_lg =arry.length;
      var no = cursor_position();
      var lg = string_lg_1();
         if(lg <= no) { no = lg;}    
           var arry_small=[];
           for(i=0; i<arry_lg ;i++){
                if(arry[i] <=no){             
                   arry_small.push(arry[i]);
                                 }
                                     }  
            var arry_small_lg = arry_small.length; 
            var arry_lager=[];
            for(i=0; i< arry_lg ;i++){
                if(arry[i] > no){             
                   arry_lager.push(arry[i]);
                                 }
                                     }  
              var arry_lager_lg = arry_lager.length;
            if(arry_small_lg >=1){
              var ref_1 = arry_small[arry_small_lg -1 ];}  
             else{  var ref_1=0;}
             if(arry_lager_lg >=1){                       
               var ref_2 = arry_lager[0];}
                  else{  var ref_2=0;}
         if(arry_small_lg >=0 && arry_lager_lg >=1){
               var trans_1=(no-ref_1) % display_width;
                    if((ref_2-no) >= display_width){   
                       var new_no = no + display_width;
                                                    }
                    else{ var new_no = ref_2+trans_1;}
                                                  }
          if(arry_small_lg ==0 && arry_lager_lg >=1){
               var trans_1=(no-ref_1) % display_width;
                    if((ref_2-no) >= display_width){   
                       var new_no = no + display_width;
                                                    }
                    else{ var new_no = ref_2+trans_1+1;}  
                                                  }
        if(arry_small_lg >= 1 && arry_lager_lg ==0){
               var trans_1=(no-ref_1) % display_width;
                    if((lg-no) >= display_width){   
                       var new_no = no + display_width;}
                   else{ var new_no = no ;}
                                                  }
       if(arry_small_lg == 0 && arry_lager_lg ==0){
                    if((lg-no) >= display_width){   
                       var new_no = no + display_width;}
                   else{ var new_no = no ;}
                                                  }
     	setCaretPosition(document.getElementById('input'),new_no);
        scroll_cursor();
    }

function cursor_position_row(){                
    var arry = m_count_newline();
    var arry_lg =arry.length;
    var no = cursor_position();
    var lg = string_lg_1();          
       if(lg <= no) { no = lg;}    
   var row_nub=0;
    for(i=0; i< arry_lg ;i++){
    var nub_1=arry[i];
       if(i==0 && nub_1<no ){
          var nub_1=arry[i];
          var row_nub = row_nub+ m_abs(m_nub_m((nub_1-0)/display_width))+2;   
              }
       if(i > 0 && nub_1 < no ){
         var nub_1=arry[i];
         var nub_2=arry[i+1];
        var row_nub = row_nub + m_abs(m_nub_m((nub_2-nub_1)/display_width))+1;  
        }
                            }
  arry =[];
  return row_nub; 
}


 function cursor_re_start(nub){                
      var nub_a=nub;
      var arry = m_count_semicolon();
      var arry_lg =arry.length;
         var no = cursor_position();
         var input_str_a = calc.input.value;  
         var lg = string_lg_1();
         if(lg <= no) { no = lg;}    
           var arry_small=[];
             for(i=0; i<arry_lg ;i++){
                if(arry[i] <=no){             
                   arry_small.push(arry[i]);
                                 }
                                     }  
            var arry_small_lg = arry_small.length; 
            var arry_lager=[];
            for(i=0; i< arry_lg ;i++){
                if(arry[i] > no){              
                   arry_lager.push(arry[i]);
                                 }
                                    }  
             var arry_lager_lg = arry_lager.length;
            input_str_1="";
            input_str_2="";
            input_str_3="";
         if(arry_small_lg >0 && arry_lager_lg >0){
           var input_str_1 = input_str_a.substr(0 ,arry_small[arry_small_lg-1]+1);                         
           var input_str_2 = input_str_a.substring(arry_small[arry_small_lg-1]+1,arry_lager[0]+1);         
           var input_str_3 = input_str_a.substr(arry_lager[0]+1,lg-arry_lager[0]);                          
                                              }
         if(arry_small_lg ==0 && arry_lager_lg>0){
           var input_str_1 = "";                                                    
           var input_str_2 = input_str_a.substring(0 ,arry_lager[0]+1);             
           var input_str_3 = input_str_a.substr(arry_lager[0]+1 ,lg-arry_lager[0]);  
                                                             }
         if(arry_small_lg >0 && arry_lager_lg==0){
          var input_str_1 = input_str_a.substring(0 ,lg);      
           var input_str_2 = "";                                             
           var input_str_3 = "";                                             
                                                             }
          
      if(nub_a==1){ return input_str_1; }
      if(nub_a==2){ return input_str_2; }
      if(nub_a==3){ return input_str_3; } 

   }

function cursor_coords(event){      
 var x=event.clientX;
  var y=event.clientY;
  var ys=event.screenY;
   s_chang_visible_all(); 
  return data_a;
 }



function backspace_bf(){
      s_chang_visible_all();     
        var no = cursor_position();
        var lg = string_lg_1();
        var input_str = calc.input.value.trim();
        var new_str = input_str.substr(0,no-1) + input_str.substr(no,lg-1);
         document.getElementById('input').value = new_str;
         document.getElementById('input').blur();  
         cursor_position_set(no-1) ;    
            scroll_cursor();    
              click_init() ; 
  
  
  
             }
var BACK_COUNT = 0;                     
var BACK_MTX =  m_new_mtx(1,5000);     
function backspace(){     
      if(BACK_COUNT<=0){
              BACK_COUNT=0 ;
          backspace_bf();            
          var item_1 ="=";        
          var item_a= s_map(item_1);  
          var array_a = s_nub_array(item_a);      
          s_chang_hidden_array(array_a);
            return }
     var item_bf = BACK_MTX[0][BACK_COUNT-1];
     var lg = item_bf.length; 
          for(var i=0; i<lg;i++){
                backspace_bf();            
           BACK_MTX[0][BACK_COUNT-1]="";    
               }
         BACK_COUNT = BACK_COUNT-1;
        if(BACK_COUNT==0){ var item_1 ="="; }
        else {var item_1 = BACK_MTX[0][BACK_COUNT-1];}
      var item_a= s_map(item_1);  
      var array_a = s_nub_array(item_a);      
      s_chang_hidden_array(array_a); 
    }      
  

function clear_all_1(item_1){
 s_chang_visible_all();   
  for(var i=0;i<= BACK_COUNT ;i++){  
      BACK_MTX[0][i]="";}
      BACK_COUNT =0;
   var item_a=item_1;
      s_chang_sum(item_a);     
    var input_str = calc.input.value;
    var new_str ="";
      document.getElementById('input').value = new_str;
       cursor_position_set(0) ;  
 }


function space_1(){
      s_chang_visible_all();     
        var no = cursor_position();
        var lg = string_lg_1();
        var input_str = calc.input.value;
       if(insert_flag=="yes"){
          var new_str = input_str.substr(0,no) +" "+ input_str.substr(no,lg);
                             }
        else{
         var new_str = input_str.substr(0,no) +" "+ input_str.substr(no+1,lg);
            }         
        document.getElementById('input').value = new_str;
         cursor_position_set(no+1) ;
             }

function key_1(char_1){
      var char_1=char_1;
      BACK_MTX[0][BACK_COUNT] = char_1;              
      BACK_COUNT = BACK_COUNT+1; 
         s_chang_sum(char_1);      
      var char_lg = char_1.length;  
      var no = cursor_position();  
      var lg = string_lg_1();
      var input_str = calc.input.value;
     if(char_1== "h("){
         if(insert_flag=="yes"){
              var new_str = input_str.substr(0,no-1) +char_1+ input_str.substr(no,lg);
                             }
           else{ 
              var new_str = input_str.substr(0,no-1) +char_1+ input_str.substr(no+char_lg,lg);}  
                }
      else{
            if(insert_flag=="yes"){
              var new_str = input_str.substr(0,no) +char_1+ input_str.substr(no,lg);
                             }
           else{
             var new_str = input_str.substr(0,no) +char_1+ input_str.substr(no+char_lg,lg);
                }
                      }
      document.getElementById('input').value = new_str;
        cursor_position_set(no+char_lg) ;    
            s_check_nb(new_str);         
           s_check_end(new_str);        
            scroll_cursor();    
           click_init() ;  
  }


 var insert_flag="not";   

function rept_1(char_1, nb){
  var char_1 = char_1;
   var nb = nb;
   var char_t="";
     for(var n =0; n < nb+1 ;n++){
         char_t = char_t +char_1;
     }
     return (char_t);
}


function enter_1(){      
s_chang_visible_all();     
  var no = cursor_position();
   var lg = string_lg_1();             
   var input_str = calc.input.value;
   var rten = input_str.charCodeAt(no);   
    if(rten !=13 && rten !=10){
        var new_str = input_str.substring(0,no) +'\r'+ input_str.substring(no,lg);        
                  }
      if(rten ==13 ){
       var new_str = input_str.substr(0,no) +'\r'+'\r'+ input_str.substr(no,lg);         
       }   
    if(rten ==10){
       var new_str = input_str.substr(0,no) +'\r'+'\n'+ input_str.substr(no,lg);         
       }
     document.getElementById('input').value = new_str;
         cursor_position_set(no+1) ;     
   scroll_cursor();
}


function newline_1(){                 
s_chang_visible_all();     
   var no = cursor_position();
   var s_lg = string_lg_1();             
   var input_str = calc.input.value;
   var new_str = input_str+'\n' ;     
    document.getElementById('input').value = new_str;
        var new_ln_w = string_lg_1();  
    cursor_position_set(new_ln_w) ; 
      }

function scroll_cursor(){       
      var text_area = document.getElementById('input');
      var y_t=text_area.scrollTop;
      var y_h=text_area.scrollHeight ;
      var n_cur = cursor_position_row();  
        text_area.scrollTop = 9999 ;
 };




function mtx_str_inpt_chk_bf(x){               
var xx = x.toString().trim();
  var nub_e=0;   
  var nub_j=0;
  var nub_e= m_str_char(xx,"e") ;   
  var nub_j= m_str_char(xx,"!") ;   
  var nub_point_xx = m_str_char(xx,".") ;  
  var ans_0="";   
  var ans_1="";  
  var xx_fst = xx.substr(0,1); 
  if(nub_e==0 && nub_j==0 && nub_point_xx <=1 ){      
        var ans_1=xx; 
        return  ans_1 ; }                         
   var xx =  m_str_sub_ngt_bf(xx);   
       xx = xx.replace(/e\+/g , "ET");   
       xx = xx.replace(/eQ/g , "EQ");    
       xx = xx.replace(/\+/g , "EA");    
       xx = xx.replace(/\-/g , "ES");    
       xx = xx.replace(/\//g , "ED");    
       xx = xx.replace(/\*/g , "EM");    
       xx = xx.replace(/\^/g , "EP");    
       xx = xx.replace(/\(/g , "EL");    
       xx = xx.replace(/\)/g , "ER");  
       xx = xx.replace(/exp/g , "AXP"); 
       xx = xx.replace(/e/g , "ET");     
       xx = xx.replace(/\!/g , "EJ");     
    xx=xx+"E"; 
     var nub_E= m_str_char(xx,"E") ;  
     var str_bf="";  
     var str_mf="";
     var str_af="";
     var ans_0 = xx; 
     var MTX_COL_bf =0;
       for(var i=0; i<nub_E ;i++){         
        var index_E = ans_0.indexOf("E");     
        var str_bf = ans_0.substr(0,index_E);  
            if(((str_mf=="ET"||str_mf=="EQ")  && str_bf >=100)||(str_bf.length >= 100)){         
                 var col_nub = Math.floor(m_mtx_real_div(str_bf,5));
                        if( col_nub < 60 ){  var  MTX_COL_bf = 60 ;}       
                        else if( col_nub >60 &&  col_nub <=400){
                          var  MTX_COL_bf = m_mtx_real_add(col_nub,100);}                    
                        else if( col_nub >400 &&  col_nub <=1000){
                          var  MTX_COL_bf = m_mtx_real_add(col_nub,100); }                    
                        else if( col_nub >1000 &&  col_nub <=1500){
                          var  MTX_COL_bf = m_mtx_real_add(col_nub,200);}                   
                        else{
                          var  MTX_COL_bf = 2010;}     
                                 var MTX_COL_bf = m_str_e_to_str(MTX_COL_bf);             
                              if(str_mf=="EQ"){  var MTX_COL_bf = m_mtx_real_add(MTX_COL_bf,m_mtx_real_div(str_bf,2)) ;    
                                                    var MTX_COL_bf = m_str_e_to_str(MTX_COL_bf);            
                                                                                      }   
                                     
                                                               }
                          if( parseInt(MTX_COL_bf) > parseInt(MTX_COL)){      
                                MTX_COL = parseInt(MTX_COL_bf);
                                    }
                 var nub_point = m_str_char(str_bf,".") ;   
                        if(nub_point>=2 ){   
                            var ans_1 = message_1(30);
                           return  ans_1  ;
                                               } 
       var str_mf = ans_0.substr(index_E,2);  
         var str_af = ans_0.substr(index_E+2,xx.length-index_E-2);   
             var ans_0="";
             var ans_0=str_af;   
                                      }
   
   return  x ;  

   }



function mtx_str_hat_chk(x){             
var xx = x.toString().trim();
  var nub_hat= m_str_char(xx,"^") ;   
  var ans_0="";  
  var ans_1="";  
  var xx_fst = xx.substr(0,1); 
  if((nub_hat==0)||(nub_hat==1 && xx_fst !="-")){      
        var ans_1=xx;  return  ans_1 ; }               
   if(nub_hat==1 && xx_fst =="-"){
        var ans_1="0"+xx;  return  ans_1 ; }            
    var xx =  m_str_sub_ngt_bf(xx);  
        xx = xx.replace(/exp/g , "EZ"); 
        xx = xx.replace(/e\+/g , "EE");   
        xx = xx.replace(/eQ/g , "EQ");    
        xx = xx.replace(/\+/g , "EA");    
        xx = xx.replace(/\-/g , "ES");    
        xx = xx.replace(/\//g , "ED");    
        xx = xx.replace(/\*/g , "EM");    
        xx = xx.replace(/\^/g , "EP");    
        xx = xx.replace(/\(/g , "EL");    
        xx = xx.replace(/\)/g , "ER");    
       xx = xx.replace(/EP/g , "\^");      
     xx=xx+"E"; 
     var nub_E= m_str_char(xx,"E") ;  
       for(var i=0; i<nub_E ;i++){
        var index_E = xx.indexOf("E");  
        var str_bf = xx.substr(0,index_E);  
        var str_mf = xx.substr(index_E,2);  
        var str_af = xx.substr(index_E+2,xx.length-index_E-2);  
        var nub_hat_bf= m_str_char(str_bf,"^") ;   
           if(nub_hat_bf >1){          
                  var str_bf = mtx_str_e(str_bf);  
                  for(var j=0; j< nub_hat_bf ;j++){
                    var index_hat_p = str_bf.indexOf("^");         
                    var str_bf_bf = str_bf.substr(0,index_hat_p);  
                    var str_bf_mf = str_bf.substr(index_hat_p,1);  
                    var str_bf_af = str_bf.substr(index_hat_p+1,str_bf.length-index_hat_p-1);   
                    var ans_0 = ans_0+"("+ str_bf_bf + str_bf_mf;
                      var str_bf = str_bf_af ;     
                                 }
                    var ans_0 = ans_0+ str_bf_af;       
                      for(var k=0; k< nub_hat_bf ;k++){
                            var ans_0 = ans_0+")";       
                             }
                      var str_bf = ans_0;   
                      var ans_0="" ;        
               }
          var ans_1 = ans_1+ str_bf+ str_mf;  
           var xx = str_af ;     
                                       }
      var  ans_1 = ans_1.replace(/EA/g , "\+");    
      var  ans_1 = ans_1.replace(/ES/g , "\-");    
      var  ans_1 = ans_1.replace(/EM/g , "\*");    
      var  ans_1 = ans_1.replace(/ED/g , "\/");    
      var  ans_1 = ans_1.replace(/EP/g , "\^");    
      var  ans_1 = ans_1.replace(/EE/g , "e\+");   
      var  ans_1 = ans_1.replace(/EQ/g , "eQ");    
      var  ans_1 = ans_1.replace(/EL/g , "\(");    
      var  ans_1 = ans_1.replace(/ER/g , "\)");    
      var  ans_1 = ans_1.replace(/Q/g , "\-");    
      var  ans_1 = ans_1.replace(/E/g , ""); 
      var  ans_1 = ans_1.replace(/EZ/g , "exp");  
    return  ans_1 ;

 }

function mtx_str_e_chk_to_str(x){    
  var xx = x.toString().trim();
  var ans_a="";
  var nub_e = m_str_char(xx,"e") ;
  var nub_m = m_str_char(xx,"m") ;
  var fis_xx= xx.substr(0,1);
  var index_e = xx.indexOf("e");  
  var xx_af = xx.substr(index_e+1,xx.length-index_e-1);  
  var nub_point = m_str_char(xx_af,".") ;  
  var flag_xx=0; 
  if(fis_xx =="'" || fis_xx =='"'){ var flag_xx=0; }
  else{ var flag_xx=1; }
  if(nub_m ==0 && flag_xx==1 && nub_e==1 && nub_point ==1 ){
                                      var ans_a="'"+xx+"'";}
  else{var ans_a=xx;}
  return  ans_a ;
}





function mtx_str_e_bf(x){             
 var xx = x.toString().trim();
 var xx_lg = xx.length;
 var xx_fst =  xx.substr(0,1);
 var xx_lst =  xx.substr(xx_lg-1,1);
 var xx_lst_2 =  xx.substr(xx_lg-2,2);
 var ans_1="";
 var ans_bf="";
 var ans_af="";
 var nub_e= m_str_char(xx,"e") ;  
   if((xx_fst =="e")||(xx_lst =="e")||(xx_lst_2 =="e.")|| (nub_e>2)){        
              var ans_1 = message_1(32);   
                           return  ans_1 ; }
    var pos_e = xx.indexOf("e");  
     if(pos_e ==-1 ) { var ans_1=xx; return ans_1; }       
     if(pos_e !=-1 ) { 
                       var ans_bf=xx.substr(0,pos_e);                     
                       var ans_af=xx.substr(pos_e+1,xx_lg-pos_e-1);     
                       var ans_af = m_mtx_trim(ans_af);       
                       var ans_af = m_str_e_to_str(ans_af);   
                      } 
          var pos_point = ans_af.indexOf(".");  
          var ans_af_lg = ans_af.length;        
           if(pos_point ==-1 ) {                            
               var ans_af_fst = ans_af.substr(0,1);
               if(ans_af_fst =="-"){
                  var ans_1= ans_bf+"e"+ ans_af;
                                    }
                 else{
                      var ans_1= ans_bf+"e+"+ ans_af;
                       }
                                 }
            else{                   
                  var ans_af_bf= ans_af.substr(0,pos_point);                         
                  var ans_af_af= ans_af.substr(pos_point+1,ans_af_lg-pos_point-1);   
                  var ans_af_af = m_mtx_trim(ans_af_af);       
                  var ans_af_bf_fst = ans_af_bf.substr(0,1); 
                if(ans_af_bf_fst =="-"){
                   var ans_af_af="-0."+ ans_af_af;  
                                         } 
                  else{
                    var ans_af_af="0."+ ans_af_af;  
                       }
                 var data_a = Math.pow(10,ans_af_af);  
                 var data_b = m_mtx_real_mul(ans_bf, data_a) ;     
                 var ans_af_bf_fst = ans_af_bf.substr(0,1);     
                  if(ans_af_bf_fst =="-"){   
                     var ans_1 = data_b+"e"+ans_af_bf ;
                                          }
                   else{
                    var ans_1 = data_b+"e+"+ans_af_bf ; 
                       }
                }
   return ans_1; 

}



function mtx_str_e(x){        
var xx = x.toString().trim();
 var xx_lg = xx.length;
 var xx_fst =  xx.substr(0,1);
 var xx_lst =  xx.substr(xx_lg-1,1);
 var xx_lst_2 =  xx.substr(xx_lg-2,2);
 var ans_1="";
 var ans_bf="";
 var ans_af="";
 var nub_e= m_str_char(xx,"e") ;  
   if((xx_fst =="e")||(xx_lst =="e")||(xx_lst_2 =="e.")|| (nub_e>2)){        
              var ans_1 = message_1(32);   
                           return  ans_1  }
    var pos_e = xx.indexOf("e");  
     if(pos_e ==-1 ) { var ans_1=xx; return ans_1; }       
     if(pos_e !=-1 ) { 
                       var ans_bf=xx.substr(0,pos_e);                     
                       var ans_af=xx.substr(pos_e+1,xx_lg-pos_e-1);    
                       var ans_af = m_mtx_trim(ans_af);       
                       var ans_af = mtx_str_e_bf(ans_af); 
                      var ans_af = m_str_e_to_str(ans_af);   
                     } 
         var pos_point = ans_af.indexOf(".");  
          var ans_af_lg = ans_af.length;        
            if(pos_point ==-1 ) {                            
                var ans_af_fst = ans_af.substr(0,1);
              if(ans_af_fst =="-"){
                  var ans_1= ans_bf+"e"+ ans_af;
                                    }
                 else{

                      var ans_1= ans_bf+"e+"+ ans_af;
                       }
                                 }
            else{                  
                  var ans_af_bf= ans_af.substr(0,pos_point);                         
                  var ans_af_af= ans_af.substr(pos_point+1,ans_af_lg-pos_point-1);   
                  var ans_af_af = m_mtx_trim(ans_af_af);       
                  var ans_af_bf_fst = ans_af_bf.substr(0,1); 
                  if(ans_af_bf_fst =="-"){
                    var ans_af_af="-0."+ ans_af_af;  
                                          } 
                  else{
                    var ans_af_af="0."+ ans_af_af;  
                       }
                  var data_a = m_pow(10,ans_af_af);  
                  var data_b = m_mtx_real_mul(ans_bf, data_a) ;     
                  data_b = m_str_e_to_str(data_b);      
                  var ans_af_bf_fst = ans_af_bf.substr(0,1);     
                   if(ans_af_bf_fst =="-"){   
                     var ans_1 = data_b+"e"+ans_af_bf ;
                                          }
                   else{

                     var ans_1 = data_b+"e+"+ans_af_bf ; 
                       }
                }
   return ans_1; 

}
 

function m_n(n){             
    var nn = n.toString().trim();
    var nn = m_str_e_to_str(nn);      
    var nn =m_mtx_trim(nn) ;          
    var test_point = m_nub_p(nn);        
    var test_fst=nn.toString().substr(0,1);
       if(test_point > 0 || test_fst=="-"){
           return message_1(7);        
                         }       
    
      var data_comp_nn_20000001 = m_mtx_real_str_comp(nn,20000001);   
           if(( nn >= 20000001 )||(data_comp_nn_20000001 !=2)){       
              return message_1(33);} 
       var sum_total=1;
          if(nn == 0 || nn==1 ){  
              sum_total=1; return sum_total;}
      var AA= m_new_zero_mtx(1,MTX_COL);             
      var BB= m_new_zero_mtx(1,MTX_COL);            
      var CC= m_new_zero_mtx(1,MTX_COL);            
      var DD= m_new_zero_mtx(1,MTX_COL);            
      var data_row = AA.length;   
         AA[0][0]=100000;      
         DD[0][0]=100000;      
             var  value_nub=0;
             var MM = m_mtx_n_100_table();  
             var nn=parseFloat(nn);   
            TB = m_mtx_n_100_bf_table();  
              var data_flg =0 ;
              var data_i_end =0;
             for(var m=0; m < (TB.length) ;m++){
               if(nn >=TB[m][0] && nn < TB[m+1][0] ){       
                  if( nn <= (parseInt(TB[m][0]) + parseInt(TB[m+1][0]))/2){  
                       var data_i_star = TB[m][1];
                       var value_nub = TB[m][2];
                       var data_e_al = TB[m][3];
                       var data_flg =0 ;                     
                                                       }

                   else{
                        var data_i_end = TB[m+1][1];
                        var value_nub = TB[m+1][2];
                        var data_e_al = TB[m+1][3]; 
                         var data_flg =1 ;                  
                        }
                     var m =  TB.length; 
                     }
                                              }    

             if(value_nub >= 0 ){
               MM_part = m_mtx_row_table(MM,value_nub);
               AA= MM_part; 
                    }
             else{ AA=AA;}
          var nn=parseFloat(nn);   
               var data_e_a = 0;  
         if(data_flg ==0){
            for(var i = data_i_star ; i < (nn+1) ; i++){               
              var data_str = m_mtx_str_to_e_nez(i,0);    
              var data_e = m_mtx_str_to_e_nez(i,1);   
              BB=m_mtx_point_in(BB,data_str);         
              DD =  m_mtx_point_mul(DD,BB);        
               var data_e_a =data_e_a+data_e;  
                DD = m_mtx_cell_five(DD);          
                var data_test = parseInt(DD[0][0]);
                    if(  data_test ==0){
                           var  C = m_mtx_copy_col_mtx(CC,DD);   
                             var  DD = C;
                                     var data_e_a =data_e_a-5;   
                                       }
              
                                         }   
                               var data_e_al =parseInt(data_e_al)+parseInt(data_e_a);   
                               AA =  m_mtx_point_mul(AA,DD);        
                               AA = m_mtx_cell_five(AA);          
                          }  
               else{
                var data_e_a =0;
                 for(var i = (parseInt(nn)+1) ; i < parseInt(data_i_end) ; i++){            
                     var data_str = m_mtx_str_to_e_nez(i,0);    
                     var data_e = m_mtx_str_to_e_nez(i,1);   
                      BB=m_mtx_point_in(BB,data_str);         
               
                    DD =  m_mtx_point_mul(DD,BB);        
                     var data_e_a =data_e_a+data_e;  
                    DD = m_mtx_cell_five(DD);          
                  var data_test = parseInt(DD[0][0]);    
                    if(  data_test ==0){     
                        var  C = m_mtx_copy_col_mtx(CC,DD);   
                             var  DD = C;
                                     var data_e_a =data_e_a-5;   
                                       }

                                         }   
                                            var data_test_d0 = parseInt(DD[0][0]);
                                            var data_test_nub = 0;
                                     while( data_test_d0 < 100000){
                                      var DD = m_mtx_element_shift(DD,1);  
                                             var data_e_a = data_e_a-1;   
                                                  var data_test_d0 = parseInt(DD[0][0]);  
                                                        data_test_nub = data_test_nub+1;
                                                               if( data_test_nub ==10){  var data_test_d0 = 200000 ;}  
                                                                }
                                   var data_e_al =parseInt(data_e_al)-parseInt(data_e_a);   
                              
                                 DDI = m_mtx_any_inv(DD ,1);          
                               AA =  m_mtx_point_mul(AA,DDI);        
                               AA = m_mtx_cell_five(AA);          
                    }

             var sum_total= m_mtx_cell_five_show(AA);     
               sum_total = sum_total.toString();
               sum_total_lg = sum_total.length;
               sum_total = sum_total+"e+"+data_e_al;  
     return sum_total; 

   }

function m_delete_bracket(x){   
   var xx=x.toString().trim(); 
   var lg = xx.length;
   var xx_fst_s=xx.substr(0,1);                                         
   var xx_lst_e=xx.substr(xx.length-1,1);   
    if( xx_fst_s!="\(" || xx_lst_e!="\)" ){ return xx;}       
  for(var i=1 ; i<=lg ;i++){
   var xx_fst_s=xx.substr(0,1);                                         
   var xx_lst_e=xx.substr(xx.length-1,1); 
   if( xx_fst_s=="\(" && xx_lst_e=="\)" ){ xx =xx.substr(1,xx.length-2);} 
    else{return xx;}                                                         
                           }
  return xx; 
   }

 function m_str_power(x,nub){          
   var xx=x.toString().trim();
   var xx = m_delete_bracket(xx); 
   var xx_fst=xx.substr(0,1);
       if( xx_fst=="-"){ xx =xx.substr(1,xx.length-1);}  
          var xx_p = xx.indexOf(".");
          var xx_e = xx.indexOf("e");
     if( xx_e != -1 &&  xx_p != -1){                             
          var  nub_p =  xx.substr(xx_e+1,xx.length - xx_e);  
                if(nub_p ==""){var nub_p =0;}
                    nub_p = nub_p.toString().trim();
                   var flag_1 = nub_p.substr(0,1);  
                 if(flag_1 =="+"){ var nub_p = nub_p.substr(1,(nub_p.length-1));}     
                   xx = xx.substr(0,xx_e);       
                          }
         if( xx_e != -1 &&  xx_p == -1){                               
          var  nub_p =  xx.substr(xx_e+1,xx.length - xx_e);  
               if(nub_p ==""){var nub_p =0;}
                  nub_p = nub_p.toString().trim();
                   var flag_1 = nub_p.substr(0,1);  
                  if(flag_1 =="+"){ var nub_p = nub_p.substr(1,(nub_p.length-1));}     
              xx = xx.substr(0,xx_e);       
                          }
            if( xx_e == -1 &&  xx_p == -1){         
          var  nub_p =  0 ;  
          var   xx = xx;       
                               }
         if( xx_e == -1 &&  xx_p != -1){         
          var  nub_p =  0 ;  
          var   xx = xx;       
                                }
         if( xx_fst=="-"){ xx ="-"+xx;}     
         if(nub==0){
           var nub_p = m_mtx_trim(nub_p) ;
                   return nub_p;}    
         else{
            xx = m_mtx_trim(xx) ;   
         return xx ;}              

  }


function m_lg_str_to_e(x){     
  var xx=x.toString().trim(); 
  var xx = m_delete_bracket(xx); 
  var xx_fst=xx.substr(0,1);  
      if(xx_fst=="-"){ xx=xx.substr(1,xx.length-1); } 
  var xx_e =0;
  var xx_e = m_str_power(xx,0);          
  var xx_str = m_str_power(xx,1);          
  var xx_str_bf = m_nub_m(xx_str);      
  var xx_str_af = m_nub_p(xx_str);       
  var xx_str_bf_lg = xx_str_bf.length;
          if((xx_e + sum_total_lg-1) >0){
             xx_t = xx_str_bf.substr(0,1)+"."+ xx_str_bf.substr(1,xx_str_bf-1)+"e+"+(xx_e + sum_total_lg-1);     
                               }
          else if((xx_e + sum_total_lg-1) <0){
             xx_t = xx_str_bf.substr(0,1)+"."+ xx_str_bf.substr(1,xx_str_bf-1)+"e"+(xx_e + sum_total_lg-1);    
                               }
           else{
               xx_t = xx_str_bf.substr(0,1)+"."+ xx_str_bf.substr(1,xx_str_bf-1);
                          }
           if(xx_fst=="-"){ xx_t = "-"+xx_t; }  
    return xx_t;
}

function message_1(n){
 var nn = n;
  var message_1;
     switch(nn){
       case 1:
          message_1 ="<--Msg : asin(x) ,|x|<= 1-->";
          break;
        case 2:
          message_1 ="<--Msg : acos(x) ,|x|<= 1-->";
          break;
        case 3:
          message_1 ="<--Msg : acosh(x) ,arcosh(x) ,x >= 1-->";
          break;
        case 4:
          message_1 ="<--Msg : atanh(x) ,artanh(x),|x|< 1-->";
          break;
        case 5:
          message_1 ="<--Msg : ln(x) ,x >0-->";
          break;
        case 6:
          message_1 ="<--Msg:b^p ,when b<0 and p decimal point except zero ,complex logarithm-->";
          break;
         case 7:
          message_1 ="<--Msg:n! ,n >=0 ,n=0 or n ∈ N-->";
          break; 
         case 9:
          message_1 ="<--Msg:log(x),x >0-->";
          break;
          case 11:
          message_1 ="<--Msg:tan(x) x ≠ kπ+π/2 k∈Z-->";   
          break;
          case 13:
          message_1 ="<--Msg:ln(0) value to -infinity-->";
          break;
          case 14:
          message_1 ="<--Msg:log(0) value to -infinity-->";
          break;
         case 15:
          message_1 ="<--Msg:atanh(x) ,artanh(x), |x|< 1 and |x|>1-(10^(-200)) no support-->";    
          break;
          case 16:  
          message_1 ="<--Msg:sin(x) or cos(x) or tan(x) if as |x|>10^200 no support-->"; 
         break;
          case 23:
          message_1 ="<--Msg:exp(x) if as |x| >10^200 no support-->";
          break;
          case 24:
          message_1 ="<--Msg:sinh(x) if |x|>10^200 no support-->";
          break;
           case 25:
          message_1 ="<--Msg:cosh(x) if |x|>10^200 no support-->";
          break;
          case 28:
            message_1 ="<--Msg:undefined : x^p as x=0 p<=0-->";
            break;
          case 29:
            message_1 ="<--Msg:error : y/x as x=0-->" ;
            break;
            case 30:
            message_1 ="<--Msg:error : . >1 or e >1-->";
            break;
            case 31:
            message_1 ="<--Msg:error : A[0][0] < 100000 || A[0][0] > 999999-->";
            break;
            case 32:
            message_1 ="<--Msg:sorry : (e± || e. || e± e || e± ..) this e type no support-->";
            break;
           case 33:
            message_1 ="<--Msg:n! , n > 2*10^7 no support-->";    
            break;
           case 34:  
            message_1 ="<--Msg:|answer|<=10^(-200) , inside of calculator error range-->";    
            break;
            case 35:
            message_1 ="<--Msg:sorry no support and try use parentheses()-->";  
            break;
           case 36:
            message_1 ="<--Msg:b^p ,as p >10^200 or p <-(10^200) no support-->";
            break;
             case 38:  
            message_1 ="<--Msg: .x x<=16 ,|answer|<=10^(-40),inside of calculator error range-->";  
            break;
      default:
               }
 return message_1; 
 }


  function m_del4_2f_char(s,c){     
    var ss=s;
     var cc=c;
     var ss_lg=ss.length; 
     var cc_lg=cc.length;
     var pos=ss.lastIndexOf(cc);
     var partstring = ss.substr((pos+cc_lg),ss_lg);
   return partstring ;
    }


 function m_count_newline(){     
   var lg = string_lg_1();
    var input_str = calc.input.value ;
    var rten = "";  
    var arr  =[];
      for(var i=1 ; i<=lg ;i++){
         var rten = input_str.charCodeAt(i);  
             if(rten ==10 || rten ==13){
                   arr.push(i);
                                       }
                                }
     return arr;
  }

function m_count_semicolon(){     
   var lg = string_lg_1();
    var input_str = calc.input.value ;
    var rten = "";  
    var arr  =[];
      for(var i=1 ; i<=lg ;i++){
         var rten = input_str.charCodeAt(i);  
             if(rten ==59 ){
                   arr.push(i);
                                      }
                                }
     return arr;
  }




function m_replace(str_s ,old_s ,new_s ){          
var ss = str_s.toString().trim();
    var oo = old_s.toString().trim();  
    var nn = new_s.toString().trim();  
    var ss_lg = ss.length;
    var oo_lg = oo.length;  
    var nn_lg = nn.length;  
    var new_ss = ss ;       
    var fg =0 ;            
      for(var i=0 ; i < ss_lg ; i++){
        var oo_part = ss.substr(i,oo_lg);
           if(oo_part == oo){
                var new_ss = new_ss.substr(0, i+fg) + nn  +new_ss.substr(i+oo_lg + fg , ss_lg-1+fg);
                var fg = fg+(nn_lg-oo_lg);    
                            }
                                     }
     return new_ss;
}


function m_replace_star(str_s ){          
    var str_1=str_s;
    var str_new = m_replace(str_1 ,')m',')*m');
        for(var i=0;i<=9;i++){
          str_new = m_replace(str_new ,i+'m',i+'*m');
            }
   return str_new;
}

function m_str_sub_ngt_bf_1_bk_math(str){     
    var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
     if(str_fst=="-"){
          var  str_1=str_1.substr(1,str_1.length-1);  }  
    var  str_1 = str_1.replace(/EQ/g , "e\-");         
    var  str_1 = str_1.replace(/EP/g , "e\+");           
    var  str_1 = str_1.replace(/EXP/g , "exp");         
     if(str_fst=="-"){
           var  str_1 ="-"+str_1 ;}   
return str_1;
}


function m_str_sub_ngt_bf_1_math(str){     
    var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
             if(str_fst=="-"){
                   var  str_1="0"+str_1;  }              
             str_1 = str_1.replace(/\(-/g , "\(0-");     
             str_1 = str_1.replace(/n-/g , "nQ");         
             str_1 = str_1.replace(/s-/g , "sQ");         
             str_1 = str_1.replace(/y-/g , "yQ");        
             str_1 = str_1.replace(/p-/g , "pQ");         
             str_1 = str_1.replace(/,-/g , ",Q");         
             str_1 = str_1.replace(/\^-/g , "\^Q");         
             str_1 = str_1.replace(/e-/g , "EQ");        
             str_1 = str_1.replace(/e\+/g , "EP");        
             str_1 = str_1.replace(/exp/g , "EXP");        
             str_1 = str_1.replace(/e/g , "EP");         
    return str_1;
 }



function m_str_sub_ngt_bf_1_bk(str){    
    var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
     if(str_fst=="-"){
    var  str_1=str_1.substr(1,str_1.length-1);  }  
    var  str_1 = str_1.replace(/EQ/g , "e\-");       
    var  str_1 = str_1.replace(/EP/g , "e\+"); 
    var  str_1 = str_1.replace(/EXP/g , "exp");
      if(str_fst=="-"){
    var  str_1 ="-"+str_1 ;}
return str_1;
 
}


function m_str_sub_ngt_bf_1(str){     
    var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
        str_1 = str_1.replace(/n-/g , "nQ");      
        str_1 = str_1.replace(/s-/g , "sQ");      
        str_1 = str_1.replace(/y-/g , "yQ");      
        str_1 = str_1.replace(/p-/g , "pQ");      
        str_1 = str_1.replace(/,-/g , ",Q");      
        str_1 = str_1.replace(/\^-/g , "\^Q"); 
        str_1 = str_1.replace(/e-/g , "EQ");      
        str_1 = str_1.replace(/e\+/g , "EP");  
        str_1 = str_1.replace(/exp/g , "EXP");        
        str_1 = str_1.replace(/e/g , "EP");    
    return str_1;
 }

function m_str_sub_ngt_bf(str){   
var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
            if(str_fst=="-"){
                   var  str_1="0"+str_1;  }              
             str_1 = str_1.replace(/n-/g , "nQ");      
             str_1 = str_1.replace(/s-/g , "sQ");      
             str_1 = str_1.replace(/y-/g , "yQ");      
             str_1 = str_1.replace(/p-/g , "pQ");     
             str_1 = str_1.replace(/,-/g , ",Q");      
             str_1 = str_1.replace(/\^-/g , "\^Q");      
             str_1 = str_1.replace(/e-/g , "eQ");      
             str_1 = str_1.replace(/e\+/g , "e");      
   return str_1;
 }

function m_str_sub_ngt_bf_minus(str){   
    var str_1 = str.toString().trim();
    var str_1_lg = str_1.length;
    var str_fst = str_1.substr(0,1);
    var str_sec = str_1.substr(1,1);
             str_1 = str_1.replace(/n-/g , "nQ");      
             str_1 = str_1.replace(/s-/g , "sQ");      
             str_1 = str_1.replace(/h-/g , "hQ");      
             str_1 = str_1.replace(/p-/g , "pQ");      
             str_1 = str_1.replace(/,-/g , ",Q");      
             str_1 = str_1.replace(/\^-/g , "\^Q");      
             str_1 = str_1.replace(/e-/g , "eQ");      
             str_1 = str_1.replace(/e\+/g , "e");      
    return str_1;
 }



function m_str_spec_part_bf(str ,spec){           
   var str_1 = str.toString().trim();
     var spec_1= spec;
          str_1 =  m_str_sub_ngt_bf(str_1) ;     
     var pos = str_1.indexOf(spec_1) ; 
     var mark_1 =str_1[pos - 1];        
     var count_1 = 1 ;
     var count_mark = pos ;
        if(mark_1 ==")"){
             for(var i= pos-2;0 <= i  ; i=i-1){
              var mark_ref = str_1[i];
                 if(mark_ref ==")"){
                     count_1 = count_1 +1 ;}
                 if(mark_ref =="("){
                     count_1 = count_1-1 ;}
                  if(count_1==0){
                     var count_mark = i ;
                       i=-1;                                     
                                          }
                                           }
                           }
          if((mark_1 >=0 && mark_1<=9)|| mark_1=="π"|| mark_1=="°") {  
             var count_mark = pos-1;   
           for(var i = pos - 2; 0 <= i   ; i=i-1){
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q' || mark_ref=='e'){     
                        var count_mark = i ;
                                                       }
                   else{  
                           i=-1 ;                                
                                             }     
                                                  }
                                  }
        var str_part_b= str_1.substring(count_mark,pos);
    return str_part_b;
}

function m_str_spec_part_bf_mn(str ,spec){            
     var str_1 = str.toString().trim();
     var spec_1= spec;
     var str_bf_1_bit ="";    //20200728
     var str_bf_2_bit ="";
     var ans_1="";
       var str_1 = str_1.replace(/eQ/g , "eN");
       var str_1 = str_1.replace(/e\-/g , "eN"); 
           str_1 =  m_str_sub_ngt_bf(str_1) ;     
       var pos = str_1.indexOf(spec_1) ; 
     var mark_1 =str_1[pos - 1];        
     var count_1 = 1 ;
     var count_mark = pos ;

          if(mark_1 ==")"){
            for(var i= pos-2;0 <= i  ; i=i-1){
              var mark_ref = str_1[i];

                 if(mark_ref ==")"){
                     count_1 = count_1 +1 ;}
                 if(mark_ref =="("){
                     count_1 = count_1-1 ;}
                                            
                  if(count_1==0){
                     var count_mark = i ;
                       i=-1;                                     
                                          }
                                           }
                           }
        if((mark_1 >=0 && mark_1<=9)) {  
            var count_mark = pos-1;   
           for(var i = pos - 2; 0 <= i   ; i=i-1){
              var mark_ref = str_1[i];
                if((mark_ref <= 9 && mark_ref >= 0 )|| mark_ref=='e'||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='N'){     
                        var count_mark = i ;
                                                       }
                   else{  
                    
                           i=-1 ;                                
                                             }     
                                                    
                                                  }
                                 }
 
         var str_part_b= str_1.substring(count_mark,pos);
         var str_part_b = str_part_b.replace(/eN/g , "eQ");    
      
     return str_part_b;
}

function m_str_spec_part_bf_mul(str ,spec){          
  var str_1 = str.toString().trim();
     var spec_1= spec;
          str_1 =  m_str_sub_ngt_bf(str_1) ;      
        var pos = str_1.indexOf(spec_1) ; 
      var mark_1 =str_1[pos - 1];        
     var count_1 = 1 ;
     var count_mark = pos ;
        if(mark_1 ==")"){
          for(var i= pos-2;0 <= i  ; i=i-1){
              var mark_ref = str_1[i];

                 if(mark_ref ==")"){
                     count_1 = count_1 +1 ;}
                 if(mark_ref =="("){
                     count_1 = count_1-1 ;}
                                            
                  if(count_1==0){
                     var count_mark = i ;
                       i=-1;                                     
                                          }
                                           }
                           }
           
          if((mark_1 >=0 && mark_1<=9)|| mark_1=="π"|| mark_1=="°"|| mark_1=="*"|| mark_1=="/") {  
             var count_mark = pos-1;   
           for(var i = pos - 2; 0 <= i   ; i=i-1){
              var mark_ref = str_1[i];
                  if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q' || mark_ref=='e'|| mark_ref=='*'|| mark_ref=='/'){     
                        var count_mark = i ;
                                                       }
                   else{  
                          i=-1 ;                                
                                             }     
                                                }
                                  }
        var str_part_b= str_1.substring(count_mark,pos);
     return str_part_b; 

}



function m_str_spec_part_af(str ,spec){          
var str_1 = str.toString().trim();
     var str_0 =str_1 ;                    
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
      if( spec_1=="π" || spec_1=="°"){ var ans_1="" ; return ans_1 ;}   
         var  str_1= m_str_sub_ngt_bf(str_1);   
     var pos = str_1.indexOf(spec_1) ;  
     var mark_1 =str_1[pos +spec_a_lg];           
     var count_a = 1 ;
     var count_mark=2500;  
          if(mark_1 =="("){
           for(var i= (pos + spec_a_lg+1) ; i < str_a_lg+1  ; i++){     
              var mark_ref = str_1[i];
                 if(mark_ref =="("){
                     count_a = count_a +1 ;}
                 if(mark_ref ==")"){
                     count_a = count_a-1 ;}
                 if(count_a==0){
                     var count_mark = i+1 ;
                       i = str_a_lg ;                                     
                                 }
                                                   }
                           }
        if(mark_1 >=0 && mark_1<=9) {
           for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   //str_a_lg+1
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='e' ) {      
                                                       }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }      
                                                    
                                                  }
                                 }
        
           if(mark_1 =='.') {                                     
           for(var i = pos + spec_a_lg+1;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='Q'|| mark_ref=='e') {      
                                                      }
                   else{  

                     var count_mark = i ;

                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }

         if(mark_1 =='π'||mark_1 =='°') {  var count_mark = pos+spec_a_lg+1 } ;   
                 if(mark_1 =="-") {
            for(var i = pos + spec_a_lg+1;  i < str_a_lg+1  ; i++){        
              var mark_ref = str_1[i];
                 if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π'|| mark_ref=='.' || mark_ref=='Q'|| mark_ref=='e') {      
                                                       }
                   else{  
                     var count_mark = i ;
                       i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
           if(mark_1 =='^') {  var count_mark = pos+spec_a_lg } ;      
         var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);     
         
     return str_part_b;
  
}



function m_str_spec_part_af_mul(str ,spec){          
    var str_1 = str.toString().trim();
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
     if( spec_1!="π" && spec_1!="°"){ var ans_1=""; return ans_1 ;}   
     var pos = str_1.indexOf(spec_1) ;  
     var mark_1 =str_1[pos +spec_a_lg];         
     var count_a = 1 ;
     var count_mark=pos+spec_a_lg;  
        if((mark_1 =="*" || mark_1=="/")) {     　　
           for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){     
             var mark_ref = str_1[i];
                       if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='e'|| mark_ref=='＊'|| mark_ref=='/' ) {      
                                                       }
                   else{  
                     var count_mark = i ;    
                         i= str_a_lg;                      }      
                                                    
                                                  }  

                                  } 
            else{ var ans_1=""; return ans_1 ;}   
        var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);    
     return str_part_b;
  
}

function m_str_spec_part_af_div(str ,spec){          
    var str_1 = str.toString().trim();
     var str_0 =str_1 ;                    
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
      if( spec_1=="π" || spec_1=="°"){ var ans_1="" ; return ans_1 ;}   
         var  str_1= m_str_sub_ngt_bf(str_1);  
     var pos = str_1.indexOf(spec_1) ;  
     var mark_1 =str_1[pos +spec_a_lg];           
     var count_a = 1 ;
     var count_mark=2500;  
          if(mark_1 =="("){
           for(var i= (pos + spec_a_lg+1) ; i < str_a_lg+1  ; i++){     
              var mark_ref = str_1[i];
                 if(mark_ref =="("){
                     count_a = count_a +1 ;}
                 if(mark_ref ==")"){
                     count_a = count_a-1 ;}
                 if(count_a==0){
                     var count_mark = i+1 ;
                       i = str_a_lg ;                                     
                                 }
                                                   }
                           }
 
          if(mark_1 >=0 && mark_1<=9) {
           for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 ) || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='e'|| mark_ref =='°' || mark_ref =='π') {         
                                                       }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
          
           if(mark_1 =='.') {                                     
           for(var i = pos + spec_a_lg+1;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )|| mark_ref=='Q'|| mark_ref=='e'|| mark_ref =='°' || mark_ref =='π') {       
                                                      }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }      
                                                    
                                                  }
                                  }
          if(mark_1 =='π'|| mark_1 =='°') {  var count_mark = pos+spec_a_lg+1 } ;   
              if(mark_1 =="-") {
            for(var i = pos + spec_a_lg+1;  i < str_a_lg+1  ; i++){        
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π'|| mark_ref=='.' || mark_ref=='Q'|| mark_ref=='e') {                                                            }
                   else{  
                     var count_mark = i ;
                        i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
   
           if(mark_1 =='^') {  var count_mark = pos+spec_a_lg } ;      
          var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);    
     return str_part_b;
 
}

function m_str_spec_part_af_db_ft_test(str ,spec){              
     var str_1 = str.toString().trim();
     var str_0 =str_1 ;                    
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
      if( spec_1=="π" || spec_1=="°"){ var ans_1="" ; return ans_1 ;}   
         var  str_1= m_str_sub_ngt_bf(str_1);   
     var pos = str_1.indexOf(spec_1) ;  
     if( pos=="-1" || pos==-1){ var ans_1="" ; return ans_1 ;}  
     var mark_1 =str_1[pos +spec_a_lg];           
     var count_a = 2 ;   //20220125  改變狀態 exp(ln(7)+2)
     var count_mark=2500;
         if(mark_1 =="("){
           for(var i= (pos + spec_a_lg+1) ; i < str_a_lg+1  ; i++){     
              var mark_ref = str_1[i];
                 if(mark_ref =="("){
                     count_a = count_a +1 ;}  //20220125
                 if(mark_ref ==")"){
                     count_a = count_a-1 ;}
                 if(count_a==0){
                     var count_mark = i+1 ;
                       i = str_a_lg ;                                     
                                 }
                                                   }
                           }
         var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark); 
          var pos_1 = str_part_b.indexOf('))') ;
   return pos_1;
 }

function m_str_spec_part_bf_inv(str ,spec){      
     var str_1 = str.toString().trim();
     var spec_1= spec;
     var str_1 = str_1.replace(/exp/g ,"EXP");    
     var str_1 = str_1.replace(/e\-/g ,"eQ");     
     var str_1 = str_1.replace(/e\+/g ,"eP"); 
     var str_1 =  m_str_sub_ngt_bf_minus(str_1) ;     
     var pos = str_1.lastIndexOf(spec_1) ; 
     var mark_1 =str_1[pos - 1];        
     var count_1 = 1 ;
     var count_mark = pos ;
          if(mark_1 ==")"){
           for(var i= pos-2;0 <= i  ; i=i-1){
              var mark_ref = str_1[i];
                 if(mark_ref ==")"){
                     count_1 = count_1 +1 ;}
                 if(mark_ref =="("){
                     count_1 = count_1-1 ;}
                  if(count_1==0){
                     var count_mark = i ;
                       i=-1;                                     
                                          }
                                           }
                           }
          if((mark_1 >=0 && mark_1<=9)|| mark_1=="π") {  
             var count_mark = pos-1;   
           for(var i = pos - 2; 0 <= i   ; i=i-1){
              var mark_ref = str_1[i];
                  if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='e'|| mark_ref=='Q'|| mark_ref=='P'){     
                        var count_mark = i ;
                                                       }
                   else{  
                           i=-1 ;                                
                                             }     
                                                  }
                                  }
         var str_part_b= str_1.substring(count_mark,pos);
         var str_1 = str_1.replace(/EXP/g ,"exp");     
         var str_1 = str_1.replace(/eQ/g ,"e-");        
         var str_1 = str_1.replace(/eP/g ,"e+"); 
    return str_part_b;
}


function m_str_spec_part_af_inv(str ,spec){          
     var str_1 = str.toString().trim();
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
     var pos = str_1.lastIndexOf(spec_1) ;  
     var mark_1 =str_1[pos +spec_a_lg];        
     var count_a = 1 ;
     var count_mark=2500; 
     var str_1 = str_1.replace(/exp/g ,"EXP");    
     var str_1 = str_1.replace(/e\-/g ,"eQ");     
     var str_1 = str_1.replace(/e\+/g ,"eP");
         if(mark_1 =="("){
            for(var i= (pos + spec_a_lg+1) ; i < str_a_lg  ; i++){
              var mark_ref = str_1[i];
                 if(mark_ref =="("){
                     count_a = count_a +1 ;}
                 if(mark_ref ==")"){
                     count_a = count_a-1 ;}
                 if(count_a==0){
                     var count_mark = i+1 ;
                       i = str_a_lg ;                                     
                                 }
                                                   }
                           }
    
          if(mark_1 >=0 && mark_1<=9) {
           for(var i = pos + spec_a_lg;  i < str_a_lg  ; i++){
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='e'|| mark_ref=='P' ) {      
                                                      }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
          
           if(mark_1 =='.') {                                     
           for(var i = pos + spec_a_lg+1;  i < str_a_lg  ; i++){
              var mark_ref = str_1[i];
                  if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='Q'|| mark_ref=='e'|| mark_ref=='P') {      
                                                     }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
          if(mark_1 =='π') {  var count_mark = pos+spec_a_lg+1 } ;   
              if(mark_1 =="-") {
            for(var i = pos + spec_a_lg+1;  i < str_a_lg  ; i++){
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π'|| mark_ref=='.' || mark_ref=='Q'|| mark_ref=='e'|| mark_ref=='P') {      
                                                      }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }     
                                                    
                                                  }
                                 }
           if(mark_1 =='^') {  var count_mark = pos+spec_a_lg } ;   
       var str_1 = str_1.replace(/EXP/g ,"exp");               
       var str_1 = str_1.replace(/eQ/g ,"e-");                 
       var str_1 = str_1.replace(/eP/g ,"e+"); 
       var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);    
     return str_part_b;
}



  function m_fact(str){                                  
    var str_1=str;
    var part_bf = m_str_spec_part_bf_mn(str_1 ,'!');  //20200729
    var part_bf_lg = part_bf.length;
     if(part_bf_lg > 0 &&  part_bf[0] =='(' ){
        str_1 = str_1.replace(part_bf+'!' , "m_n"+part_bf ) ;  }            
     if(part_bf_lg > 0 &&  part_bf[0] !='(' ){
        str_1 = str_1.replace(part_bf+'!' , "(m_n("+part_bf+'))');                 
                        }
          if(part_bf_lg == 0){  str_1 = str_1.replace(part_bf+'!' , "(m_n("+1+'))'); }   
     return str_1;
   }
function m_fact_minus(str){          
    var str_1=str;
    var ans_1="";
    var nub_e=0;                                 
    var str_1 = str_1.replace(/e\-/g ,"eQ");     
    var str_1 = str_1.replace(/e\+/g ,"e"); 
    var part_bf = m_str_spec_part_bf_mn(str_1 ,'!');   
    var part_bf_lg = part_bf.length;
    var nub_e= m_str_char(part_bf,"e") ;
     if(part_bf_lg > 0 &&  part_bf[0] =='(' ){
        str_1 = str_1.replace(part_bf+'!' , part_bf +"T" );  }           
    if(part_bf_lg > 0 &&  part_bf[0] !='('&&  nub_e==0 ){
        str_1 = str_1.replace(part_bf+'!' , "("+part_bf+"T)"); }            
     if(part_bf_lg > 0 &&  part_bf[0] !='(' &&  nub_e > 0) {                     
        str_1 = str_1.replace(part_bf+'!' , "("+part_bf+")T"); }                      
     if(part_bf_lg == 0){  str_1 = str_1.replace(part_bf+'!' , "("+1+"T)"); }   
      return str_1;
   }

 function m_star(str){                                 
  var str_1 = str;
    var part_bf = m_str_spec_part_bf(str_1 ,"π");  
    var part_bf_lg = part_bf.length;
    if(part_bf_lg > 0 ){
    var  str_1 = str_1.replace(part_bf+"π" , part_bf+'*'+PI ) ; } 
   if(part_bf_lg == 0){ 
    var  str_1 = str_1.replace(part_bf+"π" , part_bf+PI ) ; }     
      return str_1;
   }


function m_star_rem(str,nub){         
    var str_1 = str;
    var nubb = nub;
    var pi_index = str_1.indexOf("π");   
       if(pi_index ==-1){ var ans_1 = str_1; return ans_1;}  
    var str_1 = str_1.replace("*π","π");  
    var str_1 = str_1.replace("e+","e");  
    var part_bf = m_str_spec_part_bf(str_1 ,"π"); 
        var star_str_lg = str_1.length 
        var part_bf_lg = part_bf.length ; 
        var pi_index = str_1.indexOf("π");               
        var str_bf = str_1.substr(0,pi_index -part_bf_lg);  
        var str_af = str_1.substr(pi_index+1 ,star_str_lg-pi_index-1);  
                if(pi_index ==-1){  return str; } ;  
                   var bf_op_data = pi_index-part_bf_lg-1 ;
                     if(bf_op_data ==-1){ var bf_op ="";}
                      else {var bf_op = str_1.substr(pi_index-part_bf_lg-1,1); } 
                    var af_op = str_1.substr(pi_index+1,1);  
                    var af2_str_bf = str_bf.substr(str_bf.length-2,2);  
                    var bf2_str_af = str_af.substr(0,2);                
              if( bf_op =="*" || bf_op =="/" || bf_op =="^"  ||af_op =="*" || af_op =="/" || af_op =="^" || af2_str_bf =="((" || af2_str_bf =="/("|| af2_str_bf =="*("|| af2_str_bf =="^(" || bf2_str_af =="))" || bf2_str_af ==")*" ||bf2_str_af ==")/" ||bf2_str_af ==")^" ){
                  str_1 = str_bf + part_bf +"π"+ str_af;
                         return str_1; 
                  }
       var part_af = m_str_spec_part_af(str_1 ,"π");
       var part_bf = part_bf.replace("Q","-");  
       var nub_point= m_str_char(part_bf,".") ;  
           if(nub_point >2){        
              var ans_1 = message_1(30);   
                           return  ans_1  }
           var part_bf  = m_str_e_to_str(part_bf);      
      var bf_pos_pot = part_bf.indexOf(".");   
      var part_bf_lg = part_bf.length;
         if(bf_pos_pot ==-1){ var part_bf = part_bf.substr(part_bf_lg-1,1); 
         if(part_bf % 2 == 0) { var part_bf = 0 ;}
          else { var part_bf = 1 ;}
         if(nubb==1){ var part_bf = 0 ;}  
                           }                                                      
         if(bf_pos_pot !=-1){ part_bf = part_bf.substr(bf_pos_pot-1,part_bf_lg-bf_pos_pot+1);  
             var fst_part_bf =  part_bf.substr(0,1);         
         if(fst_part_bf % 2 == 0) { var part_bf = "0" + part_bf.substr(1,part_bf_lg -1) ;}   
         else { var part_bf = "1" + part_bf.substr(1,part_bf_lg -1);}                     
         if(nubb==1){  var part_bf = "0" + part_bf.substr(1,part_bf_lg -1) ;} }   
         if(part_bf_lg ==0){ var part_bf= "P" ; }                  
         if(part_bf_lg !=0 && part_bf != 0 && part_bf != 1 ){ var part_bf= part_bf+"P" ; }   
         if(part_bf_lg !=0 && part_bf == 0){ var part_bf= "0";}
         if(part_bf_lg !=0 && part_bf == 1){ var part_bf= "P" ; }   
            var str_new ="";
            var str_new = str_bf + part_bf + str_af;
         if(str_new=="0-0" || str_new=="-0" ){ var str_new="0";}
            var str_new_lg = str_new.length;
            var str_new_fst_sec = str_new.substr(0,2); 
            var str_new_lst_sec = str_new.substr(str_new_lg-2,2);   
         if(str_new_fst_sec =="0-" ){ str_new = str_new.substr(1,str_new_lg-1);}    
         if(str_new_lst_sec =="-0" ){ str_new = str_new.substr(0,str_new_lg-2);}   
     return str_new;
   }



function m_star_deg(str){                                 
  var str_1 = str;
    var part_bf = m_str_spec_part_bf(str_1 ,"°");  
        part_bf = part_bf.replace("Q","\-");    
    var part_bf_lg = part_bf.length;
     if(part_bf_lg > 0 ){
      var str_1 = str_1.replace(part_bf+"°" , part_bf+'\*'+DEG ) ; }
     if(part_bf_lg == 0){  str_1 = str_1.replace(part_bf+"°" , part_bf+DEG ) ; }  
  return str_1;
   }

function m_str_spec_part_af_minus(str ,spec){         
     var str_1 = str.toString().trim();
     var str_0 =str_1 ;                    
     var str_a_lg = str_1.length;
     var spec_1= spec;                      
     var spec_a_lg = spec_1.length;
      if( spec_1=="π" || spec_1=="°"){ var ans_1=str_1 ; return ans_1 ;}   
         var  str_1= m_str_sub_ngt_bf_minus(str_1);   
         var nn_end = m_str_spc_count(str_1,spec_1);
    var n = 0;
    var nn_end = 0;
        var nn_end = m_str_spc_count(str_1,spec_1);   
     for(var n=0; n < nn_end ;n++){            
     var str_a_lg = str_1.length;
     var spec_1= spec;                      
     var spec_a_lg = spec_1.length;
     var pos =0;   
     var pos = str_1.indexOf(spec_1) ; 
     var mark_1 ="";   
     var mark_1 =str_1[pos +spec_a_lg];
     var mark_2 ="";
     var mark_2 =str_1[pos +spec_a_lg+1];  
     var count_a = 1 ;
     var count_mark=2500; 
         if(mark_1 =="("){        
            var nub_a=0;
            var nub_j=0; 
            var nub_t =0;
               for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   
                   var mark_ref = str_1[i];
                   if( mark_ref=='(' ) {                       
                      var nub_a=nub_a+1;}
                   if( mark_ref==')' ) {                        
                      var nub_j=nub_j+1;}
                      var nub_t = nub_j - nub_a ; 
                    if( nub_t ==0 && nub_a >= 1){        
                     var count_mark = i ;
                         i= str_a_lg+1;             }    
                                                  }    
                                           } 
         if(mark_1=="Q" && mark_2=="(" ){      
                   var nub_a=0;
                   var nub_j=0; 
                   var nub_t =0;
                  for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   
                   var mark_ref = str_1[i];
                   if( mark_ref=='(' ) {                        
                      var nub_a=nub_a+1;}
                   if( mark_ref==')' ) {                        
                      var nub_j=nub_j+1;}
                      var nub_t = nub_j - nub_a ; 
                    if( nub_t ==0 && nub_a >= 1){        
                      var count_mark = i ;
                         i= str_a_lg+1;             }     
                                                }    
                                           }
         if((mark_1 >=0 && mark_1<=9)||(mark_1=="Q" && mark_2!="(")) {          
           for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='e' ) {      
                                                     }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }      
                                                    
                                                  }
                                  }
         
           if(mark_1 =='.') {                                     
           for(var i = pos + spec_a_lg+1;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )||mark_ref =='°'  || mark_ref =='π' || mark_ref=='Q'|| mark_ref=='e') {      
                                                       }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
          if(mark_1 =='π'|| mark_1 =='°') {  var count_mark = pos+spec_a_lg+1 } ;   
         var str_part_fst= str_1.substring(0 ,pos+spec_a_lg);              
         var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);     
         var str_part_lst= str_1.substring((pos+spec_a_lg+str_part_b.length) ,str_1.length);
         var str_part_b_fst = str_part_b.substr(0,1);    
         var str_part_lst_fst = str_part_lst.substr(0,1);
         var nn_hat = m_str_spc_count(str_1,"^");        
          if(nn_hat >=1  && mark_1 !="("){
             var str_part_fst=  str_part_fst.replace(spec_1 , "(TTT" );    
             var str_1=str_part_fst+"("+str_part_b+"))"+str_part_lst; 
                          }
         else if( nn_hat >=1 && mark_1 =="("){       
              var str_part_fst=  str_part_fst.replace(spec_1 , "(TTT" );        
              var str_1=str_part_fst+str_part_b+")"+str_part_lst;             
                  }
        else if( str_part_b_fst =="(" && str_part_lst_fst ==")"){
              var str_part_fst=  str_part_fst.replace(spec_1 , "TTT" );       
              var str_1=str_part_fst+str_part_b+str_part_lst;   }
         else{
              var str_part_fst=  str_part_fst.replace(spec_1 , "TTT" );    
              var str_1=str_part_fst+"("+str_part_b+")"+str_part_lst; 
                }
                  } 
            var str_2 = str_1.replace(/Q/g , "-");        
            var str_3 = str_2.replace(/TTT/g ,spec_1);
            var str_3 = str_3.replace(/exp/g ,"EXP");
            var str_3 = str_3.replace(/e\-/g ,"EN");     
             var str_3 = str_3.replace(/e/g ,"e+");    
             var str_3 = str_3.replace(/EN/g ,"e-"); 
             var str_3 = str_3.replace(/EXP/g ,"exp");
             var str_1 = str_3 ;    
          return str_3 ;
}

function m_str_spec_part_af_minus_sum(str){       
     var str_1 = str.toString().trim();
     var str_1_lg = str_1.length;
     var str_2 =""
     var str_3 =""
     var spec ="";
     var nn_end =0;          
     var i=0;
     var j=0;
     var k=0;
     var m=0;
     var n=0;
     var p=0;
     var str_1 = m_fact_many_minus(str_1);
   for(var t=0 ; t < str_1.length ;t ++){ 
          var str_1 =  str_1.replace(/\(0\-/g ,"\(\Q");}
   for(var i=0 ; i < 15 ;i ++){    
      if(i==0){ var spec = "asinh" ;}
      if(i==1){ var spec = "acosh" ;}
      if(i==2){ var spec = "atanh" ;}
      if(i==3){ var spec = "sinh" ;}
      if(i==4){ var spec = "cosh" ;}
      if(i==5){ var spec = "tanh" ;}
      if(i==6){ var spec = "asin" ;}
      if(i==7){ var spec = "acos" ;}
      if(i==8){ var spec = "atan" ;}
      if(i==9){ var spec = "sin" ;}
      if(i==10){ var spec = "cos" ;}
      if(i==11){ var spec = "tan" ;}
      if(i==12){ var spec = "exp" ;}
      if(i==13){ var spec = "ln" ;}
      if(i==14){ var spec = "log" ;}
    var spec_lg = spec.length;
     var str_2 =  m_str_spec_part_af_minus(str_1 ,spec);
      var nn_end = m_str_spc_count(str_2,spec);                
      for(var j=0 ; j <  nn_end ;j ++){    
      if(i==0){ var str_2 = str_2.replace(spec ,"AAA"); }   
      if(i==1){ var str_2 = str_2.replace(spec ,"BBB"); }   
      if(i==2){ var str_2 = str_2.replace(spec ,"CCC"); }   
       }  
     for(var k=0 ; k < nn_end ;k ++){    
      if(i==3){ var str_2 = str_2.replace(spec ,"DDD"); }    
      if(i==4){ var str_2 = str_2.replace(spec ,"EEE"); }    
      if(i==5){ var str_2 = str_2.replace(spec ,"FFF"); }    
             } 
     for(var m=0 ; m < nn_end ;m ++){   
      if(i==6){var str_2 = str_2.replace(spec ,"GGG"); }    
      if(i==7){var str_2 = str_2.replace(spec,"HHH"); }    
      if(i==8){var str_2 = str_2.replace(spec ,"III"); }    
     } 
   for(var n=0 ; n < nn_end ;n ++){    
       if(i==9){var str_2 = str_2.replace(spec ,"JJJ"); }    
      if(i==10){ var str_2 = str_2.replace(spec,"KKK"); }   
      if(i==11){ var str_2 = str_2.replace(spec ,"LLL"); }   
      } 
    for(var p=0 ; p < nn_end ;p ++){    
      if(i==12){ var str_2 = str_2.replace(spec ,"MMM"); }     
      if(i==13){ var str_2 = str_2.replace(spec ,"NNN"); }    
      if(i==14){ var str_2 = str_2.replace(spec ,"PPP"); }    
      } 
     var str_1 = str_2 ;
                              } 
      var str_2 =  str_2.replace(/AAA/g ,"asinh");   
      var str_2 =  str_2.replace(/BBB/g ,"acosh");
      var str_2 =  str_2.replace(/CCC/g ,"atanh");
      var str_2 =  str_2.replace(/DDD/g ,"sinh");
      var str_2 =  str_2.replace(/EEE/g ,"cosh");
      var str_2 =  str_2.replace(/FFF/g ,"tanh");
      var str_2 =  str_2.replace(/GGG/g ,"asin");
      var str_2 =  str_2.replace(/HHH/g ,"acos");
      var str_2 =  str_2.replace(/III/g ,"atan");
      var str_2 =  str_2.replace(/JJJ/g ,"sin");
      var str_2 =  str_2.replace(/KKK/g ,"cos");
      var str_2 =  str_2.replace(/LLL/g ,"tan");
      var str_2 =  str_2.replace(/NNN/g ,"ln");
      var str_2 =  str_2.replace(/PPP/g ,"log");
      var str_2 =  str_2.replace(/\(Q/g ,"\(\-"); 
      var str_2 = m_hat_bf_aft_many_inv_minus(str_2 ,'^','');
      var str_2 = str_2.replace(/T/g , "^");
      var str_2 = str_2.replace(/Q/g , "-");
      var str_2 =  str_2.replace(/MMM/g ,"exp");
      var str_2 =  m_str_sub_ngt_bf_1(str_2) ;        
      var str_2 = m_e_bf_aft_many(str_2,"EP","");          
      var str_2 = m_e_bf_aft_many(str_2,"EQ","");          
      var str_2 =  m_str_sub_ngt_bf_1_bk(str_2) ;     
      return str_2 ;
}

function m_fun_aft(str,spec1,spec2){                   
   var str_1=str;                                               
   var spec_1=spec1;
   var spec_2=spec2;
   var part_aft =  m_str_spec_part_af(str_1 ,spec_1);
   var part_aft_lg = part_aft.length;
      if(part_aft_lg > 0 ){
         str_1 = str_1.replace(spec_1+part_aft , "("+spec2 +part_aft +")");     //20200813a         
                        }
     if(part_aft_lg == 0 && spec2 =="eee" ){  str_1 = str_1.replace(spec_1+part_aft , "("+spec2 +"("+1+')'+")" );  }   
      if(part_aft_lg == 0 && spec2 !="eee" ){  str_1 = "error,  not data" ; }
   return str_1;
}


function m_star_deg_rem(str){                     
 var str_1 = str;
    var dg_index = str_1.indexOf("°");   
       if(dg_index ==-1){ var ans_1 = str_1; return ans_1;}  
    var str_1 = str_1.replace("*°","°");  
    var str_1 = str_1.replace("e+","e");  
  
    var part_bf = m_str_spec_part_bf(str_1 ,"°"); 
    var star_str_lg = str_1.length 
    var part_bf_lg = part_bf.length ; 
    var dg_index = str_1.indexOf("°");               
    var str_bf = str_1.substr(0,dg_index -part_bf_lg);  
    var str_af = str_1.substr(dg_index+1 ,star_str_lg-dg_index-1);  
                if(dg_index ==-1){  return str; } ;  
                  var bf_op_data = dg_index-part_bf_lg-1 ;
                     if(bf_op_data ==-1){ var bf_op ="";}
                      else {var bf_op = str_1.substr(dg_index-part_bf_lg-1,1); } 
 
                    var af_op = str_1.substr(dg_index+1,1); 
                    var af2_str_bf = str_bf.substr(str_bf.length-2,2);  
                    var bf2_str_af = str_af.substr(0,2);                
               if( bf_op =="*" || bf_op =="/" || bf_op =="^"  ||af_op =="*" || af_op =="/" || af_op =="^" || af2_str_bf =="((" || af2_str_bf =="/("|| af2_str_bf =="*("|| af2_str_bf =="^(" || bf2_str_af =="))" || bf2_str_af ==")*" ||bf2_str_af ==")/" ||bf2_str_af ==")^" ){
                  part_bf = part_bf.replace("°" , "D");      
                  str_1 = str_bf + part_bf +"°"+ str_af;
                        return str_1; 
                 }
      var part_af = m_str_spec_part_af(str_1 ,"°");
      var part_bf = part_bf.replace("Q","-");  
      var nub_point= m_str_char(part_bf,".") ;  
          if(nub_point >2){        
              var ans_1 = message_1(30);   
                         return  ans_1  }
       var part_bf  = m_str_e_to_str(part_bf);     
       var bf_pos_pot = part_bf.indexOf(".");   
       var part_bf_lg = part_bf.length;
                   var part_bf_b1 = m_nub_m(part_bf);      
                   var part_bf_a1 = m_nub_p(part_bf);       
                   var part_bf_a1 = part_bf_a1.toString().substr(1,part_bf_a1.length-1); 
                   if(part_bf_b1==""){ var part_bf_b1 =1 ;}                                 
                   var part_bf_b = m_mtx_real_div(part_bf_b1 ,360 );      
                   var part_bf_b  = m_str_e_to_str(part_bf_b);      
                   var part_bf_bb = m_nub_p(part_bf_b);               
                   var part_bf_bbb = m_mtx_real_mul(part_bf_bb ,360 ); 
                   var part_bf_bbbb = m_fix( part_bf_bbb,0) ; 
                   var fst_part_bf = part_bf.substr(0,1);
                     if(fst_part_bf =="-"){
                           var part_bf = "-"+part_bf_bbbb.toString()+part_bf_a1.toString();}     
                     else{ var part_bf = part_bf_bbbb.toString()+part_bf_a1.toString();}
     if(part_bf_lg ==0){ var part_bf= "D" ; }                  
     if(part_bf_lg !=0 && part_bf != 0 && part_bf != 1 ){ var part_bf= part_bf+"D" ; }   
     if(part_bf_lg !=0 && part_bf == 0){ var part_bf= "0";}
     if(part_bf_lg !=0 && part_bf == 1){ var part_bf= "D" ; }   
              var str_new ="";
              var str_new = str_bf + part_bf + str_af;
                if(str_new=="0-0" || str_new=="-0" ){ var str_new="0";}
                     var str_new_lg = str_new.length;
                     var str_new_fst_sec = str_new.substr(0,2); 
                     var str_new_lst_sec = str_new.substr(str_new_lg-2,2);   
                     if(str_new_fst_sec =="0-" ){ str_new = str_new.substr(1,str_new_lg-1);}    
                     if(str_new_lst_sec =="-0" ){ str_new = str_new.substr(0,str_new_lg-2);}    
     return str_new;w;

   }


function m_star_deg_rem_many(str){                                 
   var str_1 = str;
   var nub_1 = m_str_spc_count(str_1,"°");   
   var  str_2 ="" ; 
      for(var i=0; i< nub_1 ; i++){
         var str_2 =  m_star_deg_rem(str_1);   
          var str_1 = str_2 ;  
               }
        str_1 = str_1.toString().replace( /D/g, "°") ;  
     return  str_1;
  }

function m_str_spec_part_af_e(str ,spec){     
     var str_1 = str.toString().trim();
     var str_0 =str_1 ;                    
     var str_a_lg = str_1.length;
     var spec_1= spec;
     var spec_a_lg = spec_1.length;
      if( spec_1=="π" || spec_1=="°"){ var ans_1="" ; return ans_1 ;}  
     var nub_ep = m_str_spc_count(str_1,"exp");   //count "exp" 
        if(nub_ep !=0){
           var str_1 = str_1.replace(/exp/g , "EXP");        
                       }   
     var pos = str_1.indexOf(spec_1) ;  
     var mark_1 =str_1[pos +spec_a_lg];          
     var count_a = 1 ;
     var count_mark=2500;  //增加 長運算
        if(mark_1 =="("){
           for(var i= (pos + spec_a_lg+1) ; i < str_a_lg+1  ; i++){    
              var mark_ref = str_1[i];
                 if(mark_ref =="("){
                     count_a = count_a +1 ;}
                 if(mark_ref ==")"){
                     count_a = count_a-1 ;}
                  if(count_a==0){
                     var count_mark = i+1 ;
                       i = str_a_lg ;                                     
                                 }
                                                   }
                           }
        if(mark_1 >=0 && mark_1<=9) {
           for(var i = pos + spec_a_lg;  i < str_a_lg+1  ; i++){   
              var mark_ref = str_1[i];
                 if((mark_ref <= 9 && mark_ref >= 0 ) || mark_ref=='.'|| mark_ref=='Q'|| mark_ref=='P'|| mark_ref=='e' ) {      
                                                       }
                   else{  
                     var count_mark = i ;
                         i= str_a_lg;                      }       
                                                    
                                                  }
                                  }
         var str_part_b= str_1.substring(pos+spec_a_lg ,count_mark);     
            if(nub_ep !=0){
           var str_1 = str_1.replace(/EXP/g , "exp");      
                       }  
       return str_part_b;
}


function m_str_spec_part_bf_e(str ,spec){          
     var str_1 = str.toString().trim();
     var spec_1= spec;
     var nub_ep =0;     
         var nub_ep = m_str_spc_count(str_1,"exp");    
       if(nub_ep !=0){
           var str_1 = str_1.replace(/exp/g , "EXP");         
                       }   
     var pos = str_1.indexOf(spec_1) ; 
     var mark_1 =str_1[pos - 1];        
     var count_1 = 1 ;
     var count_mark = pos ;
       if(mark_1 >=0 && mark_1<=9) {  
            var count_mark = pos-1;   
          for(var i = pos - 2; 0 <= i   ; i=i-1){
              var mark_ref = str_1[i];
                   if((mark_ref <= 9 && mark_ref >= 0 )|| mark_ref=='.'|| mark_ref=='Q' || mark_ref=='P'){      
                        var count_mark = i ;
                                                       }
                   else{  
                          i=-1 ;                                
                                             }     
                                                  }
                                  }
         var str_part_b= str_1.substring(count_mark,pos);
           if(nub_ep !=0){
           var str_1 = str_1.replace(/EXP/g , "exp");         
                       } 
   return str_part_b;
}



function m_e_bf_aft(str,spec1,spec2){                 
  var str_1=str;                                              
   var spec_1=spec1;
   var spec_2=spec2;
   var part_aft ="";
   var part_bf = m_str_spec_part_bf_e(str_1 ,spec1);    
   var part_bf_lg = part_bf.length;
   var part_aft =  m_str_spec_part_af_e(str_1 ,spec_1);   
   var part_aft_lg = part_aft.length;
   var part_aft_1=part_aft;
   var part_bf_1=part_bf;
   if(part_aft[0] =='(' && part_aft[part_aft_lg-1] ==')'){    
        part_aft_1= part_aft.substr(1,part_aft_lg-2);
    }
    else{  part_aft_1= part_aft;}
   if(part_bf[0] =='(' && part_bf[part_bf_lg-1] ==')'){    
          part_bf_1= part_bf.substr(1,part_bf_lg-2);
    }
    else{part_bf_1= part_bf;}
  if((part_bf_lg > 0)  && (part_aft_lg > 0 )){
            var spec_tt = -1;
            var spec_tt_idx =-1;
            var spec_tt_bf ="";
            var spec_tt_af ="";
            var spec_tt = part_bf_1 +spec_1+part_aft_1 ;  
            var spec_tt_idx =  m_str_spc_index(str_1,spec_tt);
             if(spec_tt_idx ==0){                                   
                 var spec_tt_bf = "";}                           
             else{ var spec_tt_bf = str_1.substr(spec_tt_idx-1,1);}
            var spec_tt_af = str_1.substr(spec_tt_idx+spec_tt.length,1);           
        if((spec_tt_bf =="(" && spec_tt_af ==")")||(spec_tt_bf =="" && spec_tt_af =="")){   
             str_1 = str_1.replace(part_bf+spec_1+part_aft , spec2 + part_bf_1 +"TT"+part_aft_1 ) ; } 
           else{  str_1 = str_1.replace(part_bf+spec_1+part_aft , "("+spec2 + part_bf_1 +"TT"+part_aft_1+")" ) ;}  
                                                   }        
    if(part_aft_lg == 0 || part_bf_lg == 0 ){  str_1 = "error,  not data" ; }
     return str_1;
}
 

function m_e_bf_aft_many(str,spec1,spec2){                  
   var str_1=str;
   var spec_1=spec1;
   var spec_2=spec2;
   var nub_1 =-1;
   var nub_1 = m_str_spc_count(str_1,spec_1);
   if((spec_1 =="EP" || spec_1 =="EQ" )&& nub_1>=1){  
          } 
   else{ return str ;} 
    for(var i=0; i< nub_1 ; i++){
          var  str_1 =  m_e_bf_aft(str_1,spec_1,spec_2);     
                 }
          var  str_1 =  str_1.replace(/TT/g , spec_1 )  ;  
  return  str_1;
  
}

function m_e_bf_aft_math(str,spec1,spec2){                 
  var str_1=str;                                              
   var spec_1=spec1;
   var spec_2=spec2;
   var part_aft ="";
   var part_bf = m_str_spec_part_bf_e(str_1 ,spec1);    
   var part_bf_lg = part_bf.length;
   var part_aft =  m_str_spec_part_af_e(str_1 ,spec_1);   
   var part_aft_lg = part_aft.length;
   var part_aft_1=part_aft;
   var part_bf_1=part_bf;
   if(part_aft[0] =='(' && part_aft[part_aft_lg-1] ==')'){    
          part_aft_1= part_aft.substr(1,part_aft_lg-2);
    }
    else{  part_aft_1= part_aft;}
    if(part_bf[0] =='(' && part_bf[part_bf_lg-1] ==')'){    
          part_bf_1= part_bf.substr(1,part_bf_lg-2);
    }
    else{part_bf_1= part_bf;}
   if((part_bf_lg > 0)  && (part_aft_lg > 0 )){
            var spec_tt = -1;
            var spec_tt_idx =-1;
            var spec_tt_bf ="";
            var spec_tt_af ="";
            var spec_tt = part_bf_1 +spec_1+part_aft_1 ;  
            var spec_tt_idx =  m_str_spc_index(str_1,spec_tt);                
             if(spec_tt_idx ==0){                                    
               var spec_tt_bf = "";}                           
             else{ var spec_tt_bf = str_1.substr(spec_tt_idx-1,1);}             
            var spec_tt_af = str_1.substr(spec_tt_idx+spec_tt.length,1);           
            if(spec_tt_bf =="(" && spec_tt_af ==")"){                                  
             str_1 = str_1.replace(part_bf+spec_1+part_aft , spec2 + part_bf_1 +"TT"+part_aft_1 ) ; }   
            else if(spec_tt_bf =="" && spec_tt_af ==""){            
              str_1 = str_1.replace(part_bf+spec_1+part_aft , spec2 + part_bf_1 +"TT"+part_aft_1 ) ; 
                    str_1 =  str_1+ "+"+"0";                   }                  
           else{  str_1 = str_1.replace(part_bf+spec_1+part_aft , "("+spec2 + part_bf_1 +"TT"+part_aft_1+")" ) ;}  
                                                      }        
       if(part_aft_lg == 0 || part_bf_lg == 0 ){  str_1 = "error,  not data" ; }
          var nub_point_bf=0;  //init
          var nub_point_af=0;  //init
          var nub_e_bf=0;
          var nub_e_af=0;   
          var nub_point_bf= m_str_char(part_bf_1,".") ;  
          var nub_e_bf= m_str_char(part_bf_1,"e") ;      
          var nub_point_af= m_str_char(part_aft_1,".") ;  
          var nub_e_af= m_str_char(part_aft_1,"e") ;      
          if( nub_point_bf >1 ||  nub_point_af >1 || nub_e_bf >=1 || nub_e_af >=1){
             var ans_1 = message_1(30);
                           return  ans_1  }
     return str_1;
}

function m_e_bf_aft_many_math(str,spec1,spec2){                   
   var str_1=str;
   var spec_1=spec1;
   var spec_2=spec2;
   var nub_1 = -1;
   var nub_1 = m_str_spc_count(str_1,spec_1);   
      if((spec_1 =="EP" || spec_1 =="EQ" )&& nub_1>=1){
                  }
       else{   return str ;}   //20200909
   for(var i=0; i< nub_1 ; i++){
          var  str_1 =  m_e_bf_aft_math(str_1,spec_1,spec_2);     
                   }
          var  str_1 =  str_1.replace(/TT/g , spec_1 )  ;  
   return  str_1;

}
function m_e_p_pow(bf,af){         
   var  bf_1= bf.toString().trim();
   var  bf_1= m_mtx_trim(bf_1) ;         
   var  af_1= af.toString().trim();
   var  af_1= m_mtx_trim(af_1) ;         
   var ans_1 ="";
   var ans_2 ="";
          var nub_point=0;  
          var nub_point_bf= m_str_char(bf_1,".") ;  
          var nub_e_bf= m_str_char(bf_1,"e") ;      
          var nub_point_af= m_str_char(af_1,".") ;  
          var nub_e_af= m_str_char(af_1,"e") ;      
          if( nub_point_bf >1 ||  nub_point_af >1 || nub_e_bf >=1 || nub_e_af >=1){
             var ans_1 = message_1(30);
                           return  ans_1  }
      if(nub_point_af==1){
         var ans_1 =m_pow(10,af_1);            
         var ans_2 =m_mtx_real_mul(bf_1, ans_1); 
         var  ans_2 =m_mtx_str_to_e_ne(ans_2) ;            
                         }
     else{ var ans_2 = bf_1+"e+"+af_1;}
    return  ans_2;
}




function m_e_n_pow(bf,af){        
   var  bf_1= bf.toString().trim();
   var  bf_1= m_mtx_trim(bf_1) ;         
   var  af_1= af.toString().trim();
   var  af_1= m_mtx_trim(af_1) ;         
   var ans_1 ="";
   var ans_2 ="";
         var nub_point=0;  
          var nub_point_bf= m_str_char(bf_1,".") ;  
          var nub_e_bf= m_str_char(bf_1,"e") ;      
          var nub_point_af= m_str_char(af_1,".") ;  
          var nub_e_af= m_str_char(af_1,"e") ;      
         if( nub_point_bf >1 ||  nub_point_af >1 || nub_e_bf >=1 || nub_e_af >=1){
             var ans_1 = message_1(30);
                          return  ans_1  }
           var af_1="-"+af_1 ; 
      if(nub_point_af==1){
         var ans_1 =m_pow(10,af_1); 
         var ans_2 =m_mtx_real_mul(bf_1, ans_1); 
         var  ans_2 =m_mtx_str_to_e_ne(ans_2) ;            
                       }
     else{ var ans_2 = bf_1+"e-"+af_1; }     
    return  ans_2;
} 


function m_hat_bf_aft(str,spec1,spec2){                   
   var str_1=str;                                              
   var spec_1=spec1;
   var spec_2=spec2;
   var part_aft ="";
   var part_bf = m_str_spec_part_bf(str_1 ,spec1);
   var part_bf_lg = part_bf.length;
   var part_aft =  m_str_spec_part_af(str_1 ,spec_1);
   var part_aft_lg = part_aft.length;
   var part_aft_1=part_aft;
   var part_bf_1=part_bf;
   if(part_aft[0] =='(' && part_aft[part_aft_lg-1] ==')'){    
          part_aft_1= part_aft.substr(1,part_aft_lg-2);
    }
    else{  part_aft_1= part_aft;}
   if(part_bf[0] =='(' && part_bf[part_bf_lg-1] ==')'){    
          part_bf_1= part_bf.substr(1,part_bf_lg-2);
    }
    else{part_bf_1= part_bf;}
   if((part_bf_lg > 0)  && (part_aft_lg > 0 )){
      str_1 = str_1.replace(part_bf+spec_1+part_aft , "("+spec2+"("+part_bf_1 +','+part_aft_1+")"+")" ) ;
                                                       }        
      if(part_aft_lg == 0 || part_bf_lg == 0 ){  str_1 = "error,  not data" ; }
    return str_1;
}

function m_hat_bf_aft_inv_minus(str,spec1,spec2){         
  var str_1=str;                                              
   var spec_1=spec1;
   var spec_2=spec2;
   var str_1 = str_1.replace(/exp/g ,"EXP");    
   var str_1 = str_1.replace(/e\-/g ,"eQ");     
   var str_1 = str_1.replace(/e\+/g ,"eP");       
   var part_aft ="";//初值
   var part_bf = m_str_spec_part_bf_inv(str_1 ,spec1);   
   var part_bf_lg = part_bf.length;
   var part_aft =  m_str_spec_part_af_inv(str_1 ,spec_1);  
   var part_aft_lg = part_aft.length;
   var part_aft_1=part_aft;
   var part_bf_1=part_bf;
   var pos = str_1.lastIndexOf(spec_1) ;  
   var str_part_b= str_1.substring(0 ,pos);    
   var str_part_a= str_1.substring(pos+spec_1.length ,str_1.length);    
   var nn_e_bf =0;
   var nn_e_aft = 0;
   var nn_e_bf_lst ="";
   var nn_e_aft_fst =""; 
   var nn_e_bf = m_str_spc_count(part_bf_1,"e");              
   var nn_e_bf_lst = part_bf_1.substr(part_bf_1.length-1,1);    
   var nn_e_aft = m_str_spc_count(part_aft_1,"e");           
   var nn_e_aft_fst = part_aft_1.substr(0,1);                
       if(nn_e_bf>=1 && nn_e_bf_lst !=")" ) { var part_bf_1= "("+part_bf_1+")";}
       if(nn_e_aft>=1 && nn_e_aft_fst !="(") { var part_aft_1= "("+part_aft_1+")";}
   var str_bf_test = str_part_b.substr( 0,str_part_b.length-part_bf.length);  //20201013
   var str_bf_test_lst = str_bf_test.substr(str_bf_test.length -1 ,1);        
   var str_af_test = str_part_a.substr(part_aft.length ,str_part_a.length-part_aft.length);
   var str_af_test_fst = str_af_test.substr(0,1);                               
       if(( str_bf_test_lst =="(" && str_af_test_fst ==")")||( str_bf_test_lst =="" && str_af_test_fst =="")){     }     
       else{
       if((part_bf_lg > 0)  && (part_aft_lg > 0 )&& (nn_e_aft_fst !="-")){                  
             str_1 = str_part_b.substr( 0,str_part_b.length-part_bf.length) +"("+ part_bf_1 + "T"+ part_aft_1 +")"+ str_part_a.substr(part_aft.length ,str_part_a.length-part_aft.length );
                                                      }
       if((part_bf_lg > 0)  && (part_aft_lg > 0 ) && (nn_e_aft_fst =="-")){                  
             str_1 = str_part_b.substr( 0,str_part_b.length-part_bf.length) +"("+ part_bf_1 + "T("+ part_aft_1 +"))"+ str_part_a.substr(part_aft.length ,str_part_a.length-part_aft.length );
                                                        } }
       if(part_aft_lg == 0 || part_bf_lg == 0 ){  str_1 = "error,  not data" ; }
             var str_1 = str_1.replace(/EXP/g ,"exp");    
             var str_1 = str_1.replace(/eQ/g ,"e\-");     
             var str_1 = str_1.replace(/eP/g ,"e\+");      
     return str_1;
}

function m_hat_bf_aft_inv(str,spec1,spec2){             
  var str_1=str;                                              
   var spec_1=spec1;
   var spec_2=spec2;
   var part_aft ="";
   var part_bf = m_str_spec_part_bf_inv(str_1 ,spec1);   
   var part_bf_lg = part_bf.length;
   var part_aft =  m_str_spec_part_af_inv(str_1 ,spec_1);   
   var part_aft_lg = part_aft.length;
   var part_aft_1=part_aft;
   var part_bf_1=part_bf;
   var part_aft_1= part_aft;
   var part_bf_1= part_bf ;
   var pos = str_1.lastIndexOf(spec_1) ;  //20200805
   var str_part_b= str_1.substring(0 ,pos);    
   var str_part_a= str_1.substring(pos+spec_1.length ,str_1.length);    
   var str_1 = str_part_b+"T"+str_part_a;            //20200805   
   if((part_bf_lg > 0)  && (part_aft_lg > 0 )){
        str_1 = str_1.replace(part_bf+"T"+part_aft , "("+part_bf_1 +","+part_aft_1+")" ) ;  }  
      if(part_aft_lg == 0 || part_bf_lg == 0 ){  str_1 = "error,  not data" ; }

     return str_1;
}

  function m_str_spc_count(str,spec){            
   var str_1 = str;
   var spec_1 = spec;
   var str_1_lg = str_1.length;
   var spec_1_lg = spec_1.length;
   var count_1 = 0;
     for(var i=0;i<str_1_lg;i++){
      var str_ref= str_1.substr(i,spec_1_lg) ;
            if(str_ref == spec_1){
               count_1=count_1+1;
                 i= i+ spec_1_lg -1 ;}  
                                }
     return count_1;

   }


function m_str_spc_index(str,spec){            
   var str_1 = str;
   var spec_1 = spec;
   var str_1_lg = str_1.length;
   var spec_1_lg = spec_1.length;
   var index_1 = 0;                      
     for(var i=0;i<(str_1_lg-spec_1_lg+1);i++){
       var str_ref= str_1.substr(i,spec_1_lg) ;
            if(str_ref == spec_1){
               index_1=i;
             return index_1;       
                                 }  
                                }
    return index_1;
   }


function m_str_spc_index_m(str,spec){            
  var str_1 = str;
   var spec_1 = spec;
   var str_1_lg = str_1.length;
   var spec_1_lg = spec_1.length;
   var nub_count =  m_str_spc_count(str_1,spec_1);            
   var A=m_new_mtx(nub_count,2); 
   var k=0 ;   
     for(var i=0;i<(str_1_lg-spec_1_lg+1);i++){
       var str_ref= str_1.substr(i,spec_1_lg) ;
            if(str_ref == spec_1){
                A[k][0]=i;
                A[k][1]= spec_1;
                k=k+1;                
                                 }  
                                }
     return A;
   }


function m_str_spc_index_m_2(str,spec_1,spec_2){            
   var str_a = str;
   var spec_a = spec_1;
   var spec_b = spec_2;
   var str_a_lg = str_a.length;
   var spec_a_lg = spec_a.length;
   var spec_b_lg = spec_b.length;
   var nub_count_a =  m_str_spc_count(str_a,spec_a);            
   var nub_count_b =  m_str_spc_count(str_a,spec_b);            
   var A=m_new_mtx((nub_count_a+nub_count_b),2); 
   var k=0 ;   
   var m=0 ;   
     for(var i=0;i < str_a_lg;i++){
       var str_ref_a= str_a.substr(i,spec_a_lg) ;
            if(str_ref_a == spec_a){
                A[k][0]=i;
                A[k][1]= spec_a;
                k=k+1;                
                                 }  
         var str_ref_b= str_a.substr(i,spec_b_lg) ;
            if(str_ref_b == spec_b){
                A[k][0]=i;
                A[k][1]= spec_b;
                k=k+1;               
                                  }     
                                }
  
     return A;
   }


function m_str_spc_index_m_2_sp(str,spec_1,spec_2){            
   var str_a = str;                                            
   var spec_a = spec_1;                                       
   var spec_b = spec_2;
   var str_a_lg = str_a.length;
   var spec_a_lg = spec_a.length;
   var spec_b_lg = spec_b.length;
   var nub_count_a =  m_str_spc_count(str_a,spec_a);            
   var nub_count_b =  m_str_spc_count(str_a,spec_b);            
   var A=m_new_mtx((nub_count_a+nub_count_b),2); 
   var k=0 ;   
   var m=0 ;   
     for(var i=0;i < str_a_lg;i++){
       var str_bf_a = str_a.substr(i-1,1) ;
       var str_af_h = str_a.substr(i+3,1) ;
       var str_af_a = str_a.substr(i+3,1) ;  
       var str_af_b = str_a.substr(i+1,1) ;  
       var str_ref_a= str_a.substr(i,spec_a_lg) ;
            if(str_ref_a == spec_a && str_bf_a !="a" && str_af_h !="h" && str_af_a !="(" ){
                A[k][0]=i;
                A[k][1]= spec_a;
                k=k+1;                
                                 }  
        var str_ref_b= str_a.substr(i,spec_b_lg) ;
            if(str_ref_b == spec_b && str_af_b !=")"  ){
                A[k][0]=i;
                A[k][1]= spec_b;
                k=k+1;                
                                 }     
                              }
   
     return A;

   }


function m_str_spc_index_m_2_st(str,spec_1,spec_2){            
   var str_a = str;                                           
   var spec_a = spec_1;                                      
   var spec_b = spec_2;
   var str_a_lg = str_a.length;
   var spec_a_lg = spec_a.length;
   var spec_b_lg = spec_b.length;
   var nub_count_a =  m_str_spc_count(str_a,spec_a);            
   var nub_count_b =  m_str_spc_count(str_a,spec_b);            
   var A=m_new_mtx((nub_count_a+nub_count_b),2); 
   var k=0 ;   
   var m=0 ;   
     for(var i=0;i < str_a_lg;i++){
       var str_bf_a = str_a.substr(i-1,1) ;
       var str_ref_a= str_a.substr(i,spec_a_lg) ;
            if(str_ref_a == spec_a && str_bf_a !="a" ){
                A[k][0]=i;
                A[k][1]= spec_a;
                k=k+1;               
                                }  
         var str_ref_b= str_a.substr(i,spec_b_lg) ;
            if(str_ref_b == spec_b  ){
                A[k][0]=i;
                A[k][1]= spec_b;
                k=k+1;                
                                 }     
                                }
    return A;
   
   }






function m_str_spc_inter(str,spec_1,spec_2){            
   var str_1 = str;
   var spec_a = spec_1;
   var spe2_2 = spec_2;
   var str_1_lg = str_1.length;
   var index_1 = 0; 
   var index_2 = 0; 
       index_1 = m_str_spc_index(str,spec_a);
       index_2 = m_str_spc_index(str,spe2_2);
   var new_str =str_1.substring(index_1,index_2+1);   
       return new_str;
   }



function m_str_spc_inter_2word(str,spec_1,spec_2){            
   var str_1 = str;
   var spec_a = spec_1;
   var spe2_2 = spec_2;
   var str_1_lg = str_1.length;
   var index_1 = 0; 
   var index_2 = 0; 
       index_1 = m_str_spc_index(str,spec_a);
       index_2 = m_str_spc_index(str,spe2_2);
   var new_str =str_1.substring(index_1,index_2+2);   
       return new_str;
   }


 function m_str_spc_inter_m_word(str,spec_1,spec_2){            
   var str_1 = str;                                             
   var spec_a = spec_1;  
   var spec_b = spec_2;  
   var str_1_lg = str_1.length;
   var index_1 = 0; 
   var index_2 = 0; 
       index_1 = m_str_spc_index(str,spec_a);
       index_2 = m_str_spc_index(str,spec_b);
   var new_str =str_1.substring((index_1+spec_a.length) ,(index_2+spec_b.length-1));   
       return new_str;

   }



function m_str_spc_end(str,spec){            
   var str_1 = str;
   var spec_1 = spec;
   var str_1_lg = str_1.length;
   var spec_1_lg = spec_1.length;
   var str_ref="";
     for(var i=(str_1_lg-spec_1_lg);i<str_1_lg;i=(i+spec_1_lg)){
      var str_ref= str_1.substr(i,spec_1_lg) ;
            if(str_ref == spec_1){
               return 1;         
                }  
           else{ 
                 return 0 ;}     
                               }
    
   }


  function m_fact_many(str){                         
      var str_1 = str;
      var nub_1 = m_str_spc_count(str_1,'!');   
          for(var i=0; i< nub_1 ; i++){
            str_1 =  m_fact(str_1);   
             }
      return  str_1;
  }

function m_fact_many_minus(str){                         
      var str_1 = str;
      var nub_1 = m_str_spc_count(str_1,'!');   
          for(var i=0; i< nub_1 ; i++){
            str_1 =  m_fact_minus(str_1);    
             }
      str_1 = str_1.replace( /T/g, "!") ;  
      return  str_1;
  }

 function m_star_many(str){                                 
   var str_1 = str;
    var nub_1 = m_str_spc_count(str_1,"π");   
    for(var i=0; i< nub_1 ; i++){
            str_1 =  m_star(str_1);   
               }
      str_1 = str_1.replace( /pi/g, "π") ;  
     return  str_1;  
  }

function m_star_rem_many(str,nub){                                 
   var str_1 = str;
    var nubb = nub;
    var nub_1 = m_str_spc_count(str_1,"π");   
    var  str_2 ="" ; 
    for(var i=0; i< nub_1 ; i++){
        var str_2 =  m_star_rem(str_1 ,nubb);   
         var str_1 = str_2 ;  
               }
            str_1 = str_1.toString().replace( /P/g, "π") ;  
     return  str_1;
  }



function m_lj_str(str){   
     var str_1 = str;
     var nub_l = m_str_spc_count(str_1,"(");   
     var nub_j = m_str_spc_count(str_1,")");    
      if( nub_l != nub_j){ var ans_1="error" ; return ans_1 ;}
      if( nub_l == 0){ var ans_1=str ; return ans_1 ;}
     var str_new ="";  
     if(nub_l > 0 ){
      var str_1_lg=str_1.length;
      var l_index = str_1.lastIndexOf("(");  
      var str_1_af = str_1.substr(l_index+1,str_1_lg-l_index-1);  
      var j_index = str_1_af.indexOf(")");  
      var str_1_m = str_1_af.substr(0,j_index);  
      var str_1= str_1_m;
        }
     return  str_1;
}


 function m_star_deg_many(str){                                
 var str_1 = str;
    var nub_1 = m_str_spc_count(str_1,"°");   
      for(var i=0; i< nub_1 ; i++){
            str_1 =  m_star_deg(str_1);   
             }
    str_1 = str_1.replace( /deg/g, "°") ;  
      return  str_1;
 }


function m_fun_aft_many(str,spec1,spec2){                     
   var str_1=str;
   var spec_1=spec1;
   var spec_2=spec2;
   var nub_1 = m_str_spc_count(str_1,spec_1);   
   for(var i=0; i< nub_1 ; i++){
            str_1 =  m_fun_aft(str_1,spec_1,spec_2);     
               }
       return  str_1;
}



function m_hat_bf_aft_many(str,spec1,spec2){                   
   var str_1=str;
   var spec_1=spec1;
   var spec_2=spec2;
   var nub_1 = m_str_spc_count(str_1,spec_1);   
   for(var i=0; i< nub_1 ; i++){
            str_1 =  m_hat_bf_aft(str_1,spec_1,spec_2);     
                   }
   return  str_1;
}


function m_hat_bf_aft_many_inv(str,spec1,spec2){        
   var str_1=str.toString().trim();
   var spec_1=spec1;
   var spec_2=spec2;
   var data_fst = str_1.substr(0,1);
   var nub_1 = m_str_spc_count(str_1,spec_1);   
       for(var i = nub_1; i>0 ; i--){
            str_1 =  m_hat_bf_aft_inv(str_1,spec_1,spec_2);     
                }
         str_1 = str_1.replace( /\,/g, "\^") ;  
         str_1 = str_1.replace( /T/g, "\^") ;
  return  str_1;
    
}

function m_hat_bf_aft_many_inv_minus(str,spec1,spec2){        
   var str_1=str.toString().trim();
   var spec_1=spec1;
   var spec_2=spec2;
   var data_fst = str_1.substr(0,1);
   var nub_1 = m_str_spc_count(str_1,spec_1);   
     for(var i = nub_1; i>0 ; i--){
            str_1 =  m_hat_bf_aft_inv_minus(str_1,spec_1,spec_2);    
                   }
           str_1 = str_1.replace( /\,/g, "\^") ;  
           str_1 = str_1.replace( /T/g, "\^") ;
   return  str_1;
    
}

function m_str_b_sec(str,spec){     
   var str_1 = str;
   var spec_1 = spec;
   var index_a= m_str_spc_index(str_1,spec_1);           
   var str_b_part=str_1.substr(0 ,index_a);
   return  str_b_part;
}



function m_str_math_replacec(this_it){         
       var this_it_a = this_it;
           this_it_a = this_it_a.toLowerCase(); 
           this_it_a = this_it_a.replace(/q/g , "Q");
           this_it_a = m_fun_aft_many(this_it_a ,' ','');
       var this_it_a =  m_str_sub_ngt_bf_1_math(this_it_a) ; 
       var this_it_a =  m_e_bf_aft_many_math(this_it_a,"EPQ",""); 
       var this_it_a =  m_e_bf_aft_many_math(this_it_a,"EQ","");          
       var this_it_a =  m_str_sub_ngt_bf_1_bk_math(this_it_a) ;  
           this_it_a = this_it_a.replace(/e-/g , "eQ");      
           this_it_a = this_it_a.replace(/e\+/g , "e");  
           this_it_a = m_fact_many(this_it_a); 
           this_it_a = m_hat_bf_aft_many_inv(this_it_a ,'^','');   
           this_it_a = m_hat_bf_aft_many(this_it_a ,'^','hhh');
           this_it_a = this_it_a.replace(/hhh/g , "m_pow"); 
           this_it_a = m_fun_aft_many(this_it_a ,'asinh','azh');       
           this_it_a = m_fun_aft_many(this_it_a ,'asin','azz');   
           this_it_a = m_fun_aft_many(this_it_a ,'sinh','zzh');   
           this_it_a = m_fun_aft_many(this_it_a ,'sin','zzz');   
           this_it_a = m_fun_aft_many(this_it_a ,'acosh','ayh');   
           this_it_a = m_fun_aft_many(this_it_a ,'acos','ayy');   
           this_it_a = m_fun_aft_many(this_it_a ,'cosh','yyh');   
           this_it_a = m_fun_aft_many(this_it_a ,'cos','yyy');   
           this_it_a = m_fun_aft_many(this_it_a ,'atanh','axh');   
           this_it_a = m_fun_aft_many(this_it_a ,'atan','axx');   
           this_it_a = m_fun_aft_many(this_it_a ,'tanh','xxh');   
           this_it_a = m_fun_aft_many(this_it_a ,'tan','xxx');  
           this_it_a = m_fun_aft_many(this_it_a ,'exp','eee');  
           this_it_a = m_fun_aft_many(this_it_a ,'ln','nnn'); 
           this_it_a = m_fun_aft_many(this_it_a ,'log','ggg'); 
        
           this_it_a = this_it_a.replace(/azh/g , "m_asinh");         
           this_it_a = this_it_a.replace(/azz/g , "m_asin");     
           this_it_a = this_it_a.replace(/zzh/g , "m_sinh");     
           this_it_a = this_it_a.replace(/zzz/g , "m_sin");                
           this_it_a = this_it_a.replace(/ayh/g , "m_acosh");     
           this_it_a = this_it_a.replace(/ayy/g , "m_acos");     
           this_it_a = this_it_a.replace(/yyh/g , "m_cosh");     
           this_it_a = this_it_a.replace(/yyy/g , "m_cos");     
           this_it_a = this_it_a.replace(/axh/g , "m_atanh");      
           this_it_a = this_it_a.replace(/axx/g , "m_atan");     
           this_it_a = this_it_a.replace(/xxh/g , "m_tanh");     
           this_it_a = this_it_a.replace(/xxx/g , "m_tan");
  
           this_it_a = this_it_a.replace(/eee/g , "m_exp");   
           this_it_a = this_it_a.replace(/nnn/g , "m_ln");   
           this_it_a = this_it_a.replace(/ggg/g , "m_log");  
           this_it_a = m_hat_bf_aft_many(this_it_a ,'/','DDD');           
           this_it_a = this_it_a.replace(/DDD/g ,'m_mtx_real_div');    
           this_it_a = this_it_a.replace(/\/1°/g , "\/("+DEG+")");
           this_it_a = this_it_a.replace(/\/°/g , "\/("+DEG+")");
           this_it_a =  m_star_deg_many(this_it_a);           
           this_it_a = this_it_a.replace(/°/g , "("+DEG+")");
           this_it_a = m_replace_star(this_it_a) ;
           this_it_a = m_star_many(this_it_a); 
           this_it_a = this_it_a.replace(/atanh\(1\-/g , "artanhs\(0\-");    
           this_it_a = this_it_a.replace(/atanh\(0\-1\+/g , "artanha\("); 
return  this_it_a;
}
  
 function cursor_sec_recal_t( ){                
  var str_a = cursor_re_start(1);                
    var str_b = cursor_re_start(2);                
    var str_c = cursor_re_start(3);                
    var new_str ="";
    var str_2_0_1 = m_str_b_sec(str_b,"<--");          
    var str_2_0_2 = m_str_b_sec(str_b,"=");          
      if(str_2_0_1.length >0){
         var str_2_0=str_2_0_1;}
       else{
    var str_2_0=str_2_0_2;}
    var str_2_0_r =  m_str_math_replacec(str_2_0);     
    var str_2_0_r_ans = eval(str_2_0_r);             
      if( str_2_0_r_ans >=0 || str_2_0_r_ans < 0){    
       var new_str = str_a+str_2_0.toString().trim()+"="+str_2_0_r_ans.toString().trim()+";"+str_c ;
          document.getElementById('input').value = "";        
          document.getElementById('input').value = new_str;
                                           }
      else {
        var  str_2_0_r_ans =  m_str_spc_inter( str_2_0_r_ans,"<",">");    
         document.getElementById('input').value = "";        
         document.getElementById('input').value = str_a+str_2_0 ;
               newline_1();                 
         document.getElementById('input').value +=  str_2_0_r_ans+";" +str_c ;   
             }
  }



 function m_oct_nb(str_a) {             
 var stra=str_a;
  var lg=stra.length;
  var test_nub1=1;
  var test_nub2=1;
  if(lg>=200){ var test_nub1=100 ;}
    else { var test_nub1 = lg-1 ;}
   for(var i=0;i<test_nub1;i++){
     var char_1= stra.toString().substr(0,1);  
     var char_2= stra.toString().substr(1,1);  
     var index_1= m_str_spc_index(stra,"1") ; 
     var index_2= m_str_spc_index(stra,"2") ; 
     var index_3= m_str_spc_index(stra,"3") ; 
     var index_4= m_str_spc_index(stra,"4") ; 
     var index_5= m_str_spc_index(stra,"5") ; 
     var index_6= m_str_spc_index(stra,"6") ; 
     var index_7= m_str_spc_index(stra,"7") ; 
     var index_8= m_str_spc_index(stra,"8") ; 
     var index_9= m_str_spc_index(stra,"9") ; 
         if((char_1=="0" && (index_1==1 || index_2==1 ||index_3==1 || index_4==1 ||index_5==1 || index_6==1 ||index_7==1 || index_8==1 ||index_9==1 || char_2=="0" ))||char_1==""){ 
             var  stra=stra.substring(1,lg);
             var  lg=stra.length;    }   
                          }
    var lg=stra.length;  
      if(lg>=200){ var test_nub2=100 ;}
      else { var test_nub2 = lg-1 ;}
    for(var i=0;i<test_nub2 ;i++){       
        var stra =m_replace(stra ,"+00" ,"+0" ) ;         
        var stra =m_replace(stra ,"-00" ,"-0" ) ;         
        var stra =m_replace(stra ,"*00" ,"*0" ) ;           
        var stra =m_replace(stra ,"/00" ,"/0" ) ;         
        var stra =m_replace(stra ,"^00" ,"^0" ) ;          
        var stra =m_replace(stra ,"(00" ,"(0" ) ;        
        var stra =m_replace(stra ,"(-00" ,"(-0" );        
        var stra =m_replace(stra ,"+0000" ,"+0" ) ;        
        var stra =m_replace(stra ,"-0000" ,"-0" ) ;         
        var stra =m_replace(stra ,"*0000" ,"*0" ) ;           
        var stra =m_replace(stra ,"/0000" ,"/0" ) ;         
        var stra =m_replace(stra ,"^0000" ,"^0" ) ;         
        var stra =m_replace(stra ,"(0000" ,"(0" ) ;          
        var stra =m_replace(stra ,"(-0000" ,"(-0" );        
                                      }
        var stra =m_replace(stra ,"+01" ,"+1" ) ;         
        var stra =m_replace(stra ,"+02" ,"+2" ) ;        
        var stra =m_replace(stra ,"+03" ,"+3" ) ;          
        var stra =m_replace(stra ,"+04" ,"+4" )  ;        
        var stra =m_replace(stra ,"+05" ,"+5" ) ;         
        var stra =m_replace(stra ,"+06" ,"+6" ) ;          
        var stra =m_replace(stra ,"+07" ,"+7" ) ;         
        var stra =m_replace(stra ,"+08" ,"+8" ) ;         
        var stra =m_replace(stra ,"+09" ,"+9" );            
        var stra =m_replace(stra ,"-01" ,"-1" ) ;         
        var stra =m_replace(stra ,"-02" ,"-2" ) ;         
        var stra =m_replace(stra ,"-03" ,"-3" ) ;           
        var stra =m_replace(stra ,"-04" ,"-4" ) ;         
        var stra =m_replace(stra ,"-05" ,"-5" ) ;         
        var stra =m_replace(stra ,"-06" ,"-6" ) ;           
        var stra =m_replace(stra ,"-07" ,"-7" ) ;         
        var stra =m_replace(stra ,"-08" ,"-8" ) ;         
        var stra =m_replace(stra ,"-09" ,"-9" ) ;           
        var stra =m_replace(stra ,"*01" ,"*1" ) ;         
        var stra =m_replace(stra ,"*02" ,"*2" ) ;         
        var stra =m_replace(stra ,"*03" ,"*3" ) ;           
        var stra =m_replace(stra ,"*04" ,"*4" ) ;         
        var stra =m_replace(stra ,"*05" ,"*5" ) ;         
        var stra =m_replace(stra ,"*06" ,"*6" ) ;           
        var stra =m_replace(stra ,"*07" ,"*7" ) ;         
        var stra =m_replace(stra ,"*08" ,"*8" );          
        var stra =m_replace(stra ,"*09" ,"*9" ) ;           
        var stra =m_replace(stra ,"/01" ,"/1" );          
        var stra =m_replace(stra ,"/02" ,"/2" ) ;         
        var stra =m_replace(stra ,"/03" ,"/3" ) ;           
        var stra =m_replace(stra ,"/04" ,"/4" ) ;         
        var stra =m_replace(stra ,"/05" ,"/5" ) ;         
        var stra =m_replace(stra ,"/06" ,"/6" ) ;           
        var stra =m_replace(stra ,"/07" ,"/7" ) ;         
        var stra =m_replace(stra ,"/08" ,"/8" ) ;         
        var stra =m_replace(stra ,"/09" ,"/9" ) ;         
        var stra =m_replace(stra ,"^01" ,"^1" );          
        var stra =m_replace(stra ,"^02" ,"^2" );          
        var stra =m_replace(stra ,"^03" ,"^3" );            
        var stra =m_replace(stra ,"^04" ,"^4" ) ;         
        var stra =m_replace(stra ,"^05" ,"^5" );          
        var stra =m_replace(stra ,"^06" ,"^6" );            
        var stra =m_replace(stra ,"^07" ,"^7" ) ;         
        var stra =m_replace(stra ,"^08" ,"^8" );          
        var stra =m_replace(stra ,"^09" ,"^9" );            
        var stra =m_replace(stra ,"(01" ,"(1" ) ;         
        var stra =m_replace(stra ,"(02" ,"(2" );          
        var stra =m_replace(stra ,"(03" ,"(3" );            
        var stra =m_replace(stra ,"(04" ,"(4" ) ;         
        var stra =m_replace(stra ,"(05" ,"(5" ) ;         
        var stra =m_replace(stra ,"(06" ,"(6" ) ;           
        var stra =m_replace(stra ,"(07" ,"(7" ) ;         
        var stra =m_replace(stra ,"(08" ,"(8" ) ;         
        var stra =m_replace(stra ,"(09" ,"(9" );            
        var stra =m_replace(stra ,"(-01" ,"(-1" );          
        var stra =m_replace(stra ,"(-02" ,"(-2" ) ;         
        var stra =m_replace(stra ,"(-03" ,"(-3" );            
        var stra =m_replace(stra ,"(-04" ,"(-4" ) ;         
        var stra =m_replace(stra ,"(-05" ,"(-5" ) ;         
        var stra =m_replace(stra ,"(-06" ,"(-6" ) ;           
        var stra =m_replace(stra ,"(-07" ,"(-7" );          
        var stra =m_replace(stra ,"(-08" ,"(-8" ) ;         
        var stra =m_replace(stra ,"(-09" ,"(-9" ) ;         
   return stra ;
  }

   function m_abs(x){         
    var xx = x.toString().trim() ;
    var xx_fst=xx.substr(0,1);
     if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}
       return xx;
  }

 function m_sing(nub){        
    var nn = nub;
    var res = nn % 2;
       return res; 
    }

 function m_sgn(base,p){         
    var bb = base ;
    var pp = p ;
    var rr = m_sing(pp);
    var ans_1 = -1;
      if(bb==-1 && rr==0){
        ans_1 = 1;
        }
      return ans_1;
     }



function m_cut_nub_m_s(nub){             
    var nn = nub.toString().trim();               
    var nn_lg = nn.length;      
     var count_p =0 ;
     var pos_pot = nn.indexOf(".");   
     var nn_lg = nn.length;
     var point_index = m_str_spc_index(nn,".");            
    if(pos_pot != -1){               
       var count_p =  point_index;  
                     }
    else{ var count_p =  nn_lg ;}    
       return count_p;  
  }


function m_cut_nub_m(nub){             
    var nn = m_abs(nub);                
    var nn_lg = nn.toString().length;       
    var count_p =0 ; 
       for(var i =0  ; i < (nn_lg) ; i++){
            if(nn >=1 ){
              count_p =count_p +1;
               nn = nn/10;
                       }
                                  }
      if(nub < 0 ){count_p = count_p +1;}   
      if(nub == 0 ){count_p = -1;}   
      return count_p;    
  }

function m_cut_nub_p(nub){             
   var nn=nub;
    var nn_str = nn.toString().trim();
    var nn_lg = nn.toString().trim().length;  
    var nn_m = m_cut_nub_m(nub);       
    var e_index = m_str_spc_index(nn_str,"e");            
     if(e_index ==0){
       var count_p = nn_lg - nn_m -1 ;    
                    }
      else{
         var e_after = nn_str.substring(e_index+1,nn_lg); 
              var count_p =m_abs(e_after)+1;                    
          }
        return count_p;    
  }




function m_nub_m_s(nub){         
   var nn = nub.toString().trim();
   var mb = m_cut_nub_m_s(nn);   
   var ans_1= nn.toString().substr(0,mb);
    return ans_1;
}



function m_nub_m(nub){         
   var nn = nub.toString().trim();
   var pos_pot = nn.indexOf(".");   
   var pos_e = nn.indexOf("e");     
   var nn_lg = nn.length ;
   var ans_1 ="";
   if(pos_pot !=-1 ) { var ans_1=nn.substr(0,pos_pot); }   
   if(pos_pot ==-1 &&  pos_e ==-1) { var ans_1=nn ; }      
   if(pos_pot ==-1 &&  pos_e !=-1) { var ans_1=nn ; }      
   if(ans_1 == '-0' ){ var ans_1=0;}
  return ans_1;
}



function m_nub_p(nub){         
 var nn = nub;    
   var nn_lg =nn.length;
   var nn_str=nn.toString();
   var nn_first =nn_str.substr(0,1);
      if(nn_first=="-"){ var nn_abs = nn_str.substr(1,nn_lg-1);}
      else{ var nn_abs = nn_str;}
   var nn_abs_str = nn_abs.toString();  
   var str_lg = nn_abs_str.length;
   var data_t="";
          var pos_pot = nn_abs_str.indexOf(".");  
          var pos_e = nn_abs_str.indexOf("e");  
          var pos_ngt = nn_abs_str.indexOf("-");  
          var pos_pst = nn_abs_str.indexOf("+");  
    if(pos_pot != -1 && pos_e==-1 && pos_ngt==-1 && pos_pst ==-1){    
                          
          var data_t = nn_abs_str.substr( pos_pot,(str_lg - pos_pot));     
                   if(nn<0){  var data_t="-0"+data_t ; }  
                    else{      var data_t="0"+data_t ;}    
         
                              return data_t ; }                           
    else if( pos_e !=-1  && pos_ngt !=-1 && pos_pst ==-1 ){    
          if(pos_pot == -1){   
                 var data_bf = nn_abs_str.substr( 0,pos_e);}                                                      
           else{ var data_bf = nn_abs_str.substr( 0,pos_pot) + nn_abs_str.substr( pos_pot+1,pos_e-pos_pot-1); }  
           var data_af = nn_abs_str.substr(( pos_e+1),(str_lg-pos_e));   
           var data_af = m_abs(data_af);
               var data_a="0.";
                      while( data_af >1){
                             data_a = data_a+"0" ;
                            data_af= data_af-1;    
                                         }
               var data_t= data_a + data_bf ;
               if( nub < 0 ){  var data_t="-"+ data_t.toString();}
                        return data_t ;
      
                 }
      else if(pos_pot == -1 && pos_e ==-1 && pos_ngt==-1 && pos_pst ==-1){ return 0 ;}  
      else if( pos_e !=-1  && pos_pst !=-1){ return 0 ;}     
      else{ return "未處理" ;} 
      }


function m_round(nub){            
  var nub_a=nub;
   var nub_m= m_nub_m(nub_a);      
   var nub_p= m_abs(m_nub_p(nub_a));      
   var ans_1=0;
    if( nub_m >0 && nub_p >=0.5){  ans_1=nub_m+1; }
    if( nub_m >0 && nub_p < 0.5){  ans_1=nub_m ; }
    if( nub_m <0 && nub_p >=0.5){  ans_1=nub_m-1; }
    if( nub_m <0 && nub_p < 0.5){  ans_1=nub_m; }
     return ans_1; 
}



function m_fix_str_lst(nub){    
  var nub_str = nub.toString().trim();  
          var new_nub_str="";
           var nub_str_a = m_str_power(nub_str,1); 
           var str_lg =  nub_str_a.length ;        
           var pos_pot_e = nub_str_a.indexOf(".");    
           var str_lst = nub_str_a.substr(str_lg-1,1);
         if( pos_pot_e !=-1 && (str_lg-pos_pot_e) >200 && str_lst ==9){
         var new_nub_str = m_fix(nub_str,str_lg-pos_pot_e-5);
                }
         else{ 
                 var new_nub_str = nub_str;
                  return new_nub_str;
                                       }
     return new_nub_str;
}


function m_fix_pow_lst(nub){    
   var nub_str = nub.toString().trim();  
          var pos_e = nub_str.indexOf("e");     
          var pos_ngt = nub_str.indexOf("-");   
          var pos_pst = nub_str.indexOf("+");   
          var nub_e = m_str_power(nub_str,0); 
          var nub_e = nub_e.toString().trim();  
          var pos_pot_e = nub_e.indexOf(".");    
          var str_lg =  nub_e.length ;             
          var str_lst = nub_e.substr(str_lg-1,1); 
        if(pos_e !=-1 && pos_pot_e !=-1 && (str_lg-pos_pot_e) >200  && str_lst ==9){
          var nub_e_p = m_fix(nub_e,str_lg-pos_pot_e-2);
             if(nub_e_p <=0){
                var new_nub_str = m_str_power(nub_str,1)+"e"+ nub_e_p;       
                            }
              else{var new_nub_str = m_str_power(nub_str,1)+"e+"+ nub_e_p;}  
                                        }
          else{ 
                 var new_nub_str = nub;
                 return new_nub_str;
                                       }
     return new_nub_str;
}



function m_fix_pow(nub,pit_n){    
     var nub_str = nub.toString().trim();  
      var pos_e = nub_str.indexOf("e");     
      var pos_ngt = nub_str.indexOf("-");   
      var pos_pst = nub_str.indexOf("+");   
      var nub_e = m_str_power(nub_str,0);     
      var nub_e = nub_e.toString().trim();  
      var pos_pot_e = nub_e.indexOf(".");    
         if(pos_e !=-1 && pos_pot_e !=-1){
           var nub_e_p = m_fix(nub_e,pit_n);
         if(nub_e_p <=0){
                var new_nub_str = m_str_power(nub_str,1)+"e"+ nub_e_p;       
                             }
          else{var new_nub_str = m_str_power(nub_str,1)+"e+"+ nub_e_p;}  
                                        }
          else{ 
               var new_nub_str = nub;
                return new_nub_str;
                                       }
     return new_nub_str;
}

  function m_fix_end_9(x){    
   var sutt = x;  
   var slg = sutt.length;                
   var slg_end = sutt.substr(slg-1,1);   
   var s_idx_point = sutt.indexOf(".");  
   var s_fix = slg -s_idx_point-2;
    if(slg >=250 && slg_end=="9" && s_idx_point !=-1){  
     var sutt=m_fix(sutt,s_fix);  }                 
     return sutt;              
 }
 
 
function m_fix(nub,pit_n){                 
   var nn = nub;                           
   var nn_abs_str = nn.toString().trim(); 
  var nn_abs_str=m_mtx_trim(nn_abs_str).toString() ; 
   var str_lg = nn_abs_str.length;         
   var data_nn_test= nn_abs_str.substr(0,1); 
         if(data_nn_test=="-"){              
                 nn_abs_str = nn_abs_str.substr(1,str_lg-1);
                  str_lg = str_lg -1;       
                                }
          else{ nn_abs_str = nn_abs_str;}
   var pnn = pit_n ;  
   var pnn = parseInt(pnn);
   var data_t="";
          var pos_pot = nn_abs_str.indexOf(".");   
          var pos_e = nn_abs_str.indexOf("e");     
          var pos_ngt = nn_abs_str.indexOf("-");  
          var pos_pst = nn_abs_str.indexOf("+");   
          var nub_e =m_str_power(nn_abs_str,0);          
           if(pos_pot == -1){ return nub ;} 
               var chk_lg_1 = pos_e-pos_pot-1;
               var chk_lg_2 = str_lg-pos_pot-1; 
           if((pos_e == -1)&& chk_lg_2 <=pnn){ return nub ;}  
           if((pos_e != -1)&& chk_lg_1 <=pnn){ return nub ;}  
    var data_a_test  = nn_abs_str.substr((pos_pot+pnn+1),1);    
    var data_bf  = nn_abs_str.substr(0,pos_pot);                   
    var data_a   = nn_abs_str.substr((pos_pot+pnn),1);         
    if(pos_e !=-1 && (pos_e-pos_pot ) > pnn){ var data_af  = nn_abs_str.substr((pos_pot+1),pnn); }  
    if(pos_e !=-1 && (pos_e-pos_pot ) <= pnn) { return nn ; }                                        
    if(pos_e ==-1 && (nn_abs_str.length - pos_pot-1 ) > pnn){ var data_af  = nn_abs_str.substr((pos_pot+1),pnn); }   
    if(pos_e ==-1){var data_af  = nn_abs_str.substr((pos_pot+1),pnn); }                             
    if( pos_e ==-1 && data_af.toString().trim().length <  pnn) { return nn ; }                                 
    if( data_af.toString().trim().length >= pnn && (data_a_test=="e"||parseInt(data_a_test) <=4) && pos_e !=-1 ){      
             var data_t = data_bf +"."+data_af.substr(0,data_af.length)+ nn_abs_str.substr(pos_e,(nn_abs_str.length-pos_e)); 
                                     }
   if( data_af.toString().trim().length >= pnn && parseInt(data_a_test) <=4 && pos_e ==-1 ){      
              var data_t = data_bf +"."+data_af.substr(0,pnn); 
                                    }
  if( data_af.toString().trim().length >= pnn && parseInt(data_a_test) >= 5 ){  
              var mtx_col_this = parseInt(pnn/5);                   
              var data_comp_mtx_col_this_210 = m_mtx_real_str_comp(mtx_col_this,210); 
                 if( data_comp_mtx_col_this_210 == 2 ){ mtx_col_this =210;}                 
                 else{mtx_col_this =410;}  
               var AA =m_new_zero_mtx(1,mtx_col_this);                                        
               var  data_af_in="0."+data_af.toString();            
                   AA=m_mtx_point_in(AA,data_af_in);         
                        if(data_bf !=0){
                              var data_bf = data_bf.toString() +"00000";
                                          }
                         else{ var data_bf = data_bf;}
                   var data_aa00= AA[0][0];
                   var data_asdfg = m_mtx_int_add(data_bf,data_aa00);    
                           AA[0][0] = data_asdfg;
                    var data_so =Math.floor(pnn / 5) ;  
                    var data_re = 5-(pnn % 5) ;         
                        if(data_re==0){data_so=data_so-1;} 
                   AA[0][data_so] =parseInt(AA[0][data_so])+parseInt(Math.pow(10,data_re))  ; 
                      BB = m_mtx_cell_five(AA);              
                    var sum_tt = m_mtx_cell_five_show(BB );   
                        sum_tt = m_mtx_trim(sum_tt) ;   
                    var zz_m = m_nub_m(sum_tt) ;                
                    var zz_p = m_nub_p(sum_tt) ;                
               if(pos_e ==-1 && zz_p !=0){                                          
                  var data_t = zz_m +"."+ zz_p.substr(2,pnn);
                            }
                 if(pos_e ==-1 && zz_p ==0){                                          
                  var data_t = zz_m ;
                              }
                if(pos_e !=-1 && zz_p !=0){                                         
                 var data_t = zz_m +"."+ zz_p.substr(2,pnn)+ nn_abs_str.substr(pos_e,(nn_abs_str.length-pos_e)); 
                           }
                 if(pos_e !=-1 && zz_p ==0){                                          
                  var data_t = zz_m +"e"+nub_e; 
                          }
                                                    }

             data_t = m_mtx_trim(data_t) ;   
            data_t = data_t.replace(/\.\./g,'\.');   
                      data_t_fst=data_t.substr(0,1);        
                      data_t_sec=data_t.substr(1,1); 
                      if(data_t_fst==0 && data_t_sec =="e"){  var data_t=0 ; } 
                      if(data_t_fst=="." ){  var data_t="0"+data_t ; }    
                     var data_cp =  m_mtx_real_str_comp(data_t,0);      
             if(data_nn_test=="-" && data_cp !=3){  var data_t="-"+data_t ; }  
                   data_t = m_mtx_trim(data_t);       
                 return data_t ; 
      }





 function m_delay_1(){
    var d1= new Date();
    var tc = d1.getMilliseconds();
       return tc; 
  }


 function m_delay_ms(ms){
   var data_a = new Date();
   var cur_date =null;
     do{cur_date =new Date();}
     while((cur_date -data_a)  < ms ){}
  }



function s_chang_hidden_array(array_1){     
  var array_a = array_1;
   var array_a_lg = array_a.length;
   var array_nb="";
     for(var i=0; i< array_a_lg ; i++){
      array_nb=array_a[i];
        s_chang_hidden_nub(array_nb);
      }
}


function s_chang_hidden_nub(nub_1){      
   var nub_a = nub_1;
       document.getElementById(nub_a).disabled=true;                  
        document.getElementById(nub_a).style.opacity=0.5;
}
  


function s_nub_array(nub_1){           
    var nub_a=nub_1;
    var array_a=[];
     s_chang_visible_all();       
    switch(nub_a){
     case "1_0":
      array_a=["1_0","1_1","1_2","1_4","2_0","2_1","2_2","2_3","2_4","2_5","3_0","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_4","5_5"];
      break;
    case "1_1":
      array_a=["1_0","1_1","1_4","1_5","1_6","1_2","2_0","2_2","2_3","2_4","2_5","2_6","3_0","3_2","3_3","3_4","3_5","3_6","4_2","4_3","4_4","4_5","4_6","5_1","5_2","5_4","5_5","5_6"];
      break;
    case "1_2":
      array_a=["1_0","1_1","1_2","1_4","2_0","2_1","2_2","2_3","2_4","2_5","3_0","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_4","5_5"];  
      break;
    case "1_3":
      array_a=["1_2","1_5","1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_5"];
      break;
    case "1_4":
      array_a=["1_5","1_6","2_6","4_6","5_1","5_2","3_0","5_6"];
      break;
    case "1_5": 
      array_a=["1_0","1_1","1_4","2_0","2_1","2_2","2_3","2_4","2_5","3_0","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_4","5_5"];
     break;
    case "1_6":
      array_a=["1_2","1_5","1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_5","5_6"];
      break;
    case "2_0":
       array_a=["1_0","1_1","1_2","1_4","2_0","2_1","2_2","2_3","2_4","2_5","3_0","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_4","5_5"];
      break;
    case "2_1":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","4_1","4_2","4_6","5_2","5_6"];
      break;
    case "2_2":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","4_1","4_2","4_6","5_1","5_2","5_6"];  
      break;
    case "2_3":                
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "2_4":
     array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "2_5":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "2_6":
      array_a=["1_2","1_5","1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_5","5_6"];
      break;
     case "3_0":      
      array_a=["1_0","1_1","1_2","1_4","1_5","1_6","2_0","2_1","2_2","2_3","2_4","2_5","2_6","3_0","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_2","5_4","5_5","5_6"];    
      break;
    case "3_1":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","4_1","4_2","4_6","5_2","5_6"];
      break;
   case "3_2":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","3_6","4_1","4_2","4_6","5_1","5_2","5_6"];
      break;
     case "3_3":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "3_4":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "3_5":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "3_6":
      array_a=["1_2","1_5","1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_5","5_6"];
      break;
    case "4_1":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","4_1","4_2","4_6","5_2"];
      break;
    case "4_2":
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","3_6","4_1","4_2","4_6","5_1","5_2","5_6"];
      break;
    case "4_3":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "4_4":
      array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "4_5":
       array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "4_6":
      array_a=["1_2","1_5","1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_5","5_6"];
      break;
    case "5_1":                                                  
      array_a=["1_1","1_2","1_5","1_6","2_1","2_2","2_6","3_0","3_1","3_2","4_1","4_2","4_6","5_1","5_2","5_6"];
      break;
    case "5_2":
     array_a=["1_6","2_6","3_0","3_6","4_6","5_1","5_2","5_6"];  
      break;
    case "5_3":   
       array_a=["1_5","1_6","2_6","3_0","4_6","5_1","5_2","5_5"];
      break;
    case "5_4":
       array_a=["1_1","1_4","2_1","2_2","3_1","3_2","4_1","4_2","5_1"];
      break;
    case "5_5":
     array_a=["1_1","1_0","1_2","1_4","1_6","2_0","2_1","2_2","2_6","3_0","3_1","3_2","3_6","4_1","4_2","4_6","5_1","5_2","5_5","5_6",];
      break;
      case "5_6":
       array_a=["1_2","1_5","1_6","2_6","3_0","4_6","5_1","5_2","5_5","5_6"];
      break; 
     }
    return array_a;
 }



function s_map(item_1){
 var item_a = item_1;
  var item_a_p =item_a.substr(1,1);     
  var A = m_new_mtx(5,7);
  var B = m_new_mtx(5,7);
  var T = m_new_mtx(5,7);
  var item_map="" ;
  var A=[["°","a","!","<=x","(",")","/"],
        ["π","sin","exp","7","8","9","*"],
        ["e","cos","ln","4","5","6","-"],
        ["menu","tan","log","1","2","3","+"],
        ["open","h","^","ac","0",".","="]];                           
  var B=[["1_0","1_1","1_2","1_3","1_4","1_5","1_6"],
        ["2_0","2_1","2_2","2_3","2_4","2_5","2_6"],
        ["3_0","3_1","3_2","3_3","3_4","3_5","3_6"],
        ["4_0","4_1","4_2","4_3","4_4","4_5","4_6"],
        ["5_0","5_1","5_2","5_3","5_4","5_5","5_6"]];
    if( item_a_p =="_"){
        T=A;
        A=B;
        B=T;  }    
   var lg_c=A[0].length;    
   var lg_r=A.length;        
   for(var i=0; i<lg_r;i++){
     for(var j=0; j<lg_c;j++){
      if( item_a== A[i][j]){ 
          item_map=B[i][j] ;
                              } 
                           }
                          }
    return item_map;  
}



function s_chang_visible_all(){
for(var i=1;i <= 5;i++){     
       for(var j=0;j <= 6;j++){   
       var item_n= i+"_"+j;
          document.getElementById(item_n).disabled=false;
          document.getElementById(item_n).style.opacity=1;      
                            }
                          }
     
                  }


function s_chang_no_visible_all(){   
   for(var i=1;i <= 5;i++){     
       for(var j=0;j <= 6;j++){   
       var item_n= i+"_"+j;
          document.getElementById(item_n).disabled=true;
          document.getElementById(item_n).style.opacity=1;      
                            }
                         }
                  }

var COUNT_KEY = 0;                    
var KEY_MTX =  m_new_mtx(1,2000);      
var COUNT_KEYIN =1;                     
var KEY_MTXIN =  m_new_mtx(1,2000);     


function s_chang_sum(item){     
 s_chang_visible_all();       
   var item_1=item;
   var item_a= s_map(item_1);  
   COUNT_KEY = COUNT_KEY +1;
   var array_a = s_nub_array(item_a);      
    s_chang_hidden_array(array_a); 
}


function s_chang_sum_ini(){     
   s_chang_visible_all();       
   var item_1="=";
   var item_a= s_map(item_1);    
   var array_a = s_nub_array(item_a);      
     s_chang_hidden_array(array_a);     

}


  function s_check_nb(str){        
       var str_1=str;
      var befor_a = m_str_spc_count(str_1,"(");  
      var after_a = m_str_spc_count(str_1,")");   
           if( befor_a <=after_a){   
                           }
     }

 
   function s_check_end(str){                             
       var str_1=str;
       var asin_1 = m_str_spc_end(str_1,"asin");
       var acos_1 = m_str_spc_end(str_1,"acos");
      var asin_4 = m_str_spc_end(str_1,"asin-");       
       var acos_4 = m_str_spc_end(str_1,"acos-");
       var atan_4 = m_str_spc_end(str_1,"atan-"); 
       var acosh_1 = m_str_spc_end(str_1,"acosh");
       var atanh_1 = m_str_spc_end(str_1,"atanh");
       var atanh_2 = m_str_spc_end(str_1,"atanh-");
        var asin_3 = m_str_spc_end(str_1,"asin(");        
        var acos_3 = m_str_spc_end(str_1,"acos(");
        var acosh_3 = m_str_spc_end(str_1,"acosh(");      
        var atanh_3 = m_str_spc_end(str_1,"atanh(");      
        var asin_5 = m_str_spc_end(str_1,"asin(-");        
        var acos_5 = m_str_spc_end(str_1,"acos(-");
        var acosh_5 = m_str_spc_end(str_1,"acosh(-");      
        var atanh_5 = m_str_spc_end(str_1,"atanh(-");      
        var atanh_6 = m_str_spc_end(str_1,"atanh-0");     
       var atanh_7 = m_str_spc_end(str_1,"atanh(-0");      
       var atanh_8 = m_str_spc_end(str_1,"atanh0");      
       var atanh_9 = m_str_spc_end(str_1,"atanh(0");     
       var asin1_1 = m_str_spc_end(str_1,"asin1");        
       var acos1_1 = m_str_spc_end(str_1,"acos1");
       var asin1_0 = m_str_spc_end(str_1,"asin0");         
       var acos1_0 = m_str_spc_end(str_1,"acos0");
       var asin_30 = m_str_spc_end(str_1,"asin(0");        
       var acos_30 = m_str_spc_end(str_1,"acos(0");
       var asin_50 = m_str_spc_end(str_1,"asin(-0");        
       var acos_50 = m_str_spc_end(str_1,"acos(-0"); 
       var asin1_3 = m_str_spc_end(str_1,"asin(1");         
       var acos1_3 = m_str_spc_end(str_1,"acos(1");
       var asin_1_1 = m_str_spc_end(str_1,"asin-1");         
       var acos_1_1 = m_str_spc_end(str_1,"acos-1");
       var asin_1_3 = m_str_spc_end(str_1,"asin(-1");        
       var acos_1_3 = m_str_spc_end(str_1,"acos(-1");
       var ln_0 = m_str_spc_end(str_1,"ln0");        
       var log_0 = m_str_spc_end(str_1,"log0");        
       var ln_0_3 = m_str_spc_end(str_1,"ln(0");        
       var log_0_3 = m_str_spc_end(str_1,"log(0");        
       var ln_5 = m_str_spc_end(str_1,"ln(");        
       var log_5 = m_str_spc_end(str_1,"log(");        
       var ln_1 = m_str_spc_end(str_1,"ln0.");        
       var log_1 = m_str_spc_end(str_1,"log0.");        
       var ln_1_3 = m_str_spc_end(str_1,"ln(0.");        
       var log_1_3 = m_str_spc_end(str_1,"log(0.");        
       var a_0=m_str_spc_end(str_1,"0");        
       var a_1=m_str_spc_end(str_1,"1");         
       var a_2=m_str_spc_end(str_1,"2");         
       var a_3=m_str_spc_end(str_1,"3");        
       var a_4=m_str_spc_end(str_1,"4");         
       var a_5=m_str_spc_end(str_1,"5");         
       var a_6=m_str_spc_end(str_1,"6");        
       var a_7=m_str_spc_end(str_1,"7");         
       var a_8=m_str_spc_end(str_1,"8");         
       var a_9=m_str_spc_end(str_1,"9");        
       var a_ =m_str_spc_end(str_1,".");           
var array_a=[];    
          if(a_0==1 || a_1==1 || a_2==1 || a_3==1 ||a_4==1 || a_5==1 || a_6==1 || a_7==1 ||a_8==1 || a_9==1 || a_==1 ){                                             
                array_a=["1_1","2_1","2_2","3_1","3_2","4_1","4_2"]; }
          if(asin_1==1 || acos_1==1 ){                                             
                array_a=["1_2","2_0","4_2"];} 
         if( asin_4==1 || acos_4==1 ){                                                    
             array_a=["1_1","1_2","2_0","2_1","2_2","2_3","2_4","2_5","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_4","4_5"]; }
          if( atan_4==1 ){                                                    
             array_a=["1_1","1_2","2_1","2_2","3_1","3_2","4_1","4_2",]; }
          if(asin_3==1 || acos_3==1||asin_5==1 || acos_5==1 ){                                             
                array_a=["1_2"]; }  
          if(acosh_1==1 || acosh_5==1){                    
                array_a=["1_0","3_6"]; }
          if(atanh_1==1 ||atanh_2==1  || atanh_5==1){                 
                 array_a=["2_0"]; }
          if(atanh_6==1 ||atanh_7==1 || atanh_8==1 || atanh_9==1){                 
                array_a=["2_0","2_3","2_4","2_5","3_3","3_4","3_5","4_3","4_4","4_5"]; }
          if(asin1_1==1 || acos1_1==1 ||asin_1_1==1 || acos_1_1==1 ||asin1_3==1 || acos1_3==1 ||asin_1_3==1 || acos_1_3==1  ){                 
                array_a=["1_0","1_1","1_2","2_1","2_0","2_2","2_3","2_4","2_5","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_2","5_4","5_5"];
                  }
          if(asin1_0==1 || acos1_0==1 ||asin_30==1 || acos_30==1||asin_50==1 || acos_50==1 ){                 
                array_a=["1_0","1_1","1_2","2_1","2_0","2_2","2_3","2_4","2_5","3_1","3_2","3_3","3_4","3_5","4_1","4_2","4_3","4_4","4_5","5_1","5_2","5_4"];
                  } 
          if(ln_0==1 || log_0==1 || ln_0_3==1 || log_0_3==1){                 
                array_a=["1_0","1_1","1_2","1_4","1_5","1_6","2_0","2_1","2_2","2_3","2_4","2_5","2_6","3_1","3_2","3_3","3_4","3_5","3_6","4_1","4_2","4_3","4_4","4_5","4_6","5_1","5_2","5_4"];
                  }
          if(ln_5==1 || log_5==1 ){                 
                array_a=["3_6"];
                  }
          if(ln_1==1 || log_1==1 || ln_1_3==1 || log_1_3==1){ 
                array_a=["4_2","5_2"];  
             }
         if(asin_1==1 || acos_1==1 ){                                             
            document.getElementById("5_4").style.color="Green";  ////20201231
            document.getElementById("5_4").style.background="yellow";  
            document.getElementById("5_5").style.color="Green"; 
            document.getElementById("5_5").style.background="yellow";  
            document.getElementById("4_3").style.color="Green";
            document.getElementById("4_3").style.background="yellow";}  
         else if(atanh_1==1 ||atanh_2==1  || atanh_5==1){              
            document.getElementById("5_4").style.color="Green"; 
            document.getElementById("5_4").style.background="yellow";  
            document.getElementById("5_5").style.color="Green";  
            document.getElementById("5_5").style.background="yellow";  
            document.getElementById("4_3").style.color="blue";
            document.getElementById("4_3").style.backgroundColor = "transparent"; }   
          else if(acosh_1==1 || acosh_5==1){                                                 
             document.getElementById("5_4").style.color="Red"; 
             document.getElementById("5_4").style.background="yellow";  
             document.getElementById("5_5").style.color="Red";      
             document.getElementById("5_5").style.background="yellow";  
             document.getElementById("4_3").style.color="blue";
             document.getElementById("4_3").style.backgroundColor = "transparent";  } 
        else{ document.getElementById("4_3").style.color="blue";
             document.getElementById("4_3").style.backgroundColor = "transparent";  
             document.getElementById("5_4").style.color="blue"; 
             document.getElementById("5_4").style.backgroundColor = "transparent";  
             document.getElementById("5_5").style.color="blue"; 
             document.getElementById("5_5").style.backgroundColor = "transparent";}  
       s_chang_hidden_array(array_a);      
  }



function s_check_str_char(str,char_a ){       
     var str_1= str;
     var str_lg = str_1.length;
     var char_1=char_a;
     var char_lg=char_1.length;
     var A = m_new_mtx(1,str_lg); 
     var data_a = -1;
     var jj=0;
     var data_count=0;
  for(var i=0;i<str_lg;i++){
    var data_a = str_1.indexOf(char_1,i);
          if(data_a >=0){  A[0,jj]=data_a;
               data_count=data_count+1;
               jj=jj+1;
              var i=data_a+(char_lg-1) ;       
                 }
      }
    return  data_count ; 
 }


function s_check_str_equal(str ){   
var str_1=str;
   var data_a = s_check_str_char(str_1,"=");
   var data_a = s_check_str_char(str_1," ");
     return  data_a ;    
}

function s_check_str_equation(str ){      
  var str_1=str;
      str_1 = str_1.replace(/m_mtx_real_add/g,''); 
      str_1 = str_1.replace(/m_mtx_real_sub/g,'');
      str_1 = str_1.replace(/m_mtx_real_mul/g,'');
      str_1 = str_1.replace(/m_mtx_real_div/g,'');
      str_1 = str_1.replace(/m_exp_ln/g,'');     
      str_1 = str_1.replace(/m_ln_exp/g,''); 
      str_1 = str_1.replace(/m_sinh_asinh/g,'');    
      str_1 = str_1.replace(/m_asinh_sinh/g,'');
      str_1 = str_1.replace(/m_cosh_acosh/g,'');   
      str_1 = str_1.replace(/m_acosh_cosh/g,'');
      str_1 = str_1.replace(/m_tanh_atanh/g,'');   
      str_1 = str_1.replace(/m_atanh_tanh/g,'');
      str_1 = str_1.replace(/m_sin_asin/g,''); 
      str_1 = str_1.replace(/m_sin_acos/g,'');  
      str_1 = str_1.replace(/m_asin_sin/g,'');
      str_1 = str_1.replace(/m_asin_cos/g,'');  
      str_1 = str_1.replace(/m_cos_acos/g,'');
      str_1 = str_1.replace(/m_cos_asin/g,'');   
      str_1 = str_1.replace(/m_acos_cos/g,'');
      str_1 = str_1.replace(/m_acos_sin/g,'');  
      str_1 = str_1.replace(/m_tan_atan/g,'');   
      str_1 = str_1.replace(/m_atan_tan/g,'');
      str_1 = str_1.replace(/m_tan_asin/g,'');  
      str_1 = str_1.replace(/m_tan_acos/g,'');  
      str_1 = str_1.replace(/m_sin_atan/g,'');  
      str_1 = str_1.replace(/m_cos_atan/g,'');
      str_1 = str_1.replace(/m_artanhs\(/g,''); 
      str_1 = str_1.replace(/m_artanha\(/g,'');
      str_1 = str_1.replace(/m_asinh\(/g,'');   
      str_1 = str_1.replace(/m_asin\(/g,'');    
      str_1 = str_1.replace(/m_sinh\(/g,'');    
      str_1 = str_1.replace(/m_sin\(/g,'');     
      str_1 = str_1.replace(/m_acosh\(/g,'');  
      str_1 = str_1.replace(/m_acos\(/g,'');    
      str_1 = str_1.replace(/m_cosh\(/g,'');    
      str_1 = str_1.replace(/m_cos\(/g,'');     
      str_1 = str_1.replace(/m_atanh\(/g,'');   
      str_1 = str_1.replace(/m_atan\(/g,'');    
      str_1 = str_1.replace(/m_tanh\(/g,'');    
      str_1 = str_1.replace(/m_tan\(/g,'');      
      str_1 = str_1.replace(/m_n\(/g,'');      
      str_1 = str_1.replace(/m_exp\(/g,'');    
      str_1 = str_1.replace(/m_ln\(/g,'');     
      str_1 = str_1.replace(/m_log\(/g,'');   
      str_1 = str_1.replace(/m_pow\(/g,'');
      str_1 = str_1.replace(/m_lrnn\(/g,''); 
      str_1 = str_1.replace(/m_lrnp\(/g,'');
      str_1 = str_1.replace(/\(/g,'');   
      str_1 = str_1.replace(/\)/g,'');   
      str_1 = str_1.replace(/\,/g,'');   
      str_1 = str_1.replace(/0|1|2|3|4|5|6|7|8|9/g,'');   
      str_1 = str_1.replace(/\+|\-|\*|\/|\.|\^/g,'');   
      str_1 = str_1.replace(/Q/g,'');   
      str_1 = str_1.replace(/π/g,'');   
      str_1 = str_1.replace(/°/g,''); 
      str_1 = str_1.replace(/e/g,'');   
      str_1 = str_1.replace(/h/g,'');   
      str_1=str_1.toString().trim();  
    return  str_1 ;

}





function m_new_mtx(rows,cols){
var A =new Array(rows);                          
      for(var m=0; m<A.length; m++){
          A[m]= new Array(cols); }                     
  return A;
}


function m_new_space_mtx(rows,cols){               
var A =m_new_mtx(rows,cols);                          
       for(var i=0;i<A.length ;i++){  
       for(var j=0;j<A[0].length ;j++){          
          A[i][j] ="";} }
  return A;
}



function m_new_zero_mtx(rows,cols){                    
    var A =m_new_mtx(rows,cols);                          
     for(var i=0;i<A.length ;i++){  
       for(var j=0;j<A[0].length ;j++){          
          A[i][j] =0;}}
  return A;
}

function m_new_unit_mtx(rows,cols){                    
var A =m_new_mtx(rows,cols);                          
     for(var i=0;i<A.length ;i++){  
       for(var j=0;j<A[0].length ;j++){          
          A[i][j] =1;}}
  return A;
}

function m_new_5_unit_mtx(rows,cols){                   
    var A =m_new_zero_mtx(rows,cols);                        
       A[0][0] =100000;
  return A;
}


function m_mtx_space_end(A){       
 var AA=A;
   var data_row = AA.length;   
   var data_col=AA[0].length;  
     BB = m_new_space_mtx(data_row,data_col);               
    for(var i=0;i<data_row ;i++){
       var k=0 ; 
    for(var j=0;j<data_col ;j++){
       var data_element = AA[i][j].toString();
         if(data_element !=""){       
             BB[i][k] = data_element;
                  var k=k+1 ;} }}
  return BB;
}


function m_mtx_element_str(A){        
 var AA=A;
  var data_row = AA.length;   
  var data_col=AA[0].length;  
  var str_new = "" ;                
    for(var i=0;i<data_row ;i++){
    for(var j=0;j<data_col ;j++){
      var data_element = AA[i][j].toString();
        if(data_element !=""){       
         var str_new=str_new+data_element; } }  }
         var str_new=str_new.trim();  
  return str_new ;
}


function m_mtx_scale(A,x){      
  var AA=A;
  var xx=x;
      var data_row = AA.length;   
      var data_col=AA[0].length;  
    for(var i=0;i<data_row ;i++){
     for(var j=0;j<data_col ;j++){
        AA[i][j]=AA[i][j]*xx; }}
 return AA;
}


function m_mtx_copy_mtx(A,B){      
  var AA=A;
  var BB=B;
 
      var data_row = AA.length;   
      var data_col=AA[0].length;  

    for(var i=0;i<data_row ;i++){

     for(var j=0;j<data_col ;j++){

        AA[i][j]= BB[i][j];   

                                }
                                 } 

  return AA;
}



function m_mtx_copy_col_mtx(A,B){      
  var AA=A;
  var BB=B;
      var data_row = AA.length;   
      var data_col=AA[0].length;  

    for(var i=0;i<data_row ;i++){     
     for(var j=0;j<(data_col-1) ;j++){
        AA[i][j]=BB[i][j+1]; 
       
                                            }
                                 } 


  return AA;
}



function m_mtx_point_add_total(x,y){     
  var A=m_new_zero_mtx(1,MTX_COL);            
  var B=m_new_zero_mtx(1,MTX_COL);            
  var C=m_new_zero_mtx(1,MTX_COL);                
      A=m_mtx_point_in(A,x);              
      B=m_mtx_point_in(B,y);              
         for(var i=0;i<C[0].length ;i++){  
           if(x<0){ A[0][i]=A[0][i]*(-1);}    
           if(y<0){ B[0][i]=B[0][i]*(-1);}    
                      }
  var C = m_mtx_point_add(A,B);
  return CC;
}




function m_mtx_point_add(A,B){        
var AA=A;
    var BB=B; 
    AA= m_mtx_cell_five_brow(AA);        
    AA= m_mtx_cell_five(AA);             
    BB= m_mtx_cell_five_brow(BB);         
    BB= m_mtx_cell_five(BB);               
    var aa=AA[0][0].toString().trim();
    var bb=BB[0][0].toString().trim();
    var data_chk_a = aa.substr(0,1);
    var data_chk_b = bb.substr(0,1);
   if(data_chk_a =="-"){ 
         var aaa=aa.substr(1,aa.length-1);
        AA[0][0]= aaa ;   
         } 
   if(data_chk_b =="-"){ 
        var bbb=bb.substr(1,bb.length-1);
       BB[0][0]= bbb ;   
         }  
    var CC=m_new_zero_mtx(AA.length,AA[0].length);               
    if(data_chk_a =="-" && data_chk_b !="-"){                      
         CC= m_mtx_point_sub(BB,AA); 
         CC = m_mtx_cell_five_brow(CC); 
         CC= m_mtx_cell_five(CC);                
                                      }            
    else if(data_chk_a !="-" && data_chk_b =="-"){               
         CC= m_mtx_point_sub(AA,BB);
         CC = m_mtx_cell_five_brow(CC);  
         CC= m_mtx_cell_five(CC);
                                      }
    else{                                                    
        for(var n=0;n<CC[0].length ;n++){    
              var data_a = parseInt(AA[0][n]);
              var data_b = parseInt(BB[0][n]);
                  CC[0][n]= data_a + data_b;
                                 }
                CC= m_mtx_cell_five(CC);                
                 if(data_chk_a =="-" && data_chk_b =="-"){
                     CC[0][0]= "-"+CC[0][0].toString() ;  }  
  
            }
  return CC;
}


function m_mtx_no_point_add(A,B){        
var AA=A;
    var BB=B; 
    AA= m_mtx_cell_five_brow_int(AA);        
    AA= m_mtx_cell_five_int(AA);             
    BB= m_mtx_cell_five_brow_int(BB);         
    BB= m_mtx_cell_five_int(BB);                
   var aa=AA[0][0].toString().trim();
   var bb=BB[0][0].toString().trim();
   var data_chk_a = aa.substr(0,1);
   var data_chk_b = bb.substr(0,1);
   if(data_chk_a =="-"){ 
         var aaa=aa.substr(1,aa.length-1);
        AA[0][0]= aaa ;   
       } 
   if(data_chk_b =="-"){ 
        var bbb=bb.substr(1,bb.length-1);
      BB[0][0]= bbb ;   
       }  
    var CC=m_new_zero_mtx(AA.length,AA[0].length);                 
    if(data_chk_a =="-" && data_chk_b !="-"){                     
         CC= m_mtx_point_sub(BB,AA); 
         CC = m_mtx_cell_five_brow_int(CC); 
         CC= m_mtx_cell_five_int(CC);                
                                        }            
    else if(data_chk_a !="-" && data_chk_b =="-"){               
         CC= m_mtx_point_sub(AA,BB);
         CC = m_mtx_cell_five_brow_int(CC);  
         CC= m_mtx_cell_five_int(CC);
                                      }
    else{                                                    
        for(var n=0;n<CC[0].length ;n++){    
              var data_a = parseInt(AA[0][n]);
              var data_b = parseInt(BB[0][n]);
                   CC[0][n]= data_a + data_b;
                                 }
                CC= m_mtx_cell_five_int(CC);               
                 if(data_chk_a =="-" && data_chk_b =="-"){
                     CC[0][0]= "-"+CC[0][0].toString() ;  }  
           }
     var  CC = m_mtx_cell_five(CC);
  return CC;
}


function m_mtx_point_sub(A,B){  
var AA=A;
   var BB=B;
   var aa = AA[0][0];
   var bb = BB[0][0];
       aa=aa.toString().trim(); 
       bb=bb.toString().trim(); 
   var aa_fst=aa.substr(0,1);
   var bb_fst=bb.substr(0,1);
     if(aa_fst =="-" && bb_fst == "-" ){   
         AA[0][0]=aa.substr(1,aa.length-1);  
         BB[0][0]=bb.substr(1,bb.length-1);
            for(var i=0; i< AA[0].length ; i++){            
                  var data_a_fst = parseInt(AA[0][i]);
                  var data_b_fst = parseInt(BB[0][i]);
                    if( data_a_fst != data_b_fst){
                         var i= AA[0].length }        
                     }  
             if(data_b_fst > data_a_fst){ 
                 CC= m_mtx_point_sub_bf(BB,AA); }       
             else{
                 CC= m_mtx_point_sub_bf(AA,BB);         
                 CC[0][0]= parseInt(CC[0][0]) *(-1);
                        if(CC[0][0]==0){ CC[0][0]= '-0';  }
                  }     
                                      }
     if(aa_fst !="-" && bb_fst!="-" ){   
                for(var i=0; i< AA[0].length ; i++){            
                  var data_a_fst = parseInt(AA[0][i]);
                  var data_b_fst = parseInt(BB[0][i]);
                    if( data_a_fst != data_b_fst){
                         var i= AA[0].length }        
                     }   
      if(data_a_fst > data_b_fst){ 
           CC= m_mtx_point_sub_bf(AA,BB);}
         else{ CC= m_mtx_point_sub_bf(BB,AA);              
           CC[0][0]= parseInt(CC[0][0]) *(-1);
                      if(CC[0][0]==0){CC[0][0]= '-0'; }
          }     
                                   }
      if(aa_fst !="-" && bb_fst=="-" ){            
          BB[0][0]= parseInt(BB[0][0]) *(-1);       
          CC= m_mtx_point_add(AA,BB);                
                                      }
       if(aa_fst =="-" && bb_fst!="-" ){             
          AA[0][0]= parseInt(AA[0][0]) *(-1);        
               if(AA[0][0]==0){ AA[0][0]= '0'; }       
          CC= m_mtx_point_add(AA,BB);             
          CC[0][0]= parseInt(CC[0][0]) *(-1);
               if(CC[0][0]==0){ CC[0][0]= '-0'; }
                                } 
         var CC = m_mtx_cell_five_brow(CC);  
        var  CC = m_mtx_cell_five(CC);
  return CC;
 }

function m_mtx_point_sub_bf(A,B){        
   var AA=A;
    var BB=B; 
    var CC=m_new_zero_mtx(AA.length,AA[0].length);                 
    var data_a_fst=0;
    var data_b_fst=0;
          for(var i=0; i< AA[0].length ; i++){            
                  var data_a_fst = parseInt(AA[0][i]);
                  var data_b_fst = parseInt(BB[0][i]);
                    if( data_a_fst != data_b_fst){
                         var i= AA[0].length }        
                     }
        for(var n=0;n < CC[0].length ; n++){
             var data_a = parseInt(AA[0][n]);
             var data_b = parseInt(BB[0][n]);
                if(data_a_fst >= data_b_fst){
                   CC[0][n]= data_a - data_b;}
                else{
                   CC[0][n]= data_b - data_a;}     
                                            }
           if(data_a_fst < data_b_fst){
                  CC[0][0]= parseInt(CC[0][0])*(-1);                         
                     if(parseInt(CC[0][0]==0)){  CC[0][0]="-00000";}    
                                      }
                 CC = m_mtx_cell_five_brow(CC);   
                 CC = m_mtx_cell_five(CC);        
  return CC;
}


     


function m_mtx_trim(x){       
  var xx_st = x.toString().trim(); 
  var xx_st = m_delete_bracket(xx_st); 
  var xx_fst12 = xx_st.substr(0,2);
      if( xx_fst12 == '0e' || xx_st =='0.') { var data_t=0 ; return data_t ;}    
  var xx_st_1 = m_mtx_del_plus(xx_st);     
  var xx_st_2 = m_mtx_add_zero_bf(xx_st_1);     
   for(var i=0 ;i<10 ;i++){    
     var xx_st_3 = m_mtx_del_point(xx_st_2);    
     var xx_st_5 = m_mtx_del_zero_bf(xx_st_3);    
     var xx_st_6 = m_mtx_del_zero(xx_st_5);     
      var  xx_st_2 = xx_st_6;
                        }
  return xx_st_6;

}



function m_mtx_add_zero_bf(x){     
var xx_st = x.toString().trim();
  var fst_st = xx_st.substr(0,1);
  var sec_st = xx_st.substr(1,1);
     if(fst_st =="."){ xx_st="0"+xx_st ;}
     if(fst_st =="-" && sec_st =="."){ xx_st="-0"+xx_st.substr(1,xx_st.length-1) ;}
      return xx_st;
}


function m_mtx_del_zero_bf(x){     
var xx_st = x.toString().trim();
  var fst_st = xx_st.substr(0,1);
  var sec_st = xx_st.substr(1,1);
  var tri_st = xx_st.substr(2,1);
    for(var i=0 ;i < (xx_st.length-1);i++){   
       if(( fst_st ==0 || fst_st =="0") && (sec_st !=".") && (xx_st.length !=1)){ 
             var xx_st = xx_st.substr(1,xx_st_length-1);
              var fst_st = xx_st.substr(0,1);  
              var sec_st = xx_st.substr(1,2);  
                                                      }
                                           }  
     for(var i=0 ;i < (xx_st.length-1);i++){      
       if(fst_st =="-" && ( sec_st ==0 || sec_st =="0") && (tri_st !=".") && (xx_st.length !=1)){
             var xx_st = "-"+xx_st.substr(2,xx_st_length-2);
             var fst_st = xx_st.substr(0,1);  
             var sec_st = xx_st.substr(1,2);  
             var tri_st = xx_st.substr(2,1);  
                                                       }
                                           }  
      return xx_st;
}


function m_mtx_del_zero(x){     
   var xx_st = x.toString().trim();
   var pos_pot  = xx_st.indexOf(".");    
   var pos_e  = xx_st.indexOf("e");    
   var st_lg = xx_st.length;
   var nub_e_x=0; 
        if(  pos_e != -1){                          
              nub_e_x =m_str_power(xx_st,0);          
              xx_st = m_str_power(xx_st,1);          
                           }
   var xx = xx_st;
   var xx_pot = xx.indexOf(".");
   var xx_lg  = xx.length;
   var xx_lst ="";  
    if(xx_lg >1){
     var xx_lst = xx.substr(xx_lg-1,1); 
              }
   var nn=0; 
     if(xx_lst=="0"){var nn=1;}
                  else{var nn=0;}   
 while(nn >0){       
  if(xx_pot != -1 && xx_lst=="0"){
           xx = xx.substr(0,(xx_lg-1));
              var xx_lg  = xx.length;       
               xx_lst =xx.substr(xx_lg-1,1); 
                  if(xx_lst=="0"){var nn=1;}
                  else{var nn=0;}   
                                  }  
    else{ var nn=0;}  
                 }  
     if(nub_e_x > 0){ xx=xx+"e+"+nub_e_x;}   
     if(nub_e_x < 0){ xx=xx+"e"+nub_e_x;}
     if(nub_e_x == 0){ xx=xx;}
     return xx;
}            


function m_mtx_del_point(x){     
var xx_st = x.toString().trim();
   var lst_st = xx_st.substr(xx_st.length-1,1);    
   var lg = xx_st.length;
      for(var i=0 ;i< lg  ;i++){
       if( lst_st =="."){ xx_st = xx_st.substr(0,xx_st.length -1);
             var lst_st = xx_st.substr(xx_st.length-1,1);  }  
       else { var i= lg ;
              var  xx_st = xx_st ;
                 return xx_st; }  }
   var pos_pot  = xx_st.indexOf(".");    
   var pos_e  = xx_st.indexOf("e");     
   var st_lg = xx_st.length;
   var nub_e_x=0; 
      if( pos_pot ==-1){ return x ;} 
      if( xx_st=="0."){ return "0" ;}
      if( pos_e != -1){ 
          nub_e_x =m_str_power(xx_st,0);          
          xx_st = m_str_power(xx_st,1);          
                           }
  var sutt=xx_st;
  var pos_pot_sum  = sutt.indexOf(".");
  var sum_lg  = sutt.length;
  if(pos_pot_sum == (sum_lg-1) ){sutt = sutt.substr(0,(sum_lg-1));}  
  if(nub_e_x > 0){ sutt=sutt+"e+"+nub_e_x;}   
  if(nub_e_x < 0){ sutt=sutt+"e"+nub_e_x;}
  if(nub_e_x == 0){ sutt=sutt;}
     return sutt;
}            


function m_mtx_test_msg(x){
var  x= x.toString().trim();
   var x_msg = x.indexOf("Msg");
      if(x_msg !=-1 ){ return x;}     
      else{ return -1 ;}
}


function m_mtx_n_str_cpl_9(x){   
var xx= x.toString().trim();
   var xx = m_str_e_to_str(xx);      
   var pos_pot  = xx.indexOf(".");    
   var st_lg = xx.length;
    if(pos_pot!=-1){ return xx;};  
   var data_x=xx;
   var data_y="";
    for(var i=0;i<st_lg;i++){     
      data_y=data_y+"9";}
    AA=m_new_zero_mtx(1,100);                
    BB=m_new_zero_mtx(1,100);                 
    CC=m_new_zero_mtx(1,100);                 
     AA=m_mtx_point_in_int(AA,data_x);  
     BB=m_mtx_point_in_int(BB,data_y);  
      for(var j=0; j< CC[0].length ;j++){
          var data_bb = BB[0][j];
          var data_bb = parseInt(data_bb); 
          var data_aa =  AA[0][j];
          var data_aa = parseInt(data_aa); 
         CC[0][j]= data_bb - data_aa;           
                                    }
       CC= m_mtx_cell_five_int(CC);           
       var  data_z="";  
       var  data_t="";  
       for(var k=0; k<CC[0].length ;k++){    
              var  data_t = CC[0][k].toString();
        data_z = data_t + data_z; 
                                     }
        var n=0;
      while(n<(CC[0].length*5)){   
        var data_fst=data_z.substr(0,1);  
              if(data_fst==0){
                 data_z=data_z.substr(1,data_z.length-1); 
                            }
               else { n=(CC[0].length*5);}
                 var n=n+1;
                    } 
       if(data_z==""  ){var data_z=0;}
       if(data_z==-0  ){var data_z=0;}
   return data_z ;
}


function m_mtx_int_str_comp(x,y){      
   var  xx= x.toString().trim();
   var  yy= y.toString().trim();
   var x_e  = xx.indexOf("e");    
   var y_e  = yy.indexOf("e");    
     if(x_e !=-1 || y_e !=-1){ return ;};       
   var ant=0;
      if(xx!="" && yy==""){ var ant=1 ; return ant; }
      if(xx=="" && yy!=""){ var ant=2 ; return ant; }
      if(xx=="" && yy==""){ var ant=3 ; return ant; }
   var xx_fst = xx.substr(0,1);
   var yy_fst = yy.substr(0,1);
    if(xx_fst !="-" && yy_fst =="-"){ var ant=1 ; return ant; }   
    if(xx_fst =="-" && yy_fst !="-"){ var ant=2 ; return ant; }   
   var xx_lg = xx.length;
   var yy_lg = yy.length;
   var x_pos_pot  = xx.indexOf(".");    
   var y_pos_pot  = yy.indexOf("."); 
   var x_i_lg =0; 
   var y_i_lg =0; 
     if( x_pos_pot == -1){ var x_i_lg = xx_lg ;}  
     else { var x_i_lg = x_pos_pot ;}
     if( y_pos_pot == -1){ var y_i_lg = yy_lg ;}  
     else { var y_i_lg = y_pos_pot ;}
     if(( x_i_lg > y_i_lg) && (xx_fst !="-") && (yy_fst !="-")){ var ant=1 ; return ant; }      
     if(( x_i_lg > y_i_lg) && (xx_fst =="-") && (yy_fst =="-")){ var ant=2 ; return ant; }   
     if(( y_i_lg > x_i_lg) && (xx_fst !="-") && (yy_fst !="-")){ var ant=2 ; return ant; }    
     if(( y_i_lg > x_i_lg) && (xx_fst =="-") && (yy_fst =="-")){ var ant=1 ; return ant; } 
      
      if(xx_lg >= yy_lg){ var xy_lg = xx_lg; }    
      else { var xy_lg = yy_lg; } 
        for(var i=0 ; i< xy_lg;i++){
            var xx_word = xx.substr(i,1);
            var yy_word = yy.substr(i,1);
         if( xx_word !="" &&  yy_word =="" && xx_fst !="-"){ var ant=1 ; return ant; }  
         if( xx_word =="" &&  yy_word !="" && xx_fst !="-"){ var ant=2 ; return ant; }    
         if( xx_word !="" &&  yy_word =="" && xx_fst =="-"){ var ant=2 ; return ant; }  
         if( xx_word =="" &&  yy_word !="" && xx_fst =="-"){ var ant=1 ; return ant; } 
        if(( xx_word > yy_word)&& xx_fst !="-"){ var ant=1 ; return ant; }  
         if(( xx_word < yy_word)&& xx_fst !="-"){ var ant=2 ; return ant; }  
         if(( xx_word > yy_word)&& xx_fst =="-"){ var ant=2 ; return ant; }  
         if(( xx_word < yy_word)&& xx_fst =="-"){ var ant=1 ; return ant; } }
                                                
           var ant=3;
            return ant ;
           
   }

function m_mtx_real_str_comp(x,y){      
 var  x= x.toString().trim();
   var  y= y.toString().trim();
   var ant=0;
      if(x!="" && y==""){ var ant=1 ; return ant; }
      if(x=="" && y!=""){ var ant=2 ; return ant; }
      if(x=="" && y==""){ var ant=3 ; return ant; }
    var x=m_str_e_to_str_point(x);
    var xx = m_mtx_str_to_e(x);             
    var yy = m_mtx_str_to_e(y);   
    var xx = m_mtx_str_to_e_a(xx);             
    var yy = m_mtx_str_to_e_a(yy);
    var xx = m_mtx_str_to_e_ne(xx);             
    var yy = m_mtx_str_to_e_ne(yy);
     xx = m_fix_pow_lst(xx);    
     yy = m_fix_pow_lst(yy);    
     var xx_fst = xx.substr(0,1);
    var xx_sec = xx.substr(1,1);
    var xx_tri = xx.substr(2,1);
    var xx_e = m_mtx_e_str(xx,0);   
    var xx_lg = xx.length;
    var yy_fst = yy.substr(0,1);
    var yy_sec = yy.substr(1,1);
    var yy_tri = yy.substr(2,1);
    var yy_e = m_mtx_e_str(yy,0);   
    var yy_lg = yy.length; 
     if(xx_lg >= yy_lg){ var xy_lg = xx_lg; }    
     else { var xy_lg = yy_lg; } 
    if(xx_fst !="-" && yy_fst =="-"){ var ant=1 ; return ant; }   
    if(xx_fst =="-" && yy_fst !="-"){ var ant=2 ; return ant; }   
        var  xx_e=parseInt(xx_e);   
        var  yy_e=parseInt(yy_e); 
    if((xx_fst !="-" && yy_fst !="-")||(xx_fst =="-" && yy_fst =="-")){             
         if(xx_fst !="-" &&  xx !="0"  &&  yy =="0" && yy.length ==1){ var ant=1 ;   return ant; }       
         if(xx_fst =="-" &&  xx !="0"  &&  yy =="0" && yy.length ==1){ var ant=2 ;   return ant; }       
         if(xx =="0"  && xx.length ==1 &&  yy !="0" && yy_fst !="-"){ var ant=2 ; return ant; }        
         if(xx =="0"  && xx.length ==1 &&  yy !="0" && yy_fst =="-"){ var ant=1 ; return ant; }        
         if(xx =="0"  && xx.length ==1 &&  yy =="0" && yy.length ==1){ var ant=3 ; return ant; }        
            var data_e_cpl = m_mtx_int_str_comp(xx_e,yy_e);
              if(xx_fst !="-" && yy_fst !="-"){                    
                  if(data_e_cpl==1){ var ant=1 ; return ant; }            
                  if(data_e_cpl==2){ var ant=2 ; return ant; }            
                                            }
             if(xx_fst =="-" && yy_fst =="-"){                       
                 if(data_e_cpl==1){ var ant=2 ; return ant; }            
                  if(data_e_cpl==2){ var ant=1 ; return ant; }            
                                             }
           if((data_e_cpl == 3) && (xx_fst >  yy_fst)){ var ant=1 ; return ant; }   
             if((data_e_cpl == 3) && (xx_fst <  yy_fst)){ var ant=2 ; return ant; }   
          if(data_e_cpl == 3){
                           var xx_str = m_mtx_e_str(xx,1);   
                           var yy_str = m_mtx_e_str(yy,1);   
                           var ant = m_mtx_int_str_comp(xx_str,yy_str);    
   
                               }
                             
                                                               }   
 
          return ant; 
   }


function m_mtx_int_add(x,y){   
     var  xx= x.toString().trim();
   var  yy= y.toString().trim();
   var xx = m_str_e_to_str(xx);       
   var yy = m_str_e_to_str(yy);     
   var x_pos_pot  = xx.indexOf(".");    
   var y_pos_pot  = yy.indexOf(".");    
   var x_pos_e  = xx.indexOf("e");    
   var y_pos_e  = yy.indexOf("e");    
      if(x_pos_e !=-1 ){ return ;};    
      if(y_pos_e !=-1 ){ return ;};  
    var x_st_fst= xx.substr(0,1);
    var y_st_fst= yy.substr(0,1);
    if(x_st_fst=="-"){  var x_st=xx.substr(1,xx.length-1);} 
                   else{  var x_st = xx;}
    if(y_st_fst=="-"){  var y_st=yy.substr(1,yy.length-1);} 
                   else{  var y_st = yy;}
    if( x_pos_pot>=1 || y_pos_pot>=1 ){        
       var xst_pos_pot  = x_st.indexOf(".");    
       var yst_pos_pot  = y_st.indexOf("."); 
       var xst_p_bf = x_st.substr(xst_pos_pot+1,x_st.length-xst_pos_pot);        
       var xst_p_bf_lg = xst_p_bf.length;                                    
       var yst_p_bf = y_st.substr(yst_pos_pot+1,y_st.length-yst_pos_pot);        
       var yst_p_bf_lg = yst_p_bf.length;                                    
       var data_comp_0 = m_mtx_real_str_comp(xst_p_bf_lg,yst_p_bf_lg);      
        if(data_comp_0==3 && xst_p_bf_lg >=1){       
          var x_st = x_st.replace(/\./g,'');            
          var y_st = y_st.replace(/\./g,'');            
          var sf_flag = xst_p_bf_lg;   }  
       else if(data_comp_0==1 && xst_p_bf_lg >=1  ){       
          var x_st = x_st.replace(/\./g,'');                                   
          var y_st = y_st.replace(/\./g,''); 
              for(var i=0 ;i<(xst_p_bf_lg-yst_p_bf_lg);i++){
                 var y_st = y_st+"0" ;                              
                 var sf_flag = xst_p_bf_lg;}
                        }
          else if(data_comp_0==2 && yst_p_bf_lg >=1  ){       
          var x_st = x_st.replace(/\./g,'');                                  
          var y_st = y_st.replace(/\./g,''); 
               for(var i=0 ;i<(yst_p_bf_lg-xst_p_bf_lg);i++){
                 var x_st = x_st+"0" ;                              
                 var sf_flag = yst_p_bf_lg;}
                        }
          else{ var x_st=x_st ;
                var y_st=y_st ;
                var sf_flag = 0; } 
         }                           
         if(x_st==0){ return y;}    
         if(y_st==0){ return x;} 
         var x_lg = x_st.length;
         var y_lg = y_st.length;
         var max_lg = 0;
         if( x_lg >= y_lg){ var max_lg = x_lg ;}
         else{var max_lg = y_lg ;}
         var data_z=0;
       if( max_lg <15 && sf_flag == 0){ var data_z= parseInt(x)+parseInt(y);   
          return data_z;}
       if( max_lg <15 && sf_flag != 0){ 
           if(x_st_fst=="-"){ var x_st="-"+x_st;}
           if(y_st_fst=="-"){ var y_st="-"+y_st;}
           var data_z= parseInt(x_st)+parseInt(y_st);  
           var data_z = data_z.toString();
           var data_z_fst= data_z.substr(0,1);                                    
         if(data_z_fst=="-"){ var data_z = data_z.substr(1,data_z.length-1);} 
              if(data_z.length >sf_flag){
                  var data_z = data_z.substr(0,data_z.length-sf_flag)+"."+ data_z.substr(data_z.length - sf_flag ,sf_flag )
                                                }
              if(data_z.length ==sf_flag){
                  var data_z = "0."+ data_z  ;                                               
                                                  }
              if(data_z.length < sf_flag){            
                  var data_z_00 ="";
                     for(var jj=0 ;jj< (sf_flag-data_z.length);jj++){
                        var data_z_00 = "0"+ data_z_00 } ;                                                 
                        var data_z="0."+data_z_00+data_z;
                                                       }
                if(data_z_fst=="-"){ var data_z = "-"+data_z ;}  
              return data_z;}                                   
   var data_comp = m_mtx_real_str_comp(x_st,y_st);      
    var data_col=0;
    var data_col = Math.ceil(max_lg/5);    
    AA=m_new_zero_mtx(1,data_col);                     
    BB=m_new_zero_mtx(1,data_col);                 
    CC=m_new_zero_mtx(1,data_col);                 
     AA=m_mtx_point_in_int(AA,x_st);  
     BB=m_mtx_point_in_int(BB,y_st);  
    if((x_st_fst=="-" && y_st_fst=="-") || (x_st_fst!="-" && y_st_fst!="-")){
      for(var i=0;i< CC[0].length ;i++){              
          CC[0][i]=parseInt(AA[0][i])+parseInt(BB[0][i]);      
       }
         } 
     if((data_comp !=2)&&((x_st_fst=="-" && y_st_fst!="-") || (x_st_fst!="-" && y_st_fst=="-"))){
      for(var j=0;j< CC[0].length ;j++){                  
          CC[0][j]=parseInt(AA[0][j])-parseInt(BB[0][j]);      
       }
                     } 
    if((data_comp ==2)&&((x_st_fst=="-" && y_st_fst!="-") || (x_st_fst!="-" && y_st_fst=="-"))){
       for(var k=0;k< CC[0].length ;k++){                  
          CC[0][k]=parseInt(BB[0][k])-parseInt(AA[0][k]);      
       }
                      }
         
      CC= m_mtx_cell_five_brow_int(CC);     
      CC= m_mtx_cell_five_int(CC);           
      var  data_z="";  
      var  data_t="";  
       for(var k=0; k<data_col ;k++){       
              var  data_t = CC[0][k].toString();
         data_z = data_t + data_z; 
                                          }
        var n=0;
       while(n<(data_col*5)){   
        var data_fst=data_z.substr(0,1);  
              if(data_fst==0){
                  data_z=data_z.substr(1,data_z.length-1); 
                             }
               else { n=(data_col*5);}
                 var n=n+1;
                    } 
                data_z= data_z.toString();
       if(data_z==""){var data_z=0;}  
    if ((x_st_fst=="-" && y_st_fst=="-")||((data_comp !=2 && x_st_fst=="-" && y_st_fst!="-"))||((data_comp ==2 && x_st_fst!="-" && y_st_fst=="-"))){
          data_z ="-"+ data_z;
            }  
    if(data_z==-0  ){var data_z=0;} 
     if(sf_flag >0){                     
            var data_z = data_z.substr(0,data_z.length-sf_flag)+"."+ data_z.substr(data_z.length - sf_flag ,sf_flag )
                       }    
          return data_z; 
  
}


function m_mtx_int_sub(x,y){   
   var  xx= x.toString().trim();
   var  yy= y.toString().trim();
   var xx = m_str_e_to_str(xx);       
   var yy = m_str_e_to_str(yy);     
   var x_pos_pot  = xx.indexOf("e");    
   var y_pos_pot  = yy.indexOf("e");    
      if(x_pos_pot!=-1 ){ return ;};  
      if(y_pos_pot!=-1 ){ return ;};  
   var y_st_fst= yy.substr(0,1);
   var x_st = xx;
      if(y_st_fst=="-"){  var y_st=yy.substr(1,yy.length-1);}   
                   else{  var y_st = "-"+yy;}
   var data_z = 0; 
   var data_z = m_mtx_int_add(x_st,y_st);
   var data_z =m_mtx_trim(data_z) ;
         return data_z; 
}



function m_mtx_real_add(x,y){        
  var  x= x.toString().trim();
  var x=m_mtx_trim(x).toString();
  var  y= y.toString().trim();
  var y=m_mtx_trim(y).toString();
   var x_msg = m_mtx_test_msg(x);
   var y_msg = m_mtx_test_msg(y);
        if(x_msg !=-1 ){ return x;}     
        if(y_msg !=-1 ){ return y;}
  var data_x_comp_0 = m_mtx_real_str_comp(x,0);            
       if(data_x_comp_0 ==3 ){ var ans_1=y; return ans_1;}      
   var data_y_comp_0 = m_mtx_real_str_comp(y,0);           
      if(data_y_comp_0 ==3 ){ var ans_1=x; return ans_1;}  
   var  x_st= x;
   var  y_st= y;
   var  x_st_fst= x_st.substr(0,1);
   var  y_st_fst= y_st.substr(0,1);
      if(x_st_fst=="-"){  var x_st=x_st.substr(1,x_st.length-1);} 
                   else{  var x_st = x_st;}
      if(y_st_fst=="-"){  var y_st=y_st.substr(1,y_st.length-1);} 
                   else{  var y_st = y_st;}
    var  y_e = m_mtx_str_to_e(y_st);             
    var  x_e = m_mtx_str_to_e(x_st);           
    var  y_e = m_mtx_str_to_e_ne(y_e);               
    var  x_e = m_mtx_str_to_e_ne(x_e);              
    var  y_e = m_mtx_str_to_e_a(y_e).toString().trim();      
    var  x_e = m_mtx_str_to_e_a(x_e).toString().trim();  
    var nub_x = m_str_power(x_e ,0);  
    var nub_y = m_str_power(y_e ,0); 
     if(nub_x.length >3 || nub_y.length >3){
      var nub_dif_x = m_mtx_int_sub(nub_x,nub_y);  
      var nub_dif_y = m_mtx_int_sub(nub_y,nub_x); 
      var x_comp_1000 = m_mtx_real_str_comp(nub_dif_x,1000);   
      var y_comp_1000 = m_mtx_real_str_comp(nub_dif_y,1000);
    if(x_comp_1000 !=2){var ans_1=x; return ans_1;}      
    if(y_comp_1000 !=2){var ans_1=y; return ans_1;}      
     }  
    var fix_cols =2000;
    var  y_e_100 = m_fix(y_e,fix_cols).toString().trim();     
    var  x_e_100 = m_fix(x_e,fix_cols).toString().trim();      
    var  y_e_100 = y_e_100.toString();    
    var  x_e_100 = x_e_100.toString();
    var sutt = " " ;
    if((y_e_100 == x_e_100 && x_st_fst=="-" &&  y_st_fst!="-")||(y_e_100 == x_e_100 && x_st_fst!="-" &&  y_st_fst=="-")) { 
           var sutt = 0;
           var sutt = sutt.toString();
            return sutt;
                       };
   if(y_e_100.length < 15 && x_e_100.length < 15 ){         
     if((parseFloat(y_e_100) == parseFloat(x_e_100) && x_st_fst=="-" &&  y_st_fst!="-")||(parseFloat(y_e_100) == parseFloat(x_e_100) && x_st_fst!="-" &&  y_st_fst=="-")) {      
          var sutt = 0;
          var sutt = sutt.toString();
            return sutt;
                       };    
                                                  };
  var pexp = x ;
  var nexp = y ;
  var sutt = 0 ;
        var  pexp = m_mtx_str_to_e_ne(pexp);               
        var  nexp = m_mtx_str_to_e_ne(nexp);               
          pexp = pexp.toString();                                   
        var p_idx_e = pexp.indexOf("e");
          nexp = nexp.toString();                               
          var n_idx_e = nexp.indexOf("e");
             if( n_idx_e == -1 &&  p_idx_e == -1){  
                  var sutt =  m_mtx_real_add_bf(pexp,nexp);   
                            }
            else{ var sutt = m_mtx_point_add_sub_e(pexp,nexp ,0);}  
          var sutt = m_fix_end_9(sutt);
        return sutt;     
}


function m_mtx_real_add_bf(x,y){ 
var xx=x.toString().trim() ;
  var yy=y.toString().trim() ;
  var x_fst = xx.substr(0,1);
  var y_fst = yy.substr(0,1);  
   if(( x_fst=="-" && y_fst=="-")||( x_fst !="-" && y_fst!="-")){  
     var sutt = m_mtx_real_add_bf_1(xx,yy);
      }
    if( x_fst!="-" && y_fst =="-"){                
       var yy=yy.substr(1,yy.length-1);
        var sutt = m_mtx_real_sub_bf(xx,yy);      
     }
      if( x_fst=="-" && y_fst !="-"){               
        var xx=xx.substr(1,xx.length-1);
        var sutt = m_mtx_real_sub_bf(yy,xx);        
     }
    return sutt;
}



function m_mtx_del_plus(x){    
    var xx = x.toString().trim() ;
    var xx_lg  = xx.length;
    var xx_fst = xx.substr(0,1);
   if(xx_fst=="+"){ var xx=xx.substr(1,xx_lg-1);}
    var xx_lg  = xx.length;
    var xx_lst = xx.substr(xx_lg-1,1);
    if(xx_lst=="."){ var xx=xx.substr(0,xx_lg-1);}
     return xx;
 }


function m_mtx_real_add_bf_1(x,y){        
  var pexp = x.toString().trim() ;
  var nexp = y.toString().trim() ;
  var x_fst = pexp.substr(0,1);
  var y_fst = nexp.substr(0,1); 
    if(x_fst =="-"){ pexp = pexp.substr(1,pexp.length-1);}
    if(y_fst =="-"){ nexp = nexp.substr(1,nexp.length-1);}
          var pexp = pexp.toString();                                   
          var nexp = nexp.toString().trim();
          var p_idx_p = pexp.indexOf(".");
          var p_idx_e = pexp.indexOf("e");
      if( p_idx_e != -1 &&  p_idx_p != -1){                           
          var  nub_p =  pexp.substr(p_idx_e+1,pexp.length - p_idx_e);  
               var nub_p = m_mtx_trim(nub_p) ;   
               pexp = pexp.substr(0,p_idx_e);       
               pexp =  m_mtx_str_element_shift(pexp ,nub_p);          
                          }
                nexp = nexp.toString();                                
                nexp = nexp.toString().trim();
            var n_idx_p = nexp.indexOf(".");
            var n_idx_e = nexp.indexOf("e");
             if( n_idx_e != -1 &&  n_idx_p != -1){                       
               var nub_n =  nexp.substr(n_idx_e+1,nexp.length - n_idx_e); 
               var nub_n = m_mtx_trim(nub_n) ;   
           nexp = nexp.substr(0,n_idx_e);                             
           nexp =  m_mtx_str_element_shift(nexp ,nub_n);               
                            }
             var tran = MTX_COL;  
              MTX_COL=80;
              AA=m_new_zero_mtx(1,MTX_COL);                 
              BB=m_new_zero_mtx(1,MTX_COL);                 
              CC=m_new_zero_mtx(1,MTX_COL);                 
              DD=m_new_zero_mtx(1,MTX_COL);                 
              EE=m_new_zero_mtx(1,MTX_COL);                 
              FF=m_new_zero_mtx(1,MTX_COL);                 
              GG=m_new_zero_mtx(1,MTX_COL);                 
              var pexp_m = m_nub_m_s(pexp);  
              var pexp_p = m_nub_p(pexp);    
             AA=m_mtx_point_in_int(AA,pexp_m); 
             BB=m_mtx_point_in(BB,pexp_p);     
             var nexp_m = m_nub_m_s(nexp);  
             var nexp_p = m_nub_p(nexp);    
             CC=m_mtx_point_in_int(CC,nexp_m); 
             DD=m_mtx_point_in(DD,nexp_p);     
             EE=m_mtx_no_point_add(AA,CC);            
             EE= m_mtx_cell_five_brow_int(EE);     
             EE= m_mtx_cell_five_int(EE);          
             FF= m_mtx_point_add(BB,DD);        
             FF= m_mtx_cell_five_brow(FF);    
             FF= m_mtx_cell_five(FF);          
                  var data_ff = FF[0][0].toString();  
                  var data_ff_lg=data_ff.length;
                 if( data_ff_lg > 5){
                        FF[0][0]= data_ff.substr(data_ff_lg-5,5); 
                         data_ff_bf=data_ff.substr( 0 ,data_ff_lg-5); 
                        EE[0][0]=  parseInt(EE[0][0]) + parseInt(data_ff_bf);
                                     }  
                        EE= m_mtx_cell_five_int(EE);   
                       FF= m_mtx_cell_five(FF);       
             var sutt= m_mtx_cell_five_show_int(EE,FF);  
             var sutt = m_mtx_trim(sutt) ;   
              if(x_fst =="-" && y_fst =="-"){ var sutt ="-"+sutt;}    
            MTX_COL=tran;  
       return sutt;    
         
}

function m_sub_error_rg(str_1){      
  var str_a=str_1;
  var data_rang_str_up =-1;
  var data_rang_str_down =-1;
  var ng_nb =0;
  var n_nb =0;
  var p_nb =0;
  var g_nb =0;
  var s_nb =0;
  var h_nb =0;
  var sum_nb=0;
  var it = "";
  var ans ="";
  var data_rang_str_up = m_mtx_real_str_comp(str_a,'1e-229');     
  var data_rang_str_down = m_mtx_real_str_comp(str_a,'-1e-229'); 
  var data_rang_str_up_16 = m_mtx_real_str_comp(str_a,'1e-45');      
  var data_rang_str_down_16 = m_mtx_real_str_comp(str_a,'-1e-45');      
       var it = calc.input.value;
      var this_s = it.toString().trim();           
      var this_it = m_del4_2f_char(this_s,';').toString().trim();        
      var this_it_s = this_it;   
      var this_it_t = m_str_sub_ngt_bf(this_it_s);   
      var this_it_t_test =  this_it_t ; 
      var this_it_t_test = m_str_sub_ngt_bf(this_it_t_test);   
      var ng_nb = m_str_spc_count(this_it_t_test,"-");
      var ng_pb = m_str_spc_count(this_it_t_test,"+");
      var ng_Q = m_str_spc_count(this_it_t_test,"Q");             
          if(ng_Q >0 && ng_pb>0){ var ng_nb = m_mtx_int_add(ng_nb,1);}
      var n_nb_asinh = m_str_spc_count(this_it_t_test,"asinh");       
      var this_it_t_test = this_it_t_test.replace(/asinh/g , "");    
      var n_nb_acosh = m_str_spc_count(this_it_t_test,"acosh"); 
      var this_it_t_test = this_it_t_test.replace(/acosh/g , "");    
      var n_nb_atanh = m_str_spc_count(this_it_t_test,"atanh");
      var this_it_t_test = this_it_t_test.replace(/atanh/g , "");
      var n_nb_asin = m_str_spc_count(this_it_t_test,"asin");
      var this_it_t_test = this_it_t_test.replace(/asin/g , "");    
      var n_nb_acos = m_str_spc_count(this_it_t_test,"acos");
      var this_it_t_test = this_it_t_test.replace(/acos/g , "");    
      var n_nb_atan = m_str_spc_count(this_it_t_test,"atan");
      var this_it_t_test = this_it_t_test.replace(/atan/g , "");    
      var n_nb_sinh = m_str_spc_count(this_it_t_test,"sinh");  
      var this_it_t_test = this_it_t_test.replace(/sinh/g , "");
      var n_nb_cosh = m_str_spc_count(this_it_t_test,"cosh");                                               
      var this_it_t_test = this_it_t_test.replace(/cosh/g , "");
      var n_nb_tanh = m_str_spc_count(this_it_t_test,"tanh");                                               
      var this_it_t_test = this_it_t_test.replace(/tanh/g , "");
      var n_nb_sin = m_str_spc_count(this_it_t_test,"sin");        
      var n_nb_cos = m_str_spc_count(this_it_t_test,"cos");                                               
      var n_nb_tan = m_str_spc_count(this_it_t_test,"tan");                                               
      var n_nb_cap = m_str_spc_count(this_it_t_test,"^");
      var n_nb_exp = m_str_spc_count(this_it_t_test,"exp");   
      var n_nb_ln = m_str_spc_count(this_it_t_test,"ln");
      var n_nb_log = m_str_spc_count(this_it_t_test,"log");
      var n_nb_dg = m_str_spc_count(this_it_t_test,"°");  
      var n_nb_pi = m_str_spc_count(this_it_t_test,"π"); 
      var sum_nb = parseInt(n_nb_sin) + parseInt(n_nb_cos) + parseInt(n_nb_tan) + parseInt(n_nb_asin) + parseInt(n_nb_acos) +parseInt(n_nb_atan) + parseInt(n_nb_sinh) + parseInt(n_nb_cosh) + parseInt(n_nb_tanh) + parseInt(n_nb_asinh) + parseInt(n_nb_acosh) +parseInt(n_nb_atanh) + parseInt(n_nb_cap) + parseInt(n_nb_exp) + parseInt(n_nb_ln) +parseInt(n_nb_log)+parseInt(n_nb_dg)+parseInt(n_nb_pi);     
      if(data_rang_str_up ==2 && data_rang_str_down ==1 && str_a !='0' && ng_nb >=1  && sum_nb >=2 && DECI_DGT >16) {    
         var ans = "0;" + message_1(34); }                 
      else if(data_rang_str_up_16 ==2 && data_rang_str_down_16 ==1 && str_a !='0' && ng_nb >=1  && sum_nb >=2 && DECI_DGT <=16) {    
         var ans = "0;" + message_1(38); }  
      else {ans = str_1;}
    return ans;  
}

function m_mtx_real_sub(x,y){       
    var x = x.toString().trim() ; 
    var x=m_mtx_trim(x).toString();
    var y = y.toString().trim() ;  
    var y=m_mtx_trim(y).toString();
    var x_msg = m_mtx_test_msg(x);
    var y_msg = m_mtx_test_msg(y);
       if(x_msg !=-1 ){ return x;}    
       if(y_msg !=-1 ){ return y;}
    var  x_st= x;
    var  y_st= y;
    var  x_st_fst= x_st.substr(0,1);
    var  y_st_fst= y_st.substr(0,1);
      if(x_st_fst=="-"){  var x_st=x_st.substr(1,x_st.length-1);} 
                   else{  var x_st = x_st;}
      if(y_st_fst=="-"){  var y_st=y_st.substr(1,y_st.length-1);} 
                   else{  var y_st = y_st;}
    var ans_1="";
      if(y=="0" && y.length==1){ var ans_1=x ; return ans_1 ;}                            
      if(x=="0" && x.length==1 && y_st_fst=="-") { var ans_1=y_st; return ans_1 ; }      
      if(x=="0" && x.length==1 && y_st_fst!="-") { var ans_1="-"+y_st ; return ans_1 ; }       
    var  y_e = m_mtx_str_to_e(y_st);               
    var  x_e = m_mtx_str_to_e(x_st);           
    var  y_e = m_mtx_str_to_e_ne(y_e);               
    var  x_e = m_mtx_str_to_e_ne(x_e);               
    var  y_e = m_mtx_str_to_e_a(y_e).toString().trim();       
    var  x_e = m_mtx_str_to_e_a(x_e).toString().trim(); 
    var nub_x = m_str_power(x_e ,0);  
    var nub_y = m_str_power(y_e ,0);
     if(nub_x.length >3 || nub_y.length>3){ 
      var nub_dif_x = m_mtx_int_sub(nub_x,nub_y);  
      var nub_dif_y = m_mtx_int_sub(nub_y,nub_x); 
      var x_comp_1000 = m_mtx_real_str_comp(nub_dif_x,1000);   
      var y_comp_1000 = m_mtx_real_str_comp(nub_dif_y,1000);
     if(x_comp_1000 !=2){var ans_1=x; return ans_1;}    
     if(y_comp_1000 !=2){ if(y_st_fst=="-"){ var ans_1= y_st;} 
                          else{var ans_1="-"+ y_st;} return ans_1;} 
     }
    var tran = MTX_COL; 
    MTX_COL=80; 
    var fix_cols =MTX_COL*5-5 ;              
    var  x_e_100 = m_fix(x_e,fix_cols).toString().trim();      
    var  y_e_100 = m_fix(y_e,fix_cols).toString().trim();    
    var  y_e_100 = y_e_100.toString();    
    var  x_e_100 = x_e_100.toString();
    var sutt = " " ;
    if((y_e_100 == x_e_100 && x_st_fst=="-" && y_st_fst=="-")||(y_e_100 == x_e_100 && x_st_fst!="-" && y_st_fst!="-")) { 
           var sutt = 0;
           var sutt = sutt.toString();
            return sutt;
                       };
      if(y_e_100.length < 15 && x_e_100.length < 15 ){       
        if((parseFloat(y_e_100) == parseFloat(x_e_100) && x_st_fst=="-" &&  y_st_fst=="-")||(parseFloat(y_e_100) == parseFloat(x_e_100) && x_st_fst!="-" &&  y_st_fst !="-")) {      
           var sutt = 0;
           var sutt = sutt.toString();
            return sutt;
                      };
                                                   };
    var pexp = x ;      
    var nexp = y ;      
    var  pexp = m_mtx_str_to_e_ne(pexp);               
    var  nexp = m_mtx_str_to_e_ne(nexp);               
    var data_x_fst = pexp.substr(0,1);
    var data_y_fst = nexp.substr(0,1);
    var x_sub =pexp.substr(0,10050);  
    var y_sub =nexp.substr(0,10050);  
         if(x_sub==0 && x_sub.length==1 && data_y_fst=="-"){
             var sutt = nexp.substr(1,nexp.length-1);  
             var sutt=sutt.toString();
                    return sutt;
                       };
           if(x_sub==0 && x_sub.length==1 && data_y_fst!="-"){
                    var sutt = "-"+nexp;      
                    var sutt=sutt.toString();
                    return sutt;
                       };
             if(y_sub==0 && y_sub.length==1){
                    var sutt = x;                    
                    var sutt=sutt.toString();
                   return sutt;
                       };
        pexp = pexp.toString();                                   
         var p_idx_e = pexp.indexOf("e");
        nexp = nexp.toString();                                
         var n_idx_e = nexp.indexOf("e");
             if( n_idx_e == -1 &&  p_idx_e == -1){  
               var sutt =  m_mtx_real_sub_bf(pexp,nexp);   
                         }
             else{ 
                  var sutt = m_mtx_point_add_sub_e(pexp,nexp ,1);}   
              sutt = sutt.replace(/\.e/g , "e");  
                     
          if(sutt==-0 && sutt.lngth==2){ var sutt=0;}   
        MTX_COL= tran ;
       return sutt;     
          
}


function m_mtx_real_sub_bf(x,y){       
    var pexp = x.toString().trim();
    var nexp = y.toString().trim();
    var p_idx_pt = pexp.indexOf(".");   
    var n_idx_pt = nexp.indexOf("."); 
    var tran = MTX_COL;
       MTX_COL=80;
  
      if(n_idx_pt ==-1 && p_idx_pt ==-1 ){   
    var sutt =  m_mtx_int_sub(pexp,nexp);  return sutt;  } 
    var sutt ="";
    var x_fst = pexp.substr(0,1);     
    var x_lg = pexp.length;
    var y_fst = nexp.substr(0,1);
    var y_lg = nexp.length;
      if( x_fst !="-" && y_fst=="-"){       
             nexp = nexp.substr(1,y_lg-1);
             var sutt = m_mtx_real_add(pexp,nexp);
                return sutt;
                    };  
      if( x_fst =="-" && y_fst != "-"){     
             pexp = pexp.substr(1,x_lg-1);   
              var sutt = m_mtx_real_add(pexp,nexp);
              var sutt ="-"+sutt;      
                 return sutt;
                      };  
      if( x_fst =="-" && y_fst == "-"){     
              var  pexp_ch = pexp.substr(1,x_lg-1);
              var  nexp_ch = nexp.substr(1,y_lg-1);       
              var pexp = nexp_ch;
              var nexp = pexp_ch;
                      };  
            var data_point =0;      
            var x_float = parseInt(pexp.substr(0,15));   
            var y_float = parseInt(nexp.substr(0,15));     
            var comp_pexp_nexp = m_mtx_real_str_comp(pexp,nexp);      
      if(comp_pexp_nexp ==3){
              var x_float = pexp;    
              var y_float = nexp;    
                                  } 
       
       if(comp_pexp_nexp ==2){     
                  var pexp_ch_2 = pexp;
                  var nexp_ch_2 = nexp;
                  var pexp = nexp_ch_2;
                  var nexp = pexp_ch_2;
                  var data_point =1;      
                 }
            AA=m_new_zero_mtx(1,MTX_COL);                 
            BB=m_new_zero_mtx(1,MTX_COL);                 
            CC=m_new_zero_mtx(1,MTX_COL);                 
            DD=m_new_zero_mtx(1,MTX_COL);                 
            EE=m_new_zero_mtx(1,MTX_COL);                 
            FF=m_new_zero_mtx(1,MTX_COL);                 
            GG=m_new_zero_mtx(1,MTX_COL);                 
              var pexp_m = m_nub_m_s(pexp);  
              var pexp_p = m_nub_p(pexp);    
             AA=m_mtx_point_in_int(AA,pexp_m); 
             BB=m_mtx_point_in(BB,pexp_p);     
             var nexp_m = m_nub_m_s(nexp);  
             var nexp_p = m_nub_p(nexp);    
             CC=m_mtx_point_in_int(CC,nexp_m); 
             DD=m_mtx_point_in(DD,nexp_p);     
             EE=m_mtx_no_point_sub(AA,CC);            
             EE= m_mtx_cell_five_brow_int(EE);     
             EE= m_mtx_cell_five_int(EE);          
             FF= m_mtx_point_sub(BB,DD);        
             FF= m_mtx_cell_five_brow(FF);     
             FF= m_mtx_cell_five(FF);         
             var nn=0;
             var nn_nub=1000;              
             var nn_ref=MTX_COL;
               if ( nn_ref >1000 && nn_ref<=2000){ var nn_nub = nn_ref ;} 
               else { var nn_nub = 2010;}         
                while( nn < nn_nub ){                   
                if(( parseInt(FF[0][0])< 0 ) &&  parseInt(EE[0][0])>0){  
                        if( parseInt(FF[0][0])<=(-1000000) ){
                            FF[0][0]=parseInt(FF[0][0])+100000;
                            EE[0][0]=parseInt(EE[0][0])-1;}
                         if( parseInt(FF[0][0]) > (-1000000) ){    
                            FF[0][0]=parseInt(FF[0][0])+99999;
                            EE[0][0]=parseInt(EE[0][0])-1;
                               for(var m=1; m < FF[0].length ;m++){
                                   FF[0][m]=99999 - parseInt(FF[0][m]); 
                                 }
                                                              }
                       }
                if( parseInt(FF[0][0])> 0){ nn=10000 ;} 
                           nn=nn+1;
                               }
                    var data_ff00 = FF[0][0].toString().trim();        
                     var data_ff00_fst = data_ff00.substr(0,1);
                if((data_ff00_fst =='-' ) &&  parseInt(EE[0][0])>0){  
                            FF[0][0]=parseInt(FF[0][0])+99999;
                            EE[0][0]=parseInt(EE[0][0])-1;
                                for(var m=1; m < FF[0].length ;m++){
                                   FF[0][m]=99999 - parseInt(FF[0][m]);  
                                                                   }
                                                                 }
              var nn=0;
               while( nn < nn_nub ){      
                if( parseInt(FF[0][0]) >= 100000 ){  
                        FF[0][0]=parseInt(FF[0][0])-100000;
                        EE[0][0]=parseInt(EE[0][0])+1;
                       }
                if( parseInt(FF[0][0]) <100000){ nn=10000 ;} 
                           nn=nn+1;
                               } 
                 FF= m_mtx_cell_five(FF); 
                 if(  parseInt(FF[0][0])==0){
                               FF[0][0]="00000"; }  
                  if(  parseInt(EE[0][0])==0){    
                              EE[0][0]="00000"; }  
                  EE= m_mtx_cell_five_int(EE);          
                var sutt= m_mtx_cell_five_show_int(EE,FF); 
                 var sutt = m_mtx_del_point(sutt);
                 if(data_point ==1){ sutt = "-" +sutt;} 
                
          MTX_COL= tran ;
       return sutt;     
}




function m_mtx_no_point_sub(A,B){    
  var AA=A;
   var BB=B;
   var CC=m_new_zero_mtx(AA.length,AA[0].length);                 
        for(var n=0;n < CC[0].length ; n++){
             var data_a = parseInt(AA[0][n]);
             var data_b = parseInt(BB[0][n]);
                  CC[0][n]= data_a - data_b;}
            CC= m_mtx_cell_five_brow_int(CC);     
                CC= m_mtx_cell_five_int(CC);          
                 if(  parseInt(CC[0][0])==0){    
                               CC[0][0]="00000"; }  
     return CC;   
}

function m_exp(x){     
  var bb=E1;
   var xx=x.toString().trim();
   var data_msg =  m_str_char(x,"Msg") ;                     
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
   var xx = m_str_e_to_str_point(xx );
   var xx = m_fix(xx,FIX_COL);
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var  xx_test_nub_e =m_str_power(xx_test_small,0);             
   var  xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-5001)==2 ){ return  1;}  
   var p_comp_datalg  =  m_mtx_real_str_comp(xx_test_nub_e,200);        
      if( p_comp_datalg ==1  ){
         var ans_1 = message_1(23);
                    return  ans_1  }
     var xx = m_str_e_to_str(xx);     
     var comp_xx_0 = m_mtx_real_str_comp(xx,0);      
    var comp_xx_1 = m_mtx_real_str_comp(xx,1);      
    var ant_1=1;
    var xx_lg =xx.length;
        if(comp_xx_0==3 ){ var ant_1=1;  return ant_1 ;}  
        if(comp_xx_1==3 ){ var ant_1=bb; return ant_1 ;}  
    var xx_fst=xx.substr(0,1);
         if(xx_fst=="-"){ var zz=xx.substr(1,xx.length-1);}
         else {var zz=xx;}   
        zz = m_str_e_to_str(zz);      
    var zz_m = m_nub_m(zz) ;           
    var zz_p = m_nub_p(zz) ;          
    var zz_p = zz_p.toString().trim();   //20210529_
    var sum_m =1;
    var sum_p1 =1;
    var sum_p2 = 1;
    var sum_m = m_pow(bb,zz_m );   
    var comp_zz_p_0 = m_mtx_real_str_comp(zz_p,0);
       if(comp_zz_p_0 !=3 ){
 
    var ref_base ="1.00001000005000016666708333416666805555753968501984402557594797428651804085992454162717136014141480852796471045611480856857919442907354251923631180248048494648131806745900520378762946719772349285499644640337167052258539983501015773120223490663625238577673164933322960053875768755912574727607062740430922";
     var ref_base = m_fix(ref_base,FIX_COL);
    var zz_p_lg = zz_p.length;

        for(var i=0;i<7;i++){
        if(zz_p_lg < 7 && zz_p_lg > 0){ 
           var zz_p=zz_p+"0" ;
           var zz_p_lg = zz_p.length;} 
                             }  
     var zz_p_bf= zz_p.substr(2,5) ;  
     var zz_p_bf= parseInt(zz_p_bf);     
     var sum_p1 = m_pow(ref_base,zz_p_bf );     
        if(zz_p_lg > 7){ 
          var zz_p_af= "0.00000"+zz_p.substr(7,zz_p.length-7) ;    
          var sum_p2 = m_exp_low(zz_p_af);                     
                        } 
                               }
           var ant_p =m_mtx_real_mul(sum_p1 ,sum_p2);
          var ant_1 =m_mtx_real_mul(sum_m ,ant_p);
         if(xx_fst=="-") { var ant = m_mtx_real_div(1 ,ant_1 );}
         else{  var ant = ant_1 ;}
    return ant;  

}


function m_exp_low(x){    
 var zz = x.toString().trim();
  var flag_a=0;
  var flag_b=0;
  var sum_total="";
  var zz_fst=zz.substr(0,1);
     if(zz_fst=="-"){
        var zz = zz.substr(1,zz.length-1);
        var flag_a=1; }                            
     else{ zz=zz;}
  var comp_zz_0 = m_mtx_real_str_comp(zz,0);
  var comp_zz_1 = m_mtx_real_str_comp(zz,1);            
   if(comp_zz_0==3){ var sum_total= 1; return sum_total; }        
     if(comp_zz_1 !=1){    
       var zz = m_str_e_to_str(zz); 
       if( DECI_DGT <=16){
        var BB = m_mtx_exp_coefficient_150_table_a(); }
       else{ var BB = m_mtx_exp_coefficient_150_table();}
       var AA  = m_str_to_mtx(zz) ;              
       var SS_T  = m_str_to_mtx(0) ;              
       if( DECI_DGT <=16){
            var nn=51; }       
       else{ var nn=200;}
     for(var i = 1 ; i < nn ; i++){       
       var BB_i = m_mtx_row_table(BB,i);           
        if(i==1){
        var SS= AA;      
        var XX = m_mtx_point_mul(SS,BB_i);             
                               }  
        else{
        var SS =  m_mtx_point_mul(SS,AA);              
        var XX = m_mtx_point_mul(SS,BB_i);             
                            }
        var SS_T = m_mtx_point_add(SS_T,XX);
                                  }  
                                                }  
        var SS_T = m_mtx_cell_five(SS_T);   
        var sum_total = m_mtx_cell_five_show(SS_T);   
        var sum_total = m_mtx_real_add(1 ,sum_total);  
            if(flag_a ==1){    
                  var sum_total = m_mtx_real_div(1, sum_total);   
                             }   
     return sum_total;  
          
}

function m_sin(x){                         
    var xx=x.toString().trim();
    var data_msg =0;
    var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
    var xx =m_mtx_trim(xx) ; 
    var xx_af =0;                 
    var xx_af_p =0; 
    var xx_af_e =0; 
    var ans_1 = "";
    var ans_a = "";
    var ans_a_s = "";
     var flag_1_2=0; 
    var flag_3_4=0; 
    var xx_fst ="" ;
    if(xx.length<=2 && xx>=0 && xx<=20){   
         var ans_r ="";
         if(xx=="0" ){ var ans_r = SIN00R ;}
          else if(xx=="1"){ var ans_r = SIN01R ;}
          else if(xx=="2"){ var ans_r = SIN02R ;}
          else if(xx=="3"){ var ans_r = SIN03R ;}
          else if(xx=="4"){ var ans_r = SIN04R ;}  
          else if(xx=="5"){ var ans_r = SIN05R ;}  
          else if(xx=="6"){ var ans_r = SIN06R ;}  
          else if(xx=="7"){ var ans_r = SIN07R ;}
          else if(xx=="8"){ var ans_r = SIN08R ;}
          else if(xx=="9"){ var ans_r = SIN09R ;}
          else if(xx=="10"){ var ans_r = SIN10R ;} 
          else if(xx=="12"){ var ans_ra = m_mtx_int_mul(SIN06R,COS06R);  
                             var ans_r =  m_mtx_real_add(ans_ra,ans_ra);}
          else if(xx=="14"){ var ans_ra = m_mtx_int_mul(SIN07R,COS07R);
                             var ans_r =  m_mtx_real_add(ans_ra,ans_ra);}
          else if(xx=="16"){ var ans_ra = m_mtx_int_mul(SIN08R,COS08R);  
                             var ans_r =  m_mtx_real_add(ans_ra,ans_ra);}
          else if(xx=="18"){ var ans_ra = m_mtx_int_mul(SIN09R,COS09R);  
                             var ans_r =  m_mtx_real_add(ans_ra,ans_ra);} 
          else if(xx=="20"){ var ans_ra = m_mtx_int_mul(SIN10R,COS10R);
                             var ans_r =  m_mtx_real_add(ans_ra,ans_ra);} 
          else { var ans_r = "" ;}
        if(ans_r !=""){ return  ans_r; }
                      }    
     if(xx.length<=3 && xx<=0 && xx>=-20){   
         var ans_ra ="";
               if(xx=="-1"){ var ans_ra = "-"+SIN01R ;}
          else if(xx=="-2"){ var ans_ra = "-"+SIN02R ;}
          else if(xx=="-3"){ var ans_ra = "-"+SIN03R ;}
          else if(xx=="-4"){ var ans_ra = SIN04R.substr(1,280) ;}
          else if(xx=="-5"){ var ans_ra = SIN05R.substr(1,280) ;}
          else if(xx=="-6"){ var ans_ra = SIN06R.substr(1,280) ;}
          else if(xx=="-7"){ var ans_ra = "-"+SIN07R ;}
          else if(xx=="-8"){ var ans_ra = "-"+SIN08R ;}
          else if(xx=="-9"){ var ans_ra = "-"+SIN09R ;}
          else if(xx=="-10"){ var ans_ra = SIN10R.substr(1,280) ;}
           else if(xx=="-12"){ var ans_r1 = m_mtx_int_mul(SIN06R,COS06R);  
                              var ans_r2 =  m_mtx_read_add(ans_r1,ans_r1);
                              var ans_ra = ans_r2.substr(1,280);} 
         else if(xx=="-14"){ var ans_r1 = m_mtx_int_mul(SIN07R,COS07R);
                            var ans_ra = "-"+m_mtx_read_add(ans_r1,ans_r1);}
         else if(xx=="-16"){ var ans_r1 = m_mtx_int_mul(SIN08R,COS08R);  
                            var ans_r2 =  m_mtx_read_add(ans_r1,ans_r1);
                            var ans_ra = ans_r2.substr(1,280);} 
         else if(xx=="-18"){ var ans_r1 = m_mtx_int_mul(SIN09R,COS09R);  
                            var ans_r2 =  m_mtx_read_add(ans_r1,ans_r1);
                            var ans_ra = ans_r2.substr(1,280);}
         else if(xx=="-20"){ var ans_r1 = m_mtx_int_mul(SIN10R,COS10R);
                            var ans_ra =  "-"+m_mtx_read_add(ans_r1,ans_r1);} 
          else { var ans_ra = "" ;}
        if(ans_ra !=""){ return  ans_ra; }
                      }
    var idx_e = xx.indexOf("e");
     if( idx_e >0){
          var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
          var xx_af_p =  m_str_char(xx_af,".") ;   
          var xx_af_e =  m_str_char(xx_af,"e") ;     
             if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
             if(xx_af_p >=2 || xx_af_e>=1){ 
                   var ans_1 = message_1(30);             
                           return  ans_1;}
                       }                          
    var xx = m_mtx_str_to_e_a(xx);           
    var xx_test_small = xx;                      
    var xx_test_nub_e =m_str_power(xx_test_small,0);             
    var xx_test_st = m_str_power(xx_test_small,1);  
      if(m_mtx_real_str_comp(xx_test_nub_e,-150)==2 ){ return  xx;}  
      if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);  return  ans_1 ; } 
    var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }
      PIDIV2= m_fix(PIDIV2,FIX_COL); 
      PIMUL2 = m_fix(PIMUL2,FIX_COL); 
      SQRT2 = m_fix(SQRT2,FIX_COL); 
    var com_zz_pidiv2 =0;
      var zz = m_mtx_real_div(xx,PIMUL2);
      if( DECI_DGT <=16){ var deci_b=70;} 
      else { var deci_b=260;}
      var zz = m_fix(zz,deci_b);
      var zz = m_fix_pow(zz,deci_b);
       var zz = m_str_e_to_str(zz);   
       var zz_m = m_nub_m(zz) ;         
       var zz_p = m_nub_p(zz) ;  
       var zz_m = m_mtx_trim(zz_m) ;  
       var zz_p = m_mtx_trim(zz_p) ; 
       var zz_p_t=m_fix(zz_p,200);       
       var zz_p_t =m_mtx_trim(zz_p_t) ;
        
         if(zz_p_t=='1' || zz_p_t =='0' || zz_p_t =='0.0'){  var ans_1 = 0;  return  ans_1; } 
         if( zz_p_t =='0.5'){  var ans_1 = 0;  return  ans_1; }    
         if( zz_p_t =='0.25'){  var ans_1 = 1;  if(xx_fst =="-"){var ans_1 = -1;}  return  ans_1; }                                 
         if( zz_p_t =='0.75'){  var ans_1 = -1;  if(xx_fst =="-"){var ans_1 = 1;}  return  ans_1; }
         if( zz_p_t >='0.75' && zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1,zz_p_t); var zz_p = m_mtx_real_sub(1,zz_p); var flag_3_4=1 ; }       
         else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t,0.5); var zz_p = m_mtx_real_sub(zz_p,0.5); var flag_3_4=1 ; }       
         else if( zz_p_t >='0.25' && zz_p_t <'0.5'){ var zz_p_t = m_mtx_real_sub(0.5,zz_p_t);var zz_p = m_mtx_real_sub(0.5,zz_p); var flag_1_2=1 ; } 
         else if( zz_p_t <'0.25'){ var zz_p = zz_p ; var flag_1_2=1 ; }   
       var dd_t = m_mtx_real_mul(360,zz_p); 
       var dd_t=m_fix(dd_t,200);             
        if(dd_t.length<=2 && dd_t.length>=1){   
         var ans_b ="";
         if(dd_t==09||dd_t==9){ var ans_b = SIN09D ;}
          else if(dd_t==15){ var ans_b = SIN15D ;}
          else if(dd_t==18){ var ans_b = SIN18D ;}
          else if(dd_t==30){ var ans_b = 0.5 ;}
          else if(dd_t==36){ var ans_b = SIN36D ;}
          else if(dd_t==45){ var ans_b = SIN45D ;}
          else if(dd_t==54){ var ans_b = SIN54D ;}
          else if(dd_t==60){ var ans_b = SIN60D ;}
          else if(dd_t==72){ var ans_b = SIN72D ;}
          else if(dd_t==75){ var ans_b = SIN75D ;}
          else if(dd_t==81){ var ans_b = SIN81D ;}
          else { var ans_b = "" ;}
         if(xx_fst !="-" && flag_3_4 ==1){ var ans_b ="-"+ans_b;}
          else if(xx_fst =="-" && flag_1_2 ==1){ var ans_b ="-"+ans_b;}
        if(ans_b !=""){ return  ans_b; }
                         }    
     var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);     
       if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_2=1 ;}   
       else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }   
    var data_flag_sin=0;   
    var data_com = m_mtx_real_str_comp(data_cle_b,'0.0000001'); 
      if(data_com ==1){                          
       var data_cle_b_s = m_mtx_real_div(data_cle_b,1594323);  
       var data_flag_sin=1;   }                        
      else{ data_cle_b_s = data_cle_b ;  }  
    var data_a_s = m_sin_matrix_1(data_cle_b_s);
    if( DECI_DGT <=16){ var deci_nub=75;} 
     else { var deci_nub=250;} 
    var data_a_s=m_fix(data_a_s,deci_nub);
      if(data_flag_sin ==1){                          
        for(var i=0 ; i<13; i++){   
         var data_a3 = m_mtx_int_mul(3,data_a_s);  
         var data_a3=m_fix(data_a3,deci_nub); 
         var data_b = m_mtx_int_mul(data_a_s,data_a_s);
         var data_b=m_fix(data_b,deci_nub); 
         var data_c = m_mtx_int_mul(data_a_s,data_b);
         var data_c=m_fix(data_c,deci_nub);
         var data_c4 = m_mtx_int_mul(4,data_c); 
         var data_c4=m_fix(data_c4,deci_nub); 
         var data_d = m_mtx_real_sub(data_a3,data_c4); 
         var data_d=m_fix(data_d,deci_nub);   
         var data_a_s = data_d; 
        }    } 
     var data_a_s=m_fix(data_a_s,deci_nub);
      var ans_a = data_a_s; 
     if(xx_fst !="-" && flag_3_4 ==1){ var ans_a ="-"+ans_a;}
      else if(xx_fst =="-" && flag_1_2 ==1){ var ans_a ="-"+ans_a;}
      else { var ans_a = ans_a;}
    return ans_a ;
}


function m_str_to_mtx(str){  
     var zz = str.toString().trim();
     var zz_lg=zz.length;  
        if(zz.substr(0,1)=="-"){ zz = zz.substr(1,zz_lg-1);
                                 zz_lg = zz_lg-1;    }
     var zz_str= zz.toString();
     var zz = m_str_e_to_str_point(zz );     
     var zz = m_str_e_to_str(zz ); 
     var zz_m = m_nub_m(zz) ;           
     var zz_p = m_nub_p(zz) ;  
    MTX_COL =400;
     var DD=m_new_zero_mtx(1,MTX_COL);            
     var DD=m_mtx_point_in(DD,zz_p);         
         DD[0][0] = zz_m*100000 + parseInt(DD[0][0]) ;     
      return DD;
}


function m_mtx_element_shift(A,nub){     
var nubb = nub;
  var AA=A;
  var mtx_lg =AA[0].length;  
  var BB = m_new_zero_mtx(1,mtx_lg);            
  var CC = m_new_zero_mtx(1,mtx_lg);            
   while(nubb>0){                      
    for(var i=0;i<(mtx_lg);i++){
        if(i==0){
          BB[0][i]=(AA[0][i]).toString()+(AA[0][i+1]).toString().substr(0,1);}
        if(i >0 && i != (mtx_lg-1)){
          BB[0][i]=(AA[0][i]).toString().substr(1,4)+(AA[0][i+1]).toString().substr(0,1);} 
         if(i== (mtx_lg-1)){
          BB[0][i]=(AA[0][i]).toString().substr(1,4)+"0";}  
                               }  
               AA = m_mtx_copy_mtx(AA,BB);      
              var  nubb = nubb-1;
             }
 while(nubb<0){ 
  for(var i=0;i<mtx_lg;i++){
        if(i==0){
          BB[0][i]="0"+(AA[0][i]).toString().substr(0,4);}    
        if(i>0 ){
          BB[0][i]=(AA[0][i-1]).toString().substr(4,1)+(AA[0][i]).toString().substr(0,4);} 
                              }   
                AA = m_mtx_copy_mtx(AA,BB);      
                 var  nubb = nubb+1;
                             }  
  return BB ;
}




function m_mtx_str_element_shift(x,nub){    
   var nubb=nub;
    var zz_str= x.toString();
    var data_zo = zz_str.substr(0,1);
       if(data_zo=="-"){ zz_str = zz_str.substr(1,zz_str.length-1); }   
    var ans_1="";
    var pos_pot = zz_str.indexOf(".");   
      if(  nubb==0 ){return x;} 

    if(nubb > 0 ) {      
            var nubc = nubb;
            while( nubc > 0){ var zz_str=zz_str+"0";   
                                  nubc=nubc-1; }
                   }
      if(nubb > 0 ) {  
              var nubd = nubb;
            while( nubd > 0){
         var zz_str= zz_str.substr(0,pos_pot)+ zz_str.substr(pos_pot+1,1)+"."+zz_str.substr(pos_pot+2 ,zz_str.length-pos_pot-1);
         var pos_pot = zz_str.indexOf("."); 
                      nubd=nubd-1;                                           
                            }
            ans_1= zz_str ;   
                      }
        if(nubb < 0 ) {      
            var  zz_str=zz_str.toString();
            var nubc = parseInt(nubb); 
            while( nubc < 0){ 
                        var zz_str="0"+zz_str;   
                            zz_str=zz_str.toString().trim();
                                  nubc=nubc+1; }
         
                   }
      if(nubb < 0 ) {                               
              var nubd = m_abs(nubb);
              var pos_pot = zz_str.indexOf(".");   
              var zz_str_lg = zz_str.length;  
              if(pos_pot !=-1){   
                       var zz_str = zz_str.substr(0,pos_pot-nubd)+"."+ zz_str.substr(pos_pot-nubd,nubd)+ zz_str.substr(pos_pot+1,zz_str_lg-pos_pot);
                               }
                else{
                      var zz_str = zz_str.substr(0,zz_str_lg-nubd )+"."+ zz_str.substr(zz_str_lg-nubd,nubd);}     
             var pos_pot = zz_str.indexOf("."); 
             ans_1= zz_str ; 
                      }
               nube=m_abs(nub);

         while( nube > 0){ 
               var pos_pot_a = ans_1.indexOf("."); 
               if( pos_pot_a >1 && ans_1.substr(0,1)=="0"){
                           ans_1=ans_1.substr(1,ans_1.length-1);}   
               if(ans_1.substr(ans_1.length-1,1)=="0"){
                         ans_1=ans_1.substr(0,ans_1.length-1);   
                                                      }
                  nube=nube-1;
                          }
         if(data_zo=="-"){var ans_1="-"+ans_1; }
  
     return ans_1;

 }




function m_mtx_str_to_mtx_wait_inv(x){     
    var zz_str= x.toString();
    var data_zo = zz_str.substr(0,1);
       if(data_zo=="-"){ zz_str = zz_str.substr(1,zz_str.length-1); }    
    var zz_m = m_nub_m(zz_str) ;           
    var zz_p = m_nub_p(zz_str) ;           
    var DD=m_new_zero_mtx(1,MTX_COL);                
       DD=m_mtx_point_in(DD,zz_p);         
       DD[0][0] = zz_m*100000 + parseInt(DD[0][0]) ;    
     return DD;
}



function m_mtx_any_inv(A ,nub){    
  var col_nub = A[0].length;   
  var X = m_new_zero_mtx(1,col_nub);              
  var AA =A;
  var data_test = parseInt(AA[0][0]); 
    if(data_test < 100000 || data_test >999999){
            var ans_1 = message_1(31);
                    return  ans_1 ;     }
  var PI_a = A ;                               
  var SS = m_new_zero_mtx(1 ,col_nub);            
    for(var i=0;i< (col_nub-1);i++){     
     for( var j=4;j >=0 ;j--){    
       for(var k=9 ;k > 0 ;k--){    
           X[0][i]=parseInt(X[0][i])+Math.pow(10,j) ;      
             SS = m_mtx_point_mul(PI_a,X);      
             SS = m_mtx_cell_five_brow(SS);   
              SS = m_mtx_cell_five(SS);        
               var data_chk=0;
               for(var m=1;m<col_nub; m++){     
                    if(SS[0][m] == "00000"){
                       var data_chk=1;  }
                    else{  data_chk=-1;
                            m=col_nub;       }   
                                  }  
              if(parseInt(SS[0][0]) == 100000 && data_chk==1){    
                  k=-1;
                  j=-1;
                  i=col_nub; 
                }
            if((parseInt(SS[0][0]) > 100000)||(parseInt(SS[0][0]) == 100000 && data_chk==-1)) {    
                X[0][i]=parseInt(X[0][i]) - Math.pow(10,j) ;      
                     k = -1; } 
                               } 
                               } 
                        } 
          X = m_mtx_cell_five_brow(X);   
          X = m_mtx_cell_five(X);        
         var sum_tt = m_mtx_cell_five_show(X);   
             sum_tt =sum_tt.toString(); 
     if(nub==1){         
         return  X ;
               }   
    else{
        return  sum_tt;}
   
}




function m_sin_matrix_1(x){    
    var zz = x.toString().trim();
    var zz_fst=zz.substr(0,1);
    var zz_str= zz.toString();
    var sum_tt =0 ;
    var tt=1;
    var zz = m_str_e_to_str(zz);      
    var zz_m = m_nub_m(zz) ;           
    var zz_p = m_nub_p(zz) ;  
    var AA = m_mtx_unit_inv_lg_100_table();
    var CC=m_new_zero_mtx(1,AA[0].length);            
    var BB=m_new_zero_mtx(1,AA[0].length);            
    var ZZ=m_new_zero_mtx(1,AA[0].length);           
    var ITEM_S= m_new_5_unit_mtx(1,MTX_COL);                
    var SUM_T = m_new_zero_mtx(1,MTX_COL);                   
    var DD=m_new_zero_mtx(1,MTX_COL);            
    var DD=m_mtx_point_in(DD,zz_p);  
   
    var comp_zz_p_0 = m_mtx_real_str_comp(zz_p,0); 
     if( DECI_DGT <=16){  var nn =50;  }           
    else{var nn =70; }
     for(var n=1;n < nn ;n++){      
          EE = m_mtx_row_table(AA,n);     
         for(var i=0;i<EE[0].length;i++){
           if(zz_m !=0 && zz_m !="0" ){
                CC[0][i]= m_abs(zz_m) *EE[0][i];          
                                     }
           else{ CC=ZZ;}
                                        }
         if(comp_zz_p_0 !=3 ){      
            var BB = m_mtx_point_mul(EE,DD);      
                       }
            else{ BB=ZZ;}
           var FF = m_mtx_point_add(BB,CC);       
               FF = m_mtx_cell_five_brow(FF);   
               FF = m_mtx_cell_five(FF);      
             if(n==1){ var ITEM_S = FF ;}                      
             else { var ITEM_S = m_mtx_point_mul(ITEM_S,FF);}
               ITEM_S = m_mtx_cell_five_brow(ITEM_S);  
               ITEM_S = m_mtx_cell_five(ITEM_S);      
                 CC=m_new_zero_mtx(1,AA[0].length);            
                  BB=m_new_zero_mtx(1,AA[0].length);
                  EE=m_new_zero_mtx(1,AA[0].length);  
              if( (n+1)%2==0 && (n+1)%4 !=0 ){       
                    SUM_T = m_mtx_point_add(SUM_T,ITEM_S);   
                                   }
               if( (n+1)%2==0 && (n+1)%4 ==0 ){          
                      SUM_T = m_mtx_point_sub(SUM_T,ITEM_S);   
                        }                                       
                 SUM_T = m_mtx_cell_five_brow(SUM_T);   
                 SUM_T = m_mtx_cell_five(SUM_T);      
                 FF=m_new_zero_mtx(1,AA[0].length);          
                                 }

            SUM_T = m_mtx_cell_five_brow(SUM_T);   
            SUM_T = m_mtx_cell_five(SUM_T);      
           var sum_tt = m_mtx_cell_five_show(SUM_T);   
               if(x < 0 && SUM_T[0][0] >=0 ){           
                        var sum_tt = "-"+ sum_tt ;}     
                  if(x < 0 && SUM_T[0][0] < 0 ){   
                         var sum_tt = sum_tt.substr(1,sum_tt.length) ;}   
       
               sum_tt =sum_tt.toString();
           return sum_tt ;  
  }

function m_cos_matrix_1(x){     
    var zz = x.toString().trim();
    var zz_fst=zz.substr(0,1);
    var zz_str= zz.toString();
    var sum_tt =0 ;
    var tt=1;
    var zz = m_str_e_to_str(zz);      
    var zz_m = m_nub_m(zz) ;           
    var zz_p = m_nub_p(zz) ; 
    var AA = m_mtx_unit_inv_lg_100_table();
    var CC=m_new_zero_mtx(1,AA[0].length);             
    var BB=m_new_zero_mtx(1,AA[0].length);             
    var ZZ=m_new_zero_mtx(1,AA[0].length);             
    var ITEM_S= m_new_5_unit_mtx(1,MTX_COL);                
    var SUM_T = m_new_zero_mtx(1,MTX_COL);                     
    var DD=m_new_zero_mtx(1,MTX_COL);            
    var DD=m_mtx_point_in(DD,zz_p); 
    var comp_zz_p_0 = m_mtx_real_str_comp(zz_p,0);  
    if( DECI_DGT <=16){  var nn =50;  }           
    else{var nn =70; }
      for(var n=1;n <=nn ;n++){                 
         EE = m_mtx_row_table(AA,n);     
     for(var i=0;i<EE[0].length;i++){
     if(zz_m !=0 && zz_m !="0" ){
            CC[0][i]= m_abs(zz_m) *EE[0][i]; }         
           else{ CC=ZZ;}
                                       }
       if(comp_zz_p_0 !=3 ){      
          var BB = m_mtx_point_mul(EE,DD); }        
       else{ BB=ZZ;}
     var FF = m_mtx_point_add(BB,CC);          
         FF = m_mtx_cell_five_brow(FF);     
         FF = m_mtx_cell_five(FF);        
           if(n==1){ var ITEM_S = FF ;}                      
            else { var ITEM_S = m_mtx_point_mul(ITEM_S,FF);}
             ITEM_S = m_mtx_cell_five_brow(ITEM_S);     
             ITEM_S = m_mtx_cell_five(ITEM_S);        
              CC=m_new_zero_mtx(1,AA[0].length);            
              BB=m_new_zero_mtx(1,AA[0].length);
              EE=m_new_zero_mtx(1,AA[0].length);  
           if( (n)%2==0 && (n)%4 !=0 ){                             
                SUM_T = m_mtx_point_sub(SUM_T,ITEM_S);   
                                }
           if( (n)%2==0 && (n)%4 ==0 ){           
                      SUM_T = m_mtx_point_add(SUM_T,ITEM_S);     
                        }                                       
                SUM_T = m_mtx_cell_five_brow(SUM_T);    
                SUM_T = m_mtx_cell_five(SUM_T);        
                FF=m_new_zero_mtx(1,AA[0].length);          
                                 }
         SUM_T = m_mtx_cell_five_brow(SUM_T);     
         SUM_T = m_mtx_cell_five(SUM_T);        
           var sum_tt = m_mtx_cell_five_show(SUM_T);   
              if(x < 0 && SUM_T[0][0] >=0 ){           
                        var sum_tt = "-"+ sum_tt ;}      
                  if(x < 0 && SUM_T[0][0] < 0 ){   
                         var sum_tt = sum_tt.substr(1,sum_tt.length) ;}   
             sum_tt =sum_tt.toString();
             sum_tt = m_mtx_real_add(1,sum_tt);  
            return sum_tt ;  
   } 



function m_cos(x){          
   var xx=x.toString().trim();
    var data_msg =0;
    var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
    var xx =m_mtx_trim(xx) ;
    var xx_af =0;               
    var xx_af_p =0; 
    var xx_af_e =0; 
    var ans_1 = "";
    var ans_a = "";
    var ans_a_s = "";
    var flag_2_3=0; 
    var flag_1_4=0; 
    var xx_fst ="" ;
    if(xx.length<=3 && xx <=10 && xx >=-10){   
         var ans_r ="";
         if(xx=="0" || xx=="-0"){ var ans_r = COS00R ;}
          else if(xx=="1" || xx=="-1" ){ var ans_r = COS01R ;}
          else if(xx=="2" || xx=="-2" ){ var ans_r = COS02R ;}  
          else if(xx=="3" || xx=="-3" ){ var ans_r = COS03R ;}  
          else if(xx=="4" || xx=="-4" ){ var ans_r = COS04R ;}        
          else if(xx=="5" || xx=="-5" ){ var ans_r = COS05R ;}  
          else if(xx=="6" || xx=="-6" ){ var ans_r = COS06R ;}  
          else if(xx=="7" || xx=="-7" ){ var ans_r = COS07R ;}
          else if(xx=="8" || xx=="-8" ){ var ans_r = COS08R ;}     
          else if(xx=="9" || xx=="-9" ){ var ans_r = COS09R ;}     
          else if(xx=="10"|| xx=="-10" ){ var ans_r = COS10R ;}     
          else { var ans_r = "" ;}
        if(ans_r !=""){ return  ans_r; }
                      }    
    var idx_e = xx.indexOf("e");
     if( idx_e >0){
          var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
          var xx_af_p =  m_str_char(xx_af,".") ;   
          var xx_af_e =  m_str_char(xx_af,"e") ;     
             if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
             if(xx_af_p >=2 || xx_af_e>=1){ var ans_1 = message_1(30); return  ans_1;}  }
    var xx = m_mtx_str_to_e_a(xx);            
    var xx_test_small = xx;              
    var xx_test_nub_e =m_str_power(xx_test_small,0);             
    var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-150)==2 ){      
        var ans_a=1 ; return  ans_a;}                     
      if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16); return  ans_1 ; }  
    var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }  
    var com_zz_pidiv2 =0;
      PIDIV2= m_fix(PIDIV2,FIX_COL); 
      PIMUL2 = m_fix(PIMUL2,FIX_COL); 
      SQRT2 = m_fix(SQRT2,FIX_COL); 
     var zz = m_mtx_real_div(xx,PIMUL2); 
     if( DECI_DGT <=16){ var deci_b=70;} 
     else { var deci_b=260;}
     var zz = m_fix(zz,deci_b); 
     var zz = m_fix_pow(zz,deci_b);
      var zz = m_str_e_to_str(zz);   
      var zz_m = m_nub_m(zz) ;         
      var zz_p = m_nub_p(zz)  ;                 
      var zz_m = m_mtx_trim(zz_m) ;  
      var zz_p = m_mtx_trim(zz_p) ; 
      var zz_p_t=m_fix(zz_p,200);            
      var zz_p_t =m_mtx_trim(zz_p_t) ; 
     if(zz_p_t=="1" || zz_p_t =="0" || zz_p_t =="0.0"){  var ans_1 = 1;  return  ans_1; }   
      if( zz_p_t =='0.5'){  var ans_1 = -1;  if(xx_fst =="-"){var ans_1 = 1;} return  ans_1; }   
      if( zz_p_t =='0.25'||zz_p_t =='0.75'){  var ans_1 = 0;  return  ans_1; }                   
     if( zz_p_t >='0.75'&& zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1,zz_p_t); var zz_p = m_mtx_real_sub(1,zz_p); var flag_1_4=1;  }   
      else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t,0.5); var zz_p = m_mtx_real_sub(zz_p,0.5); var flag_2_3=1 ; }   
      else if( zz_p_t >='0.25'&& zz_p_t <'0.5' ){ var zz_p_t = m_mtx_real_sub(0.5,zz_p_t); var zz_p = m_mtx_real_sub(0.5,zz_p);var flag_2_3=1 ; } 
      else if( zz_p_t <'0.25'){var zz_p =  zz_p ;var flag_1_4=1 ; }   
     var dd_t = m_mtx_real_mul(360,zz_p); 
     var dd_t=m_fix(dd_t,400);    
     if(dd_t.length<=2 && dd_t.length>=1){   
          var ans_b ="";
         if(dd_t==09||dd_t==9){ var ans_b = SIN81D ;}
          else if(dd_t==15){ var ans_b = SIN75D ;}
          else if(dd_t==18){ var ans_b = SIN72D ;}
          else if(dd_t==30){ var ans_b = SIN60D ;}
          else if(dd_t==36){ var ans_b = SIN54D ;}
          else if(dd_t==45){ var ans_b = SIN45D ;}
          else if(dd_t==54){ var ans_b = SIN36D ;}
          else if(dd_t==60){ var ans_b = 0.5 ;}
          else if(dd_t==72){ var ans_b = SIN18D ;}
          else if(dd_t==75){ var ans_b = SIN15D ;}
          else if(dd_t==81){ var ans_b = SIN09D ;}
          else { var ans_b = "" ;}
         if( flag_2_3 ==1){ var ans_b ="-"+ans_b;}         
          else if( flag_1_4 ==1){ var ans_b = +ans_b;}   
        if(ans_b !=""){ return  ans_b; }
                         }    
    var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);     
     if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_4=1 ;}   
      else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }        
    var data_flag_cos=0;   
    var data_com = m_mtx_real_str_comp(data_cle_b,'0.0000001');  
      if(data_com ==1){                          
        var data_cle_b_s = m_mtx_real_div(data_cle_b,1594323);   
       var data_flag_cos=1; }                          
      else{ data_cle_b_s = data_cle_b ;  }  
    var data_a_s = m_cos_matrix_1(data_cle_b_s);  
    if( DECI_DGT <=16){ var deci_nub=75;} 
     else { var deci_nub=250;} 
     var data_a_s=m_fix(data_a_s,deci_nub);
     if(data_flag_cos ==1){                          
        for(var i=0 ; i<13; i++){                            
         var data_a3 = m_mtx_real_mul(3,data_a_s);    
         var data_a3=m_fix(data_a3,deci_nub); 
         var data_b = m_mtx_real_mul(data_a_s,data_a_s);
         var data_b=m_fix(data_b,deci_nub);
         var data_c = m_mtx_real_mul(data_a_s,data_b);
         var data_c=m_fix(data_c,deci_nub); 
         var data_c4 = m_mtx_real_mul(4,data_c); 
         var data_c4=m_fix(data_c4,deci_nub); 
         var data_d = m_mtx_real_sub(data_c4,data_a3);
         var data_d=m_fix(data_d,deci_nub); 
         var data_a_s = data_d;  }   }   
         var data_a_s=m_fix(data_a_s,deci_nub);
      var ans_a = data_a_s;  
    if( flag_2_3 ==1){ var ans_a ="-"+ans_a;}  
    if( flag_1_4 ==1){ var ans_a = ans_a;}  
   return ans_a ;
  }

function m_tan(x){                           
  var xx=x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
  var xx =m_mtx_trim(xx) ;  
  var xx_af =0;
  var xx_af_p =0; 
  var xx_af_e =0; 
  var ans_1 = "";
  var ans_a = "";
  var ans_a_s = "";
  var flag_2_4=0; 
  var flag_1_3=0; 
  var xx_fst ="" ;
  if(xx.length<=3 && xx>=-10 && xx<=10){   
         var ans_r ="";
         if(xx=="0" ){ var ans_r = 0 ;}
          else if(xx=="1"){ var ans_r = m_mtx_real_div(SIN01R,COS01R);}
          else if(xx=="-1"){ var ans_r = "-"+m_mtx_real_div(SIN01R,COS01R);}
          else if(xx=="2"){ var ans_r = m_mtx_real_div(SIN02R,COS02R);}
          else if(xx=="-2"){ var ans_r1 = m_mtx_real_div(SIN02R,COS02R);
                             var ans_r = ans_r1.substr(1,280);} 
          else if(xx=="3"){ var ans_r = m_mtx_real_div(SIN03R,COS03R);}
          else if(xx=="-3"){ var ans_r1 = m_mtx_real_div(SIN03R,COS03R);
                             var ans_r = ans_r1.substr(1,280);} 
          else if(xx=="4"){ var ans_r = m_mtx_real_div(SIN04R,COS04R);}
          else if(xx=="-4"){ var ans_r ="-"+ m_mtx_real_div(SIN04R,COS04R);}
          else if(xx=="5"){ var ans_r = m_mtx_real_div(SIN05R,COS05R);}
          else if(xx=="-5"){ var ans_r1 = m_mtx_real_div(SIN05R,COS05R);
                             var ans_r = ans_r1.substr(1,280);}  
          else if(xx=="6"){ var ans_r = m_mtx_real_div(SIN06R,COS06R);}
          else if(xx=="-6"){ var ans_r1 = m_mtx_real_div(SIN06R,COS06R);
                             var ans_r = ans_r1.substr(1,280);}
          else if(xx=="7"){ var ans_r = m_mtx_real_div(SIN07R,COS07R);}
          else if(xx=="-7"){ var ans_r ="-"+ m_mtx_real_div(SIN07R,COS07R);}
          else if(xx=="8"){ var ans_r = m_mtx_real_div(SIN08R,COS08R);}
          else if(xx=="-8"){ var ans_r1 = m_mtx_real_div(SIN08R,COS08R);
                             var ans_r = ans_r1.substr(1,280);}  
          else if(xx=="9"){ var ans_r = m_mtx_real_div(SIN09R,COS09R);}
          else if(xx=="-9"){ var ans_r1 = m_mtx_real_div(SIN09R,COS09R);
                             var ans_r = ans_r1.substr(1,280);} 
          else if(xx=="10"){ var ans_r = m_mtx_real_div(SIN10R,COS010R);}
          else if(xx=="-10"){ var ans_r1 = m_mtx_real_div(SIN10R,COS10R);
                             var ans_r =  ans_r1.substr(1,280);} 
          else { var ans_r = "" ;}
        if(ans_r !=""){ return  ans_r; }
                      } 
  var idx_e = xx.indexOf("e");
     if( idx_e >0){
          var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
          var xx_af_p =  m_str_char(xx_af,".") ;   
          var xx_af_e =  m_str_char(xx_af,"e") ;     
             if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
             if(xx_af_p >=2 || xx_af_e>=1){ 
                   var ans_1 = message_1(30);             
                           return  ans_1;}
                       }                          
 
  
  var xx = m_mtx_str_to_e_a(xx);           
  var data_cle =0;    
  var xx_test_small = xx;             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          

     if(m_mtx_real_str_comp(xx_test_nub_e,-150)==2 ){    
       var ans_a=xx ; return  ans_a;}                       
     if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   
                                                                return  ans_1 ; }    
    var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }  
   var com_zz_pidiv2 =0;
      var zz = m_mtx_real_div(xx,PIMUL2); 
      if( DECI_DGT <=16){ var deci_b=70;} //20230305
     else { var deci_b=260;} 
      var zz = m_fix(zz,deci_b);  
      var zz = m_fix_pow(zz,deci_b);
       var zz = m_str_e_to_str(zz);   
       var zz_m = m_nub_m(zz) ;         
       var zz_p = m_nub_p(zz) ;  
       var zz_m = m_mtx_trim(zz_m) ;  
       var zz_p = m_mtx_trim(zz_p) ; 
       var flag_2_4=0 ;    
       var flag_1_3=0 ;
       var zz_p_t=m_fix(zz_p,200);   
       var zz_p_t =m_mtx_trim(zz_p_t)
       if(zz_p_t=='1' || zz_p_t =='0' || zz_p_t =='0.0'){  var ans_1 = 0;  return  ans_1; }  
       if( zz_p_t =='0.5'){  var ans_1 = 0;  return  ans_1; }    
       if( zz_p_t =='0.25'|| zz_p_t =='0.75'){  var ans_1 = message_1(11);  return ans_1 ; } 
     
       if( zz_p_t >='0.75' && zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1 ,zz_p_t); var zz_p = m_mtx_real_sub(1 ,zz_p); var flag_2_4=1 ; }   
       else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t ,0.5); var zz_p = m_mtx_real_sub(zz_p ,0.5); var flag_1_3=1 ; }  
       else if( zz_p_t >='0.25' && zz_p_t <'0.5'){ var zz_p_t = m_mtx_real_sub(0.5 ,zz_p_t); var zz_p = m_mtx_real_sub(0.5 ,zz_p);  var flag_2_4=1 ; }  
       else if( zz_p_t <'0.25'  ){  var zz_p =zz_p;var flag_1_3=1 ; } 
     var dd_t = m_mtx_real_mul(360,zz_p); 
     var dd_t=m_fix(dd_t,200); 
     if(dd_t.length<=2 && dd_t.length>=1){   
          var ans_b ="";
         if(dd_t==09||dd_t==9){ var ans_b = m_mtx_real_div(SIN09D,SIN81D) ;}
          else if(dd_t==15){ var ans_b = m_mtx_real_div(SIN09D,SIN75D) ;}
          else if(dd_t==18){ var ans_b = m_mtx_real_div(SIN18D,SIN72D) ;}
          else if(dd_t==30){ var ans_b = m_mtx_real_div(SIN30D,SIN60D) ;}
          else if(dd_t==36){ var ans_b = m_mtx_real_div(SIN36D,SIN54D) ;}
          else if(dd_t==45){ var ans_b = 1 ;}
          else if(dd_t==54){ var ans_b = m_mtx_real_div(SIN54D,SIN36D) ;}
          else if(dd_t==60){ var ans_b = m_mtx_real_div(SIN60D,SIN30D) ;}
          else if(dd_t==72){ var ans_b = m_mtx_real_div(SIN72D,SIN18D) ;}
          else if(dd_t==75){ var ans_b = m_mtx_real_div(SIN75D,SIN15D) ;}
          else if(dd_t==81){ var ans_b = m_mtx_real_div(SIN81D,SIN09D) ;}
          else { var ans_b = "" ;}
         if(xx_fst =="-" && flag_1_3 ==1){ var ans_b ="-"+ans_b;}
          else if(xx_fst !="-" && flag_2_4 ==1){ var ans_b ="-"+ans_b;}
        if(ans_b !=""){ return  ans_b; }
                         }     
     var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);  
      if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_3=1 ;}  
      else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }
     var data_sin = m_sin(data_cle_b);                       
     var data_cos = m_cos(data_cle_b);   
     var ans_a = m_mtx_real_div(data_sin,data_cos);             
      if(xx_fst =="-" && flag_1_3 ==1){ var ans_a ="-"+ans_a;}
      if(xx_fst !="-" && flag_2_4 ==1){ var ans_a ="-"+ans_a;}
  return ans_a ;    
   }



function m_sinh(x){
  var xx = x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;} 
  var xx =m_mtx_trim(xx) ; 
  var xx = m_str_e_to_str_point(xx );
  var xx_test_small = m_mtx_str_to_e_a(xx);               
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
    if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
   var ans_a=xx ; return  ans_a;} 
 if(m_mtx_real_str_comp(xx_test_nub_e,201)==1 ){ 
    var ans_a= message_1(24) ; return  ans_a;}      
  var xx_str =xx;
  var xx_fst =xx_str.substr(0,1);
    if(xx_fst=="-"){ var xx_abs = xx_str.substr(1,xx_str.length-1);}
    else { var xx_abs = xx_str;}
  var xx_str = m_str_e_to_str(xx_str);      
     if(m_mtx_real_str_comp(xx_abs,0)==3 ){ var sum_total = 0; return sum_total; }  
  var comp_xx_1 = m_mtx_real_str_comp(xx_abs,1);           
     if(comp_xx_1 !=1){        
       var xx_abs = m_str_e_to_str(xx_abs);          
       if( DECI_DGT <=16){
       var BB = m_mtx_exp_coefficient_150_table_a(); }
       else{ var BB = m_mtx_exp_coefficient_150_table();} 
       var AA  = m_str_to_mtx(xx_abs) ;              
       var AA2 = m_mtx_point_mul(AA,AA);
       var SS_T  = m_str_to_mtx(0) ;              
       if( DECI_DGT <=16){ var nn=51; }                       
        else{  var nn=200; }  
  for(var i = 1 ; i < nn ; i++){       
       var BB_i = m_mtx_row_table(BB,i);               
           if(i==1){
             var SS= AA;      //inv
             var XX = m_mtx_point_mul(SS,BB_i);             
             var SS_T = m_mtx_point_add(SS_T,XX);
                                  }  
             var data_test = i%2;
           if(data_test==1 && i!=1){
             var SS =  m_mtx_point_mul(SS,AA2);              
             var XX = m_mtx_point_mul(SS,BB_i);             
             var SS_T = m_mtx_point_add(SS_T,XX);
                                                   }  
                                               }  
             var SS_T = m_mtx_cell_five(SS_T);   
             var sum_total = m_mtx_cell_five_show(SS_T);   
           if(xx_fst=="-"){  sum_total = "-"+sum_total;} 
                return sum_total;     
                 }          
  var pexp = m_exp(xx_abs);
  var nexp = m_exp("-"+xx_abs);
  var sutt ="";
  var sum_total ="";
  var data_test_a = m_mtx_real_str_comp(xx_abs,10000) ; //20201115 
    if(data_test_a ==1){ var sutt= pexp ;}    
    else{  var nexp = m_mtx_real_div(1,pexp);   
  var sutt = m_mtx_real_sub(pexp,nexp);}
  var sutt_1= m_mtx_real_div(sutt,2);
          sum_total = sutt_1;
    if(xx_fst=="-"){  sum_total = "-"+sum_total;} 
  var sum_total = sum_total.toString().trim();
     return sum_total;
}


function m_cosh(x){       
 var xx = x.toString().trim();
  var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
 var xx =m_mtx_trim(xx) ;
  var xx = m_str_e_to_str_point(xx );
  var xx_test_small = m_mtx_str_to_e_a(xx);            
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
       var ans_a=1 ; return  ans_a;} 
      if(m_mtx_real_str_comp(xx_test_nub_e,201)==1 ){ 
       var ans_a= message_1(25) ; return  ans_a;}
  var xx_str =xx;
  var xx_fst =xx_str.substr(0,1);
  var sutt ="";
  var sutt_1="";
  var sum_total ="";
    if(xx_fst=="-"){ var xx_abs = xx_str.substr(1,xx_str.length-1);}
     else { var xx_abs = xx_str;}
      xx_str = m_str_e_to_str(xx_str);      
      if( m_mtx_real_str_comp(xx_abs,0)==3){ var sum_total = 1; return sum_total;} 
   var comp_xx_1 = m_mtx_real_str_comp(xx_abs,1);     
      if(comp_xx_1 !=1){        
        var xx_abs = m_str_e_to_str(xx_abs);          
       if( DECI_DGT <=16){
       var BB = m_mtx_exp_coefficient_150_table_a(); }
       else{ var BB = m_mtx_exp_coefficient_150_table();}       
        var AA  = m_str_to_mtx(xx_abs) ;              
        var AA2 = m_mtx_point_mul(AA,AA);
        var SS_T  = m_str_to_mtx(0) ;                 
        if( DECI_DGT <=16){ var nn=51; }  
       else{var nn=200; } 
       for(var i = 0 ; i < nn ; i++){       
           var BB_i = m_mtx_row_table(BB,i);               
            if(i==0){
               var SS= m_str_to_mtx(1) ;                 
               var XX = m_mtx_point_mul(SS,BB_i);             
               var SS_T = m_mtx_point_add(SS_T,XX);
                                }  
               var data_test = i%2;
            if(data_test==0 && i!=0){
               var SS =  m_mtx_point_mul(SS,AA2);              
               var XX = m_mtx_point_mul(SS,BB_i);             
               var SS_T = m_mtx_point_add(SS_T,XX);
                                                }  
                                                }  
               var SS_T = m_mtx_cell_five(SS_T);   
               var  sum_total = m_mtx_cell_five_show(SS_T);   
                  return sum_total;     
                 }  
     var pexp = m_exp(xx_abs);
     var data_test_a = m_mtx_real_str_comp(xx_abs,10000) ; //20201115  
         if(data_test_a ==1){ var sutt= pexp ;}    
          else {  var nexp = m_mtx_real_div(1,pexp);    
                  var sutt = m_mtx_real_add(pexp,nexp);}
       var sutt_1= m_mtx_real_div(sutt,2);    
                sum_total = sutt_1;
     var sum_total = sum_total.toString().trim();
     return sum_total;
}



function m_tanh(x){
  var xx = x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
  var xx =m_mtx_trim(xx) ;
  var xx = m_str_e_to_str_point(xx ); 
  var xx_test_small = m_mtx_str_to_e_a(xx);              
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
     var ans_a=xx ; return  ans_a;} 
  var xx_str =xx;
  var xx_fst =xx_str.substr(0,1);
    if(m_mtx_real_str_comp(xx_test_nub_e,3)==1 && xx_fst !="-"){   
          var ans_a=1 ; return  ans_a;}
     if(m_mtx_real_str_comp(xx_test_nub_e,3)==1 && xx_fst =="-"){ 
          var ans_a=-1 ; return  ans_a;}
    if(xx_fst=="-"){ var xx_abs = xx_str.substr(1,xx_str.length-1);}
    else { var xx_abs = xx_str;}
     xx_str = m_str_e_to_str(xx_str);      
       if(m_mtx_real_str_comp(xx_abs,0)==3 ){ var sum_total = 0; return sum_total; }  
  var yy=0;    
  var zz=0;
      sum_t="";
  var yy=m_sinh(xx_abs); 
  var zz=m_cosh(xx_abs); 
  var sum_t= m_mtx_real_div(yy,zz);   
     if(xx_fst=="-"){ var sum_t="-"+sum_t; }
   var sum_t = sum_t.toString().trim();
return sum_t;
}

function m_ext_in_funct(x){   
  var xx_st = x;
       xx_st = xx_st.replace(/\(Q\(/g , "\(0\-\(");    
       xx_st = m_hat_bf_aft_many(xx_st ,'^','PPP');           
       xx_st = xx_st.replace(/PPP/g ,'m_pow');             
       xx_st = m_hat_bf_aft_many(xx_st ,'*','MMM');              
       xx_st = xx_st.replace(/MMM/g, 'm_mtx_real_mul');    
       xx_st = m_hat_bf_aft_many(xx_st ,'-','SSS');            
       xx_st = xx_st.replace(/SSS/g ,'m_mtx_real_sub');  
       xx_st = m_hat_bf_aft_many(xx_st ,'+','AAA');                                 
       xx_st = xx_st.replace(/AAA/g , "m_mtx_real_add");   
       xx_st = xx_st.replace(/e\+/g , "xxx");   
       xx_st = xx_st.replace(/e\-/g , "yyy");   
       xx_st = xx_st.replace(/\(/g , "\('");   
       xx_st = xx_st.replace(/\)/g , "'\)");   
       xx_st = xx_st.replace(/\+/g , "'\+'");   
       xx_st = xx_st.replace(/\-/g , "'\-'");      
       xx_st = xx_st.replace(/\*/g , "'\*'");   
       xx_st = xx_st.replace(/\//g , "'\/'");   
       xx_st = xx_st.replace(/\^/g , "'\^'");    
       xx_st = xx_st.replace(/\,/g , "'\,'");     
       xx_st = xx_st.replace(/''/g , "'");                     
       xx_st = xx_st.replace(/\'\(/g , "\(");  
       xx_st = xx_st.replace(/\)\'/g , "\)");  
       xx_st = xx_st.replace(/\(\'m/g , "\(m"); 
       xx_st = xx_st.replace(/\'m/g , "\m");    
       xx_st = xx_st.replace(/xxx/g , "e\+");    
       xx_st = xx_st.replace(/yyy/g , "e\-");    
       xx_st = xx_st.replace(/Q\'3\.14/g , "\Q3\.14");     
   var pos_m  = xx_st.indexOf("m");    
   var xx_st = xx_st.toString();   
  return xx_st ;

}

function m_ext_in_funct_2(x){ 
     var xx_st = x ;
     var xx_st = xx_st.replace(/m_exp\(\(m_ln/g , "m_exp_ln\(\(");  
     var xx_st = xx_st.replace(/m_ln\(\(m_exp/g , "m_ln_exp\(\(");   
     var xx_st = xx_st.replace(/m_sin\(\(m_asin/g , "m_sin_asin\(\(");  
     var xx_st = xx_st.replace(/m_sin\(\(m_acos/g , "m_sin_acos\(\(");   
     var xx_st = xx_st.replace(/m_sin\(\(m_atan/g , "m_sin_atan\(\(");  
     var xx_st = xx_st.replace(/m_asin\(\(m_sin/g , "m_asin_sin\(\(");    
     var xx_st = xx_st.replace(/m_sin\(\(m_asin/g , "m_sin_asin\(\(");  
     var xx_st = xx_st.replace(/m_asin\(\(m_cos/g , "m_asin_cos\(\("); 
     var xx_st = xx_st.replace(/m_sinh\(\(m_asinh/g , "m_sinh_asinh\(\("); 
     var xx_st = xx_st.replace(/m_asinh\(\(m_sinh/g , "m_asinh_sinh\(\(");
     var xx_st = xx_st.replace(/m_cos\(\(m_acos/g , "m_cos_acos\(\(");  
     var xx_st = xx_st.replace(/m_cos\(\(m_asin/g , "m_cos_asin\(\(");    
     var xx_st = xx_st.replace(/m_cos\(\(m_atan/g , "m_cos_atan\(\(");  
     var xx_st = xx_st.replace(/m_acos\(\(m_sin/g , "m_acos_sin\(\(");    
     var xx_st = xx_st.replace(/m_acos\(\(m_cos/g , "m_acos_cos\(\(");    
     var xx_st = xx_st.replace(/m_cosh\(\(m_acosh/g , "m_cosh_acosh\(\("); 
     var xx_st = xx_st.replace(/m_acosh\(\(m_cosh/g , "m_acosh_cosh\(\("); 
     var xx_st = xx_st.replace(/m_tan\(\(m_asin/g , "m_tan_asin\(\(");   
     var xx_st = xx_st.replace(/m_tan\(\(m_acos/g , "m_tan_acos\(\(");   
     var xx_st = xx_st.replace(/m_tan\(\(m_atan/g , "m_tan_atan\(\(");   
     var xx_st = xx_st.replace(/m_atan\(\(m_tan/g , "m_atan_tan\(\("); 
     var xx_st = xx_st.replace(/m_tanh\(\(m_atanh/g , "m_tanh_atanh\(\(");    
     var xx_st = xx_st.replace(/m_atanh\(\(m_tanh/g , "m_atanh_tanh\(\(");    
 return xx_st ;
}

function m_mtx_e_str(x,nub){   
   var xx_st=x.toString();
   var pos_pot  = xx_st.indexOf(".");    
   var pos_e  = xx_st.indexOf("e");    
   var pos_pls  = xx_st.indexOf("+");   
   var st_lg = xx_st.length;
   var nub_e=0; 
        if(  pos_e != -1){
        if(pos_pls ==-1){
               var nub_e =  xx_st.substr(pos_e+1,xx_st.length - pos_e); 
                             }
         else{var nub_e =  xx_st.substr(pos_e+2,xx_st.length - pos_e-1);} 
               var nub_e=nub_e.toString().trim();
                xx_st = xx_st.substr(0,pos_e);       
                       }
            var nub_e =m_mtx_trim(nub_e) ;          
            var xx_st =m_mtx_trim(xx_st) ;          
        if(nub==0){
               var nub_e=nub_e.toString().trim();
                return nub_e;}
        else{
               var xx_st=xx_st.toString().trim();
               var xx_st=m_mtx_del_point(xx_st);    
              return xx_st;}          
   }


function m_mtx_point_add_sub_e(a,b,nub){    
   var aa=a.toString().trim();
   var bb=b.toString().trim();
   var nubb=nub;
   var deci_dgt_inpt=16;
   var deci_dgt_nub =0;
   var aa_e = m_mtx_e_str(aa ,0);   
   var ans_a ="";                  
   var nub_point_a = m_str_char(aa_e,".") ;  
      if(nub_point_a ==1){
       var aa = m_str_e_to_str_point(aa );     
        var aa_e = m_mtx_e_str(aa ,0); }  
       else if(nub_point_a > 1){ 
        var ans_a = message_1(30);
              return  ans_a  ;} 
   var aa_str = m_mtx_e_str(aa ,1);   
   var bb_e = m_mtx_e_str(bb ,0); 
   var ans_b ="";                             
   var nub_point_b = m_str_char(bb_e,".") ;  
      if(nub_point_b ==1){
        var bb = m_str_e_to_str_point(bb );      
        var bb_e = m_mtx_e_str(bb ,0);}   
       else if(nub_point_b > 1){ 
          var ans_b = message_1(30);
               return  ans_b  ;   }  
   var bb_str = m_mtx_e_str(bb ,1);   
   var sum_st ="";
   var e_nub =0;
   var dd_e =  m_mtx_int_sub(aa_e,bb_e); 
   var b_fst=bb.substr(0,1);
       if(dd_e >0  ){               
                   bb_str =bb_str.toString().trim();
               var chk_point =0;  
               var chk_fst=bb_str.substr(0,1);
                    if(chk_fst=="-"){ var bb_str=bb_str.substr(1,bb_str.length-1);  
                       var chk_point =1;}
        var bb_str = m_mtx_str_element_shift(bb_str,-dd_e);     
                    if(chk_point==1){ var bb_str="-"+bb_str;}   
          var e_nub = aa_e;           
                                                    }   

      if(dd_e < 0  ){            
            var dd_e_s = dd_e.toString().trim();
             var dd_e_fst = dd_e_s.substr(0,1);
             if(dd_e_fst=="-"){ var dd_e = dd_e_s.substr(1,dd_e_s.length-1);}
                else{var dd_e = dd_e_s;}

                    aa_str =aa_str.toString().trim();
               var chk_point =0;  
               var chk_fst=aa_str.substr(0,1);
                    if(chk_fst=="-"){ var aa_str=aa_str.substr(1,aa_str.length-1);  
                       var chk_point =1;}
                var aa_str = m_mtx_str_element_shift(aa_str,-dd_e);     
                    if(chk_point==1){ var aa_str="-"+aa_str;}   
             var e_nub = bb_e;            
                                }
        if(dd_e == 0 ){        
                   var e_nub = aa_e; }
                if(aa_str==0. && aa_str.length==2){var aa_str=0;}  
      if(nubb==0){     
       var sum_st = m_mtx_real_add_bf(aa_str,bb_str);      
                 }
       else {           
       var sum_st = m_mtx_real_sub_bf(aa_str,bb_str);      
            }
         var sum_st =sum_st.toString().trim();
         var fst_n=sum_st.substr(0,1); 
            if(fst_n=="-"){ sum_st=sum_st.substr(1,sum_st.length-1);
                            var data_point=1;              }   
            else{ var data_point=0;}
         var point_n=sum_st.indexOf(".");
         var zero_n=sum_st.substr(0,1);
         var sec_n=sum_st.substr(2,1);
         var lg=sum_st.length; 
          if(point_n == 1 && zero_n==0 && sec_n==0){ var n = 1;}
          else{ var n = 0;}
           while(n > 0){                                
               sum_st = "0."+sum_st.substr(3,lg-3);
                   var point_n=sum_st.indexOf(".");
                   var zero_n=sum_st.substr(0,1);
                   var sec_n=sum_st.substr(2,1);
                   var lg=sum_st.length; 
                  if(point_n == 1 && zero_n==0 && sec_n==0){ var n = 1;}
                  else{ var n = 0;}
                  var e_nub = m_mtx_int_sub(e_nub,1);
                        }  
                  var point_n=sum_st.indexOf(".");    
                  var zero_n=sum_st.substr(0,1);
                  var sec_n=sum_st.substr(2,1);
                    if(point_n == 1 && zero_n==0 && sec_n!=0){
                           sum_st=sum_st.substr(2,1)+"."+ sum_st.substr(3,sum_st.length-3);
                         var e_nub = m_mtx_int_sub(e_nub,1);     
                                             }
              var sum_st_m_bf = m_nub_m_s(sum_st).toString();    
              var sum_st_m_bf = m_mtx_trim(sum_st_m_bf) ;   
              var sum_st_m_bf_lg = sum_st_m_bf.length;           
              var sum_st_p_bf = m_nub_p(sum_st).toString();         
              var sum_st_p_bf_lg = sum_st_p_bf.length;           
              if(sum_st_m_bf_lg>1){
                 sum_st = sum_st.substr(0,1)+"."+sum_st.substr(1,sum_st_m_bf_lg-1)+sum_st.substr(sum_st_m_bf_lg+1,sum_st_p_bf_lg);
                          var e_nub = m_mtx_int_add(e_nub,sum_st_m_bf_lg); 
                          var e_nub = m_mtx_int_sub(e_nub,1);      
                                   }
                   var sum_st = m_mtx_trim(sum_st) ;   
             if(e_nub > 0 && sum_st !=0){
                  sum_st = sum_st+"e+"+ e_nub;}   
             if(e_nub == 0 || sum_st ==0){
                  sum_st = sum_st;}
             if(e_nub < 0 && sum_st !=0 ){
                  sum_st = sum_st+"e"+ e_nub;}
             if(data_point==1){ sum_st = "-"+sum_st;}  
     return sum_st;
}



function m_str_char(str,char){   
   var str_a = str.toString().trim();
   var char_a = char.toString().trim();
   var str_lg = str_a.length;
   var char_lg = char_a.length;
   var count_a=0;
      if(str_lg < char_lg){ count_a=0 ; return count_a;}
         for(var i=0;i< (str_lg-char_lg+1) ;i++){
            var str_part = str_a.substr(i,char_lg);
                if(str_part ==char_a){ var count_a=count_a+1;}
                                                }
        return  count_a;
}

function m_mtx_dele_zero(x){  
   var xx = x;
   var xx_st = xx.toString().trim();
   var xx_st_lg = xx_st.length;   
   var pos_pot  = xx_st.indexOf(".");    
   var pos_e = xx_st.indexOf("e"); 
   var data_lst = xx_st.substr(xx_st_lg-1,1);        
   var data_nub = 1; 
      if(pos_pot !=-1 && pos_e == -1){     
            while( data_nub > 0){
             if( data_lst == 0){
                  xx_st = xx_st.substr(0,xx_st_lg-1);        
                  xx_st_lg = xx_st.length;
                  data_lst = xx_st.substr(xx_st_lg-1,1);}                  
       else{ var data_nub = 0 ;}  
                               } 
                      }
           var xx_st = m_mtx_trim(xx_st) ;   
   return xx_st;
}
function m_ln_bf(x){     
      var ans_t = 0 ;
      var ans_t1 = 0 ;
       var xx=x;
    FIX_COL=420;
   if (xx <= 99  && xx >= 1 && xx.length<=2){        
       LN2=m_fix(LN2S,FIX_COL);    
       LN3=m_fix(LN3S,FIX_COL);
       LN5=m_fix(LN5S,FIX_COL);
       LN7=m_fix(LN7S,FIX_COL);
       LN10=m_fix(LN10S,FIX_COL);  
       LN11=m_fix(LN11S,FIX_COL);  
       LN13=m_fix(LN13S,FIX_COL);
       LN17=m_fix(LN17S,FIX_COL);
       LN19=m_fix(LN19S,FIX_COL);
       LN23=m_fix(LN23S,FIX_COL);
       LN29=m_fix(LN29S,FIX_COL);
       LN31=m_fix(LN31S,FIX_COL);
       LN37=m_fix(LN37S,FIX_COL);
       LN41=m_fix(LN41S,FIX_COL);
       LN43=m_fix(LN43S,FIX_COL);
       LN47=m_fix(LN47S,FIX_COL);
       LN53=m_fix(LN53S,FIX_COL);
       LN59=m_fix(LN59S,FIX_COL);
       LN61=m_fix(LN61S,FIX_COL);
       LN67=m_fix(LN67S,FIX_COL);
       LN71=m_fix(LN71S,FIX_COL);
       LN73=m_fix(LN73S,FIX_COL);
       LN79=m_fix(LN79S,FIX_COL);
       LN83=m_fix(LN83S,FIX_COL);
       LN89=m_fix(LN89S,FIX_COL);
       LN97=m_fix(LN97S,FIX_COL);   
      if (xx == 1 &&  xx.length==1) {var ans_t = 0 ; }  
      else if (xx == 2 &&  xx.length==1) {var ans_t = LN2 ; }  
      else if (xx == 3 &&  xx.length==1) {var ans_t = LN3 ; }  
      else if (xx == 4 &&  xx.length==1) {var ans_t = m_mtx_real_add(LN2 , LN2) ; }  
      else if (xx == 5 &&  xx.length==1) {var ans_t = LN5 ; }  
      else if (xx == 6 &&  xx.length==1) {var ans_t = m_mtx_real_add(LN2 , LN3) ; }  
      else if (xx == 7 &&  xx.length==1) {var ans_t = LN7 ; }  
      else if (xx == 8 &&  xx.length==1) {var ans_t = m_mtx_real_mul(LN2 , 3) ; }  
      else if (xx == 9 &&  xx.length==1) {var ans_t = m_mtx_real_add(LN3 ,LN3)  ; }  
      else if (xx == 10 &&  xx.length==2) {var ans_t = LN10 ; }  
      else if (xx == 11 &&  xx.length==2) {var ans_t = LN11 ; }  
      else if (xx == 12 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;var ans_t = m_mtx_real_add(ans_t1 , LN3) ;  }  
      else if (xx == 13 &&  xx.length==2) {var ans_t = LN13 ; }  
      else if (xx == 14 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN7 ) ; }  
      else if (xx == 15 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN5 ) ; }  
      else if (xx == 16 &&  xx.length==2) {var ans_t = m_mtx_real_mul(LN2 ,4) ; }  
      else if (xx == 17 &&  xx.length==2) {var ans_t = LN17 ; }  
      else if (xx == 18 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN3) ;var ans_t = m_mtx_real_add(ans_t1 , LN2) ;  }   
      else if (xx == 19 &&  xx.length==2) {var ans_t = LN19; }  
      else if (xx == 20 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;var ans_t = m_mtx_real_add(ans_t1 , LN5) ;  }   
      else if (xx == 21 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN7 ) ; } 
      else if (xx == 22 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN11 ) ; }
      else if (xx == 23 &&  xx.length==2) {var ans_t = LN23; }   
      else if (xx == 24 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 , 3) ;var ans_t = m_mtx_real_add(ans_t1 , LN3) ;  }  
      else if (xx == 25 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN5 ,LN5)  ; }  
      else if (xx == 26 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 , LN13) ; }  
      else if (xx == 27 &&  xx.length==2) {var ans_t = m_mtx_real_mul(LN3 ,3)  ; } 
      else if (xx == 28 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;var ans_t = m_mtx_real_add(ans_t1 , LN7) ; }
      else if (xx == 29 &&  xx.length==2) {var ans_t = LN29; }  
      else if (xx == 30 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 , LN3) ;var ans_t = m_mtx_real_add(ans_t1 , LN5) ;  }  
      else if (xx == 31 &&  xx.length==2) {var ans_t = LN31; }  
      else if (xx == 32 &&  xx.length==2) {var ans_t = m_mtx_real_mul(LN2 ,5) ; }  
      else if (xx == 33 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 , LN11) ; }  
      else if (xx == 34 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 , LN17) ; }  
      else if (xx == 35 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN7 , LN5) ; }  
      else if (xx == 36 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ; var ans_t2 = m_mtx_real_add(LN3 ,LN3) ; var ans_t = m_mtx_real_add(ans_t1 , ans_t2) ;} 
      else if (xx == 37 &&  xx.length==2) {var ans_t = LN37; }  
      else if (xx == 38 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 , LN19) ; }  
      else if (xx == 39 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 , LN13) ; }  
      else if (xx == 40 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN5) ;} 
      else if (xx == 41 &&  xx.length==2) {var ans_t = LN41; }  
      else if (xx == 42 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN7) ;} 
      else if (xx == 43 &&  xx.length==2) {var ans_t = LN43; }  
      else if (xx == 44 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  var ans_t = m_mtx_real_add(ans_t1 , LN11) ;} 
      else if (xx == 45 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN5) ;} 
      else if (xx == 46 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN23) ; } 
      else if (xx == 47 &&  xx.length==2) {var ans_t = LN47; }  
      else if (xx == 48 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,4) ;  var ans_t = m_mtx_real_add(ans_t1 , LN3) ;} 
      else if (xx == 49 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN7 ,LN7)  ; }  
      else if (xx == 50 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN5 ,LN5) ;  var ans_t = m_mtx_real_add(ans_t1 , LN2) ;} 
      else if (xx == 51 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN17) ; } 
      else if (xx == 52 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  var ans_t = m_mtx_real_add(ans_t1 , LN13) ;} 
      else if (xx == 53 &&  xx.length==2) {var ans_t = LN53; }  
      else if (xx == 54 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN3 ,3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN2) ;} 
      else if (xx == 55 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN5 ,LN11) ; } 
      else if (xx == 56 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN7) ;} 
      else if (xx == 57 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 , LN19) ;} 
      else if (xx == 58 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 , LN29) ;} 
      else if (xx == 59 &&  xx.length==2) {var ans_t = LN59; }  
      else if (xx == 60 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  var ans_t2 = m_mtx_real_add(ans_t1 , LN3) ; var ans_t = m_mtx_real_add(ans_t2 , LN5) ;}
      else if (xx == 61 &&  xx.length==2) {var ans_t = LN61; }  
      else if (xx == 62 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 , LN31) ;} 
      else if (xx == 63 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN3) ;  var ans_t = m_mtx_real_add(ans_t1 , LN7) ;} 
      else if (xx == 64 &&  xx.length==2) {var ans_t = m_mtx_real_mul(LN2 ,6) ; }  
      else if (xx == 65 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN5 ,LN13) ; }  
      else if (xx == 66 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN2) ;  var ans_t = m_mtx_real_add(ans_t1 , LN11) ;} 
      else if (xx == 67 &&  xx.length==2) {var ans_t = LN67; }  
      else if (xx == 68 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  var ans_t = m_mtx_real_add(ans_t1 , LN17) ;} 
      else if (xx == 69 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN23) ; }  
      else if (xx == 70 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN5) ;  var ans_t = m_mtx_real_add(ans_t1 , LN7) ;} 
      else if (xx == 71 &&  xx.length==2) {var ans_t = LN71; }  
      else if (xx == 72 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,3) ;  ans_t2 = m_mtx_real_add(LN3 ,LN3) ; var ans_t = m_mtx_real_add(ans_t1 , ans_t2) ;} 
      else if (xx == 73 &&  xx.length==2) {var ans_t = LN73; }  
      else if (xx == 74 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN37) ; } 
      else if (xx == 75 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN5 ,LN5) ;   var ans_t = m_mtx_real_add(ans_t1 , LN3) ;} 
      else if (xx == 76 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;   var ans_t = m_mtx_real_add(ans_t1 , LN19) ;} 
      else if (xx == 77 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN7 ,LN11) ; } 
      else if (xx == 78 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN3) ; var ans_t = m_mtx_real_add(ans_t1 ,LN13) ;} 
      else if (xx == 79 &&  xx.length==2) {var ans_t = LN79; }  
      else if (xx == 80 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,4) ;   var ans_t = m_mtx_real_add(ans_t1 , LN5) ;}
      else if (xx == 81 &&  xx.length==2) {var ans_t = m_mtx_real_mul(LN3 ,4)  ; }  
      else if (xx == 82 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN41)  ; }  
      else if (xx == 83 &&  xx.length==2) {var ans_t = LN83; }  
      else if (xx == 84 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  ans_t2 = m_mtx_real_add(ans_t1 ,LN3) ; var ans_t = m_mtx_real_add(ans_t2 , LN7) ;} 
      else if (xx == 85 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN5 ,LN17) ; } 
      else if (xx == 86 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN43) ;  } 
      else if (xx == 87 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN29) ;  } 
      else if (xx == 88 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,3) ;  ans_t = m_mtx_real_add(ans_t1 ,LN11) ; } 
      else if (xx == 89 &&  xx.length==2) {var ans_t = LN89; }  
      else if (xx == 90 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN3) ;  ans_t2 = m_mtx_real_add(ans_t1 ,LN2) ; var ans_t = m_mtx_real_add(ans_t2 , LN5) ;} 
      else if (xx == 91 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN7 ,LN13) ;  } 
      else if (xx == 92 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN2 ,LN2) ;  ans_t = m_mtx_real_add(ans_t1 ,LN23) ; } 
      else if (xx == 93 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN3 ,LN31) ;  } 
      else if (xx == 94 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN2 ,LN47) ;  } 
      else if (xx == 95 &&  xx.length==2) {var ans_t = m_mtx_real_add(LN5 ,LN19) ;  } 
      else if (xx == 96 &&  xx.length==2) {var ans_t1 = m_mtx_real_mul(LN2 ,5) ;  ans_t = m_mtx_real_add(ans_t1 ,LN3) ; } 
      else if (xx == 97 &&  xx.length==2) {var ans_t = LN97; }  
      else if (xx == 98 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN7 ,LN7) ;  ans_t = m_mtx_real_add(ans_t1 ,LN2) ; } 
      else if (xx == 99 &&  xx.length==2) {var ans_t1 = m_mtx_real_add(LN3 ,LN3) ;  ans_t = m_mtx_real_add(ans_t1 ,LN11) ; } 
      else {var ans_t =x; }
    
  
      }
     return ans_t;
   }
function m_ln(x){           
 var xx = x.toString().trim();
 var data_msg =0;
 var data_msg =  m_str_char(xx,"Msg") ;  
    if(data_msg >=1){ var ans_a = xx ; return  ans_a ;}
 var xx = m_str_e_to_str_point(xx );  
 var ans_0=0;                  
  if (xx <= 99  && xx.length<=2 && xx !=0){  
     var ans_0 = m_ln_bf(x);
     return ans_0;
   } 
 var xx_e = m_mtx_str_to_e(xx);
  var xx_e = m_mtx_str_to_e_a(xx_e);
  var nub_x = m_str_power(xx_e ,0); 
  var xx_e_st = m_str_power(xx_e ,1); 
  var xx_e_st_fst=xx_e_st.substr(0,1);  
  var  data_xx_comp_0 = m_mtx_real_str_comp(xx_e_st,0);    
      if ( data_xx_comp_0 == 3){ var ans_t = message_1(13) ;  return ans_t;}
      if (xx_e_st_fst == "-") {  var ans_t = message_1(5); return ans_t;} 
      if( xx_e_st.length ==1){    
    var ans_t = m_ln_bf(xx_e_st); 
    var ans_1 = m_mtx_real_mul(nub_x , LN10S) ;
    var ans_0= m_mtx_real_add(ans_t , ans_1) ;
    return ans_0;}
   if( xx_e_st.length ==3){   
     var xx_t= xx_e_st;
     var xx_t = xx_t.replace(/\./g , "");    
     var ans_t = m_ln_bf(xx_t); 
     var nub_x = m_mtx_real_sub(nub_x , 1) ;     
     var ans_1 = m_mtx_real_mul(nub_x , LN10S) ;
     var ans_0= m_mtx_real_add(ans_t , ans_1) ;
          return ans_0; }
  var sum_tt_1 = m_mtx_real_mul(nub_x , LN10S) ; 
  if (xx_e_st == 1  && nub_x !=0) {  var ans_t = sum_tt_1 ; return ans_t;}
  var nub_ln10=0;
  var xx_st=xx_e_st;
  var sum_tt = 0 ;
  var data_com = 0;
  var data_com_pow=0 ;
  var xx_st =m_fix(xx_st,30);
  var j_nub = 53;
 for(var j=0;j<j_nub;j++){ 
    if(j==0){var data_com = "7.9432823473" ;var data_com_pow=0.9;} 
    else if(j==1){var data_com = "6.3095734449" ;var data_com_pow=0.8;}   
    else if(j==2){var data_com = "5.0118723363" ;var data_com_pow=0.7;}  
    else if(j==3){var data_com = "3.9810717056" ;var data_com_pow=0.6;} 
    else if(j==4){var data_com = "3.1622776602" ;var data_com_pow=0.5;}  
    else if(j==5){var data_com = "2.5118864316" ;var data_com_pow=0.4;} 
    else if(j==6){var data_com = "1.9952623150" ;var data_com_pow=0.3;}  
    else if(j==7){var data_com = "1.5848931925" ;var data_com_pow=0.2;} 
    else if(j==8){var data_com = "1.2589254118" ;var data_com_pow=0.1;} 
    else if(j==9){var data_com = "1.2302687709" ;var data_com_pow=0.09;} 
    else if(j==10){var data_com = "1.2022644347" ;var data_com_pow=0.08;}    
    else if(j==11){var data_com = "1.1748975550" ;var data_com_pow=0.07;} 
    else if(j==12){var data_com = "1.1481536215" ;var data_com_pow=0.06;}    
    else if(j==13){var data_com = "1.1220184544" ;var data_com_pow=0.05;} 
    else if(j==14){var data_com = "1.0964781962" ;var data_com_pow=0.04;}    
    else if(j==15){var data_com = "1.0715193053" ;var data_com_pow=0.03;} 
    else if(j==16){var data_com = "1.0471285481"  ;var data_com_pow=0.02;}    
    else if(j==17){var data_com = "1.0232929923" ;var data_com_pow=0.01;} 
    else if(j==18){var data_com = "1.0209394838" ;var data_com_pow=0.009;}    
    else if(j==19){var data_com = "1.0185913881" ;var data_com_pow=0.008;}  
    else if(j==20){var data_com = "1.0162486929" ;var data_com_pow=0.007;}    
    else if(j==21){var data_com = "1.0139113858" ;var data_com_pow=0.006;} 
    else if(j==22){var data_com = "1.0115794543" ;var data_com_pow=0.005;}    
    else if(j==23){var data_com = "1.0092528861" ;var data_com_pow=0.004;}  
    else if(j==24){var data_com = "1.0069316689" ;var data_com_pow=0.003;}    
    else if(j==25){var data_com = "1.0046157903"  ;var data_com_pow=0.002;} 
    else if(j==26){var data_com = "1.0023052381" ;var data_com_pow=0.001;} 
    else if(j==27){var data_com = "1.0020744754" ;var data_com_pow=0.0009;} 
    else if(j==28){var data_com = "1.0018437658" ;var data_com_pow=0.0008;}   
    else if(j==29){var data_com = "1.0016131093" ;var data_com_pow=0.0007;}  
    else if(j==30){var data_com = "1.0013825059" ;var data_com_pow=0.0006;}    
    else if(j==31){var data_com = "1.0011519556" ;var data_com_pow=0.0005;} 
    else if(j==32){var data_com = "1.0009214584" ;var data_com_pow=0.0004;}    
    else if(j==33){var data_com = "1.0006910142" ;var data_com_pow=0.0003;} 
    else if(j==34){var data_com = "1.0004606231" ;var data_com_pow=0.0002;}    
    else if(j==35){var data_com = "1.0002302851" ;var data_com_pow=0.0001;} 
    else if(j==36){var data_com = "1.0002072542" ;var data_com_pow=0.00009;}    
    else if(j==37){var data_com = "1.0001842238" ;var data_com_pow=0.00008;} 
    else if(j==38){var data_com = "1.0001611940" ;var data_com_pow=0.00007;}    
    else if(j==39){var data_com = "1.0001381647" ;var data_com_pow=0.00005;}  
    else if(j==40){var data_com = "1.0000921077" ;var data_com_pow=0.00004;}    
    else if(j==41){var data_com = "1.0000690800" ;var data_com_pow=0.00003;} 
    else if(j==42){var data_com = "1.0000460528" ;var data_com_pow=0.00002;}    
    else if(j==43){var data_com = "1.0000230262"  ;var data_com_pow=0.00001;}    
    else if(j==44){var data_com = "1.0000207235" ;var data_com_pow=0.000009;}    
    else if(j==45){var data_com = "1.0000184209" ;var data_com_pow=0.000008;} 
    else if(j==46){var data_com = "1.0000161183" ;var data_com_pow=0.000007;}    
    else if(j==47){var data_com = "1.0000138157" ;var data_com_pow=0.000006;} 
    else if(j==48){var data_com = "1.0000115130" ;var data_com_pow=0.000005;}    
    else if(j==49){var data_com = "1.0000092104" ;var data_com_pow=0.000004;}  
    else if(j==50){var data_com = "1.0000069078" ;var data_com_pow=0.000003;}    
    else if(j==51){var data_com = "1.0000046052" ;var data_com_pow=0.000002;} 
    else if(j==52){var data_com = "1.0000023026" ;var data_com_pow=0.000001;}    
     var data_xx_st_comp_data_com = m_mtx_real_str_comp(xx_st,data_com);    
      if(data_xx_st_comp_data_com != 2){
        var xx_st =m_fix(xx_st,30); 
        var xx_st=m_mtx_real_div(xx_st,data_com); 
        var nub_ln10 = m_mtx_real_add(nub_ln10 , data_com_pow) ; }
            }
     var sum_tt = m_mtx_real_mul(nub_ln10 , LN10S) ; 
     var nub_ln10_base = nub_ln10 * 1000000;  
     var nub_ln10_base = m_fix(nub_ln10_base,1);
     var ref_base = "1.00000230258774394513560298054590000979265047811516637709801718803137379438867535617872382770708456851581781528299306462248848287512593302006538358768364518990914280726036967827448342985608906902377442237120216711653322201361567414926551527783935691847429508165496075663995499749224785486896918174954430834442564827540307568003828150817523046324283509605714244376734907329486197608327203657860883173591522916250724509339974142024168010661599687279855605205109416594146941978472695783341088017897255575";
     var data_xx_i = m_pow(ref_base,-nub_ln10_base);   
      var xx_st_1 = m_mtx_real_mul(xx_e_st , data_xx_i) ;   
      var xx_st_1 = m_str_e_to_str(xx_st_1);   
      var sum_tt_s = m_ln_matrix(xx_st_1);             
      var total = m_mtx_real_add(sum_tt , sum_tt_s) ;
      var total_s = m_mtx_real_add(sum_tt_1 , total) ;
   return  total_s ;
}

function m_ln_matrix(x){          
 var zz = x.toString().trim();
 var zz = "0."+ zz.substr(2,zz.length-2); 
  var nub_fix =10; 
 if( DECI_DGT <=16){
    var BB = m_mtx_unit_inv_lg_100_table_a(); }
    else{ var BB = m_mtx_unit_inv_lg_100_table();
        var nub_fix = 50 ; }       
 var AA  = m_str_to_mtx(zz) ;   
   
    for(var i = 1 ; i <nub_fix ; i++){              
       var BB_i = m_mtx_row_table(BB,i);               
          if(i ==1){                         
            var SS = AA;     
            var XX = AA; 
                     }
          else{
            var XX  =  m_mtx_point_mul(XX,AA);              
            var XXI = m_mtx_point_mul(XX,BB_i);    
            var test_nb = i%2;
            if(test_nb ==0){
                 var SS =  m_mtx_point_sub(SS,XXI);}
            else{var SS =  m_mtx_point_add(SS,XXI);}
                        } } 
            var SS = m_mtx_cell_five(SS);     
            var sum_total = m_mtx_cell_five_show(SS);
                  return  sum_total ;   
   }



function m_s_e(x,nub){       
  var xx=x.toString().trim();
    var xx_st= m_mtx_str_to_e(xx); 
    var xx_st= m_mtx_str_to_e_a(xx);             
    var pos_pot  = xx_st.indexOf(".");    
    var pos_e  = xx_st.indexOf("e");       
    var pos_fst  = xx_st.substr(0,1);   
    var pos_sec  = xx_st.substr(1,1);   
    var sum_tt =0;
    var nub_e=0;
        if(  pos_e != -1){      
          var nub_e =  xx_st.substr(pos_e+1,xx_st.length - pos_e); 
          var nub_e_fst  = nub_e.substr(0,1);
            if(nub_e_fst=="+"){ var nub_e = nub_e.substr(1,nub_e.length-1);}
            else{  var nub_e = nub_e ;}
               xx_st = xx_st.substr(0,pos_e);       
                       }
    var e_nub_point=0;      
    var e_point=0;  
    var st_point=0;  
    var st_e_point=0;  
    var e_nub_point= m_str_char(nub_e,".") ;  
    var e_point= m_str_char(nub_e,"e") ;       
    var st_nub_point= m_str_char(xx_st,".") ;  
    var st_e_point= m_str_char(xx_st,"e") ;    
    var ans_1 ="";
        if( e_nub_point >=2 || e_point >=2 ||st_nub_point>=2 || st_e_point>=2 ){
             var ans_1 = message_1(30);
                           return  ans_1  }
        if(nub==0){ var sum_tt=xx_st;}
        else {var sum_tt = nub_e;} 
 return sum_tt ;

}

function m_s_e_ln(x,nub){       
 var xx = x.toString().trim();
 var xx =m_mtx_trim(xx) ;         
 var nub_a=nub;
 var nub_e=0;
 var sum_tt=0;
 var ans_a="";
    if(pos_fst =="0" && pos_sec  !="."){    
                 var flag=1;
                  while(flag >0){
                    xx=xx.substr(1,xx.length-1);   
                     var pos_fst  = xx.substr(0,1);      
                     var pos_sec  = xx.substr(1,0); 
                            if(pos_fst =="0" && pos_sec  !="."){
                                var flag=1;}
                            else{ var flag=0;}
                                }  
                      }
 
      var xx_fst=xx.substr(0,1);
      var data_comp_xx_1   =  m_mtx_real_str_comp(xx,1);       
      var data_comp_xx_0   =  m_mtx_real_str_comp(xx,0); 
    if ( data_comp_xx_1 == 3){ var sum_tt = 0 ; return sum_tt; }   
    if ( data_comp_xx_0 ==3 ){ var sum_tt = message_1(13); return sum_tt; }
    if ( xx_fst =="-" ) { var sum_tt = message_1(5); return sum_tt; }
    var pos_e0  = xx.indexOf("e");    
    if(  pos_e0 == -1){ 
     var  xx= m_mtx_str_to_e(xx); }
      var pos_e  = xx.indexOf("e");    
      var pos_fst  = xx.substr(0,1);   
      var pos_sec  = xx.substr(1,1); 
   if(  pos_e != -1){ 
      var nub_e =  xx.substr(pos_e+1,xx.length - pos_e); 
      var nub_e =  m_mtx_trim(nub_e) ;         
      var    xx = xx.substr(0,pos_e);       
                     }
      var data_point_nb = 1; 
      var data_point_nb = m_str_char(xx,".");              
      if( data_point_nb ==0){  var     xx = xx+".0" ;} 
      var point_bfa = 0;                                    
      var point_afa = 0;
      var point_bfa = m_str_char(xx,".");         
      var point_afa = m_str_char(nub_e,".") ;  
           if((point_bfa >=2 )||(point_afa >=2 )) {   
              var ans_1 = message_1(30);
                           return  ans_1  ;
                                         } 
      
           if(point_afa ==1){                
             var nub_ee =  nub_e.toString() ;  
             var pos_nub_e  = nub_ee.indexOf("."); 
             var nub_e = nub_ee.substr(0,pos_nub_e); 
             var nub_e_af =nub_ee.substr(pos_nub_e+1,nub_ee.length-pos_nub_e-1);   
             var nub_e_af_fst = nub_ee.toString().substr(0,1);
                  if( nub_e_af_fst =="-"){
                     var nub_e_af ="-0."+nub_e_af.toString();}     
                   else{  var nub_e_af ="0."+ nub_e_af.toString(); } 
             var nub_e_af_val = m_pow(10,nub_e_af);
             var xx = m_mtx_real_mul(xx,nub_e_af_val);      
               }     
      var pos_pot  = xx.indexOf(".");   
      var xx_m_bf ="";
      var xx_p_bf ="";
       if( pos_pot  !=-1){
        var xx_m_bf = xx.substr(0,pos_pot);        
        var xx_m_bf_lg = xx_m_bf.length;           
        var xx_p_bf = xx.substr(pos_pot+1,xx.length-pos_pot);   
        var xx_p_bf_lg = xx_p_bf.length;                     
                   }
      if(xx_m_bf !=0 && xx_m_bf !="" ){              
       xx = "0"+"."+xx_m_bf.substr(0,xx_m_bf_lg)+xx.substr(xx_m_bf_lg+1,xx.length-xx_m_bf_lg-1);    
       var nub_e= m_mtx_real_add(nub_e , xx_m_bf_lg); } 
        if(st_fst =="0" && st_sec =="." && st_tri =="0" && parseFloat(xx_p_bf) >0 ){      
          var flag_a=1;
               while(flag_a > 0){
                xx = "0."+ xx.substr(3,xx.length-3);   
                var nub_e=m_mtx_real_sub(nub_e,1);    
                  var st_fst = xx.substr(0,1);       
                  var st_sec = xx.substr(1,1);       
                  var st_tri = xx.substr(2,1);         
                       if(st_fst ==0 && st_sec =="." && st_tri ==0 ){
                            var flag_a=1;}
                         else{ var flag_a=0;}
                               }  
                }

      if(nub_a==0){
          return xx ;}        
      if (nub_a==1){
         var nub_e = m_fix_pow_lst(nub_e);    
          return nub_e ;}   //power
      if ((nub_a==2)&&(nub_e <0 )){
           var ans_a= xx.toString() +"e"+ nub_e.toString();
           return ans_a ;} 
       if ((nub_a==2)&&(nub_e >0 )){
           var ans_a= xx.toString() +"e+"+ nub_e.toString();
           return ans_a ;}
       if ((nub_a==2)&&(nub_e ==0 )){
           var ans_a= xx.toString() ;
           return ans_a ;}   
     var ans_a= "no";                                 
           return ans_a ;
  
  }



function m_log(x){      
   var xx=x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;} 
   var  nub_e_str =0;
   var  xx_str ="";
   var  nub_e_str =  m_s_e(xx ,1);         
   var  xx_str =  m_s_e(xx ,0);         
   var  xx = xx_str;  
    var xx = m_str_e_to_str(xx);      
    var xx_fst=xx.substr(0,1);
    var xxabs = xx;
    var ans_t = 0;
    var  data_xxabs_comp_0 = m_mtx_real_str_comp(xxabs,0);    
      if ( data_xxabs_comp_0 == 3){ var ans_t = message_1(14) ;  return ans_t;} 
      if (xx_fst == "-") {  var ans_t = message_1(9); return ans_t;} 
      if (xxabs == 1 && xxabs.length==1 && nub_e_str==0) {  var ans_t = 0 ; return ans_t;}
     var xxabs = m_mtx_str_to_e(xxabs);     
     var  nub_e = 0;
     var  xxabs_s =  m_s_e(xxabs ,0);       
     var  nub_e =  m_s_e(xxabs ,1);
     var  nub_e =  m_mtx_real_add(nub_e, nub_e_str); 
     if ( xxabs_s == 1 ) {  var ans_t = nub_e ; return ans_t;}
     var data_y = m_ln(xxabs_s);   
     
     var data_x = LN10; 
     if( DECI_DGT <=16){ var deci_nub=75;} 
     else { var deci_nub=250;}
     var data_x=m_fix(data_x,deci_nub);   
     var data_y=m_fix(data_y,deci_nub);
     var ans_t =  m_mtx_real_div(data_y,data_x);
     var ans_t=m_fix(ans_t,deci_nub);
      var ans_t =  m_mtx_real_add(ans_t,nub_e);
     var ans_t=m_fix(ans_t,deci_nub);
     var ans_t = ans_t.toString().trim();
  return ans_t;
}



function m_pow_ia(base,p){    
   var bb=base;
      bb = m_str_e_to_str(bb);      
   var pp= p;
      pp = m_str_e_to_str(pp).trim();      
   var pp_fst = pp.substr(0,1); 
    if(pp_fst=="-"){ var pp = pp.substr(1,(pp.length-1));}     
    var ans_1=""; 
    var data_a = 1;
          for(var i=0; i<pp ;i++){
                      var data_a = m_mtx_real_mul(data_a ,bb); 
                                           }
    var ans_1= data_a ;   
    if(pp_fst=="-") { var ans_1 = m_mtx_real_div(1 ,ans_1 );}
 return ans_1;
}


function m_pow_ib(base,p){     
    var base =m_mtx_trim(base) ;           
    var pp= p.toString().trim();
    var bb=base.toString().trim();  
    var bb = m_str_e_to_str(bb);    
    var pp = m_str_e_to_str(pp).trim();      
    var pp_fst = pp.substr(0,1); 
    if(pp_fst=="-"){ var pp = pp.substr(1,(pp.length-1));}      
    var pp_r = 0;  
    var ans_1="";
    var pp_lg = pp.length;
    var row_nub_t = m_mtx_real_mul(pp_lg,3.5) ; 
    var row_nub_t = m_nub_m(row_nub_t) ;       
    var row_nub_t =parseInt(row_nub_t)+2;   
    var AA = m_pow_ib_bf(row_nub_t);  
    var data_a = 1;
    var data_p_b=0;   
    var data_p_a=0;   
    var data_pp = pp;
               for(var i=0; i< data_pp ;i++){
                     var data_a = m_mtx_real_mul(data_a ,data_a);    
                          if(i==0){ var data_a = bb ;}
                            data_a = m_mtx_str_to_e_a(data_a);         
                            data_a = m_fix(data_a ,FIX_COL);            
                         AA[i][1] = data_a ;                        
                           var data_p_a= AA[i][0];                    
                           var data_p_b= AA[i+1][0];                   
                           var data_cp =  m_mtx_real_str_comp(data_p_b,pp);      
                               if(data_cp ==1 ){     
                                   var data_pp = -1 ;
                                             }   
                                           }   
                   var pp_r = m_mtx_real_sub(pp ,data_p_a);
                   var pp_r_lg = pp_r.length;              
                   var idx_e = pp_r.indexOf("e");
                   var idx_point = pp_r.indexOf(".");
                     if(idx_e !=0){ pp_r_lg_a = m_mtx_int_sub(idx_e,idx_point);}
                     else{ pp_r_lg_a = m_mtx_int_sub(pp_r_lg,idx_point);}
                  var pp_r_rf =0;
                  if(pp_r_lg >=250){ var pp_r_rf = m_mtx_int_sub(pp_r_lg_a,10); }           
                   else{var pp_r_rf = m_mtx_int_sub(pp_r_lg_a,1); }
                  var pp_r =m_fix(pp_r,pp_r_rf); 
                  var pp_r = m_str_e_to_str(pp_r);      
                   var data_b=1;
                   var aa_lga = AA.length;
                   var aa_lg = m_mtx_int_sub(aa_lga,1) ;  
                   var aa_lg = m_str_e_to_str(aa_lg); 
                   var pp_r = m_str_e_to_str(pp_r); 
                 while( pp_r >0 ){
                   for(var i= aa_lg ;i >= 0 ;i--){
                        var data_aa_0 = AA[i][0];           
                        var data_cp_0 =  m_mtx_real_str_comp(pp_r,data_aa_0);     
                        var data_aa_1 = AA[i][1];
                        var data_cp_1 =  m_mtx_real_str_comp(data_aa_1,0);      
                      if( data_cp_0!=2  && data_cp_1!=3){    
                        var data_b= m_mtx_real_mul(data_b,AA[i][1]) ;
                         var pp_r = m_mtx_int_sub(pp_r,AA[i][0]);
                                     
                                    if( pp_r == 0){ var i=-1 ;} 
                                                      } 
                                                  }     
                                      }   
     var ans_1= m_mtx_real_mul(data_a ,data_b );
     var ans_1 = ans_1.toString();  
     if(pp_fst=="-") { 
          var ans_1 =m_fix(ans_1,FIX_COL);   
          var ans_1 = m_mtx_real_div(1 ,ans_1 );}
 return ans_1;
}

function m_pow_ib_bf(n){        
var nn=n;
   A = m_new_zero_mtx(nn,2);      
         A[0][1] = 0;  
         A[1][1] = 1;  
   for(var i=0;i<nn ;i++){
    if(i==0){ var data_a = 1;
              A[i][0] = data_a;  }
    else{
     var data_a = m_mtx_real_add(data_a,data_a );   
        data_a = m_str_e_to_str(data_a);      
        A[i][0] = data_a;
        A[i][1] = 0;
        }
                           }  
   return A;

}


function m_pow_ic(base,p){    
    var bb=base;
        bb = m_str_e_to_str(bb).trim();      
   var pp= p;
       pp = m_str_e_to_str(pp).trim();      
   var pp_lg = pp.length;
   var pp_lst = pp.substr((pp_lg-1),1);  
   var pp_fst = pp.substr(0,1); 
     if(pp_fst=="-"){ var pp = pp.substr(1,(pp.length-1));}     
      var ans_1 =1;
      var data_ln_a =0;
      var data_ln_b =0;
      var ppp = m_nub_p(pp) ;       
      var ppp_lg = ppp.length;
      var data_ln_a = m_ln(bb);   
      var data_ln_b = m_mtx_real_mul(ppp ,data_ln_a);      
      var data_ln_b = m_str_e_to_str(data_ln_b).trim();      
      var ans_1 =  m_exp(data_ln_b);          
    if(pp_fst=="-") { var ans_1 = m_mtx_real_div(1 ,ans_1 );}
return ans_1;
}


function m_pow_ie(base,p){   
    var bb=base;
        bb = m_str_e_to_str(bb).trim();      
    var bb_fst = bb.substr(0,1); 
     if(bb_fst=="-"){ var bb = bb.substr(1,(bb.length-1));}   
      var pp= p;
          pp = m_str_e_to_str(pp).trim();      
      var pp_lg = pp.length;
      var pp_lst = pp.substr((pp_lg-1),1);  
      var pp_fst = pp.substr(0,1); 
     if(pp_fst=="-"){ var pp = pp.substr(1,(pp.length-1));}   
       var ans_1 =1;
       var data_ln_a =0;
       var data_ln_b =0;
       var data_a = 1;
       var data_b = 1;
       var pp_r = 0 ;
       var ppi = m_nub_m(pp) ;       
           ppi = m_str_e_to_str(ppi).trim();      
       var ppi_lg = ppi.length;  
       var ppp = m_nub_p(pp) ;       
       var ppi_lg = ppi.length;
       var ppp_lg = ppp.length;
             if( ppi==0 && ppp==0 && ppp_lg <=1){ var data_a=1;}
             if( ppi==1 && ppp==0 && ppp_lg <=1){ var data_a=bb;}  
             if(ppi_lg < 3 && ppi_lg >=1 && ppi!=0 && ppi !=-0  ){    
               var data_a = m_pow_ia(bb ,ppi) ;    
                       }
          if(ppi_lg >= 3  ){
               var data_b = m_pow_ib(bb ,ppi) ;     
                       } 
      var data_ln_a = m_ln(bb);  
      var data_ln_b = m_mtx_real_mul(ppp ,data_ln_a);     
      var data_ln_b = m_str_e_to_str(data_ln_b).trim();      
      var ans_1 =  m_exp(data_ln_b);         
            if(ppi_lg < 3 && ppi_lg >=1 && ppi!=0 && ppi !=-0 ){   
              var ans_t = m_mtx_real_mul(data_a ,ans_1);
                          }
           else if(ppi_lg >= 3  ){
             var ans_t = m_mtx_real_mul(data_b ,ans_1);            
                 }
           else { var ans_t = ans_1 ;}                           
       var ans_t = m_fix_pow(ans_t,10);  
        if(pp_fst=="-") { var ans_t = m_mtx_real_div(1 ,ans_t );}
        if(bb_fst=="-" && ppp==0 && (pp_lst==1 ||pp_lst==3 || pp_lst==5 ||pp_lst==7 ||pp_lst==9 )) {
              ans_t ="-"+ans_t ;}  
return ans_t;
}


function m_pow(base,p){    
    var base= base.toString().trim();
    var base =m_mtx_trim(base) ;         
    var  p= p.toString().trim();
    var base_msg = m_mtx_test_msg(base);     
    var p_msg = m_mtx_test_msg(p);
        if(base_msg !=-1 ){ return base;}     
        if(p_msg !=-1 ){ return p;} 
     var datalg = "1e+201";                
     var datalg_n = "-1e+201";
     var p_comp_datalg  =  m_mtx_real_str_comp(p,datalg);      
     var p_comp_datalg_n  =  m_mtx_real_str_comp(p,datalg_n);           
         if( p_comp_datalg ==1 || p_comp_datalg_n ==2 ){
           var ans_1 = message_1(36);
                           return  ans_1  } 
      var nub_point_p=0;  
      var nub_point_p= m_str_char(p,".") ;  
      var ans_1 ="";
          if( nub_point_p >2){
              var ans_1 = message_1(30);
                           return  ans_1  }
         else{ p=p;}
      var p =m_mtx_trim(p) ;         
      var base_msg = m_mtx_test_msg(base);
      var p_msg = m_mtx_test_msg(p);
        if(base_msg !=-1 ){ return base;}     
        if(p_msg !=-1 ){ return p;}
   var bb=base;
   var pp=p;
   var ans_1="";
     bb = m_str_e_to_str(bb);      
     pp = m_str_e_to_str(pp);      
   var ppi = m_nub_m(pp) ;      
        data_pp_ppi = m_mtx_real_str_comp(pp,ppi);      
      if(data_pp_ppi !=3){
         var ppp = m_nub_p(pp) ;   
                       }
       else{ var ppp =0;}
       var bb = bb.toString().trim();
       var bb = m_mtx_trim(bb) ;   
       var bb_lg =bb.length;
       var data_comp_bb_1   =  m_mtx_real_str_comp(bb,1);      
       var data_comp_bb_0   =  m_mtx_real_str_comp(bb,0); 
       var data_comp_pp_0   =  m_mtx_real_str_comp(pp,0);
       var data_comp_ppp_0   =  m_mtx_real_str_comp(ppp,0);
       var data_comp_ppi_0   =  m_mtx_real_str_comp(ppi,0);
   if(data_comp_bb_1==3 ){ var ans_1=1;  return ans_1; }            
   if(bb!=0 && data_comp_pp_0 == 3) {var  ans_1=1; return ans_1;  }
   if(data_comp_bb_0==3 && data_comp_pp_0==1) { var ans_1=0; return ans_1;  }
   if(data_comp_bb_0==3 && data_comp_pp_0==2) { var ans_1=message_1(28); return ans_1; }
   if(data_comp_bb_0==3 && data_comp_pp_0 ==3) { var ans_1=message_1(28); return ans_1; }
   if(bb < 0 && ppp !=0 && data_comp_ppp_0 !=3) { var ans_1=message_1(6) ; return ans_1; }
          var pa_fst = pp.substr(0,1); 
        if(( data_comp_ppp_0 == 3 && pp.length <3  && pa_fst !="-" )||( data_comp_ppp_0 == 3 && pp.length < 4  && pa_fst =="-")){          
              var ans_1 = m_pow_ia(bb,pp);
            }
          if(( data_comp_ppp_0 == 3 && pp.length >=3 && pa_fst !="-")||( data_comp_ppp_0 == 3 && pp.length >= 4  && pa_fst =="-" )){          
            var ans_1 = m_pow_ib(bb,pp);
                  }
          if( data_comp_ppp_0 != 3 && data_comp_ppi_0 ==3){   
                var ans_1 = m_pow_ic(bb,pp);
           }
          if( data_comp_ppp_0 != 3 && data_comp_ppi_0 !=3){   
             var ans_1 = m_pow_ie(bb,pp);
             }
         var ans_1 = ans_1.toString().trim();
            return ans_1;
     
}


function m_asin(x){                                              
  var zz = x.toString().trim();
  var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
  var zz = m_str_e_to_str_point(zz ); 
  var zz = m_fix(zz,FIX_COL) ;  
  var xx_test_small = m_mtx_str_to_e_a(zz);               
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
          var ans_a=x ; return  ans_a;} 
  if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
       var ans_a= message_1(1);  return ans_a;}
   var flag_a=0;
   var flag_b=0;
   var sum_total="";
   var zz_fst=zz.substr(0,1);
   if(zz_fst=="-"){
      var zz = zz.substr(1,zz.length-1);
      var flag_a=1; }                            
   else{ zz=zz;}
   var data_comp_zz_1   =  m_mtx_real_str_comp(zz,1);       
      var data_comp_zz_0   =  m_mtx_real_str_comp(zz,0); 
      if(data_comp_zz_1 ==1 ) {  var ans_1= message_1(1);  return ans_1; }     
      if(data_comp_zz_0 ==3 ){ ans_1 = 0 ; return ans_1 ;}                    
      if(data_comp_zz_1 ==3   ){ ans_1 = PIDIV2 ; 
                  if(zz_fst=="-"){ ans_1 = "-"+ans_1;} 
                                   return ans_1   ;}
    var zz = m_str_e_to_str(zz);                     
    var zz =m_fix(zz,FIX_COL);   
    var data_a=m_mtx_int_mul(zz,zz);
    if( DECI_DGT <=16){ var deci_nub=75;} 
     else { var deci_nub=250;}
     var data_b=m_mtx_real_sub(1,data_a);
  
     var data_b =m_fix(data_b,deci_nub);
     var data_c=m_pow(data_b,0.5);
     var data_c =m_fix(data_c,deci_nub);
     var data_d=m_mtx_real_add(1,data_c);
     var data_d =m_fix(data_d,deci_nub);
     var data_e=m_mtx_real_div(zz,data_d);
     var data_e =m_fix(data_e,deci_nub); 
     var data_sum = m_atan(data_e); 
     var data_sum =m_fix(data_sum,deci_nub);
     var data_sum_t = m_mtx_real_add(data_sum,data_sum);
      if(flag_a ==1){    
         var data_sum_t = "-"+ data_sum_t;     
                           }  
 
    return data_sum_t ; 
}


function m_acos(x){                   
   var xx = x.toString().trim();
   var data_msg =0;
  var ans_a="";
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
  var xx = m_str_e_to_str_point(xx );
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);  
       PIDIV2 =m_fix(PIDIV2,FIX_COL);
    if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
       var ans_a=PIDIV2 ; return  ans_a;} 
  if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
      var ans_a= message_1(2);  return ans_a;}
   var xx =m_mtx_trim(xx) ;         
   var xx_fst = xx.substr(0,1);
     if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
     else { var xx=xx;}     
       xx = m_str_e_to_str(xx);      
   var ans_1=0;
   var data_comp_xx_0   =  m_mtx_real_str_comp(xx,0); 
   var data_comp_xx_1   =  m_mtx_real_str_comp(xx,1);      
   var data_comp_x_1    =  m_mtx_real_str_comp(x,1); 
   var data_comp_x_n1   =  m_mtx_real_str_comp(x,-1);
     if( data_comp_xx_1==1){  var ans_1= message_1(2);  return ans_1; }   
     if( data_comp_xx_0==3 ){ ans_1 = PIDIV2 ; return ans_1 ;}                    
     if( data_comp_xx_1== 3 && data_comp_x_1 == 3 ){ ans_1 = 0 ; return ans_1   ;}  
     if( data_comp_xx_1== 3 && data_comp_x_n1==3  ){ ans_1 = PI ;  return ans_1  ;}  
   var ans_0=0;
   if(xx_fst=="-"){ var xx="-"+xx ;}   
   if( DECI_DGT <=16){ var deci_nub=75;} 
     else { var deci_nub=250;}
    var data_a=m_mtx_int_mul(xx,xx);
    var data_a =m_fix(data_a,deci_nub);
    var data_b=m_mtx_real_sub(1,data_a);
     var data_b =m_fix(data_b,deci_nub);
     var data_c=m_pow(data_b,0.5);
   var data_c =m_fix(data_c,deci_nub);
    var data_d=m_mtx_real_add(1,xx);
    var data_d =m_fix(data_d,deci_nub); 
    var data_e=m_mtx_real_div(data_c,data_d);
    var data_e =m_fix(data_e,deci_nub);
    var ans_0 = m_atan(data_e); 
    var ans_0 =m_fix(ans_0,deci_nub);
    var ans_1=m_mtx_real_add(ans_0 ,ans_0);        
    return ans_1 ; 
}


function m_atan(x){                   
   var xx = x.toString().trim();
   PIDIV2=m_fix(PIDIV2,FIX_COL);  
   PIDIV4=m_fix(PIDIV4,FIX_COL);
   var data_msg = 0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
   var xx =m_mtx_trim(xx) ; 
  var xx = m_str_e_to_str_point(xx ); 
  var xx = m_mtx_str_to_e_a(xx);
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
          var ans_a=xx ; return  ans_a;} 
   var xx_fst = xx.substr(0,1);
   if(m_mtx_real_str_comp(xx_test_nub_e,100)==1 && xx_fst!="-"){       
          var ans_a= PIDIV2 ; return  ans_a;}                           
     if(m_mtx_real_str_comp(xx_test_nub_e,100)==1 && xx_fst=="-"){ 
          var ans_a= "-"+PIDIV2 ; return  ans_a;} 
   if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
    else { var xx=xx;} 
   var comp_xx_e = m_mtx_real_str_comp(xx,'1e+100');      
   var comp_xx_e_s = m_mtx_real_str_comp(xx,'1e-200'); 
   var xx = m_str_e_to_str(xx); 
  var comp_xx_0 = m_mtx_real_str_comp(xx,0);      
   var comp_xx_1 = m_mtx_real_str_comp(xx,1);    
   if(comp_xx_0==3){ var ans_1= 0; return ans_1; }         
   if(comp_xx_1==3){ var ans_1= PIDIV4;  
     if(xx_fst=="-"){ var ans_1 = "-"+ans_1;} 
                return ans_1; }                     
     if(comp_xx_e ==1){ var ans_1= PIDIV2;
        if(xx_fst=="-"){ var ans_1 = "-"+ans_1;} 
                return ans_1; }  
        if(comp_xx_e_s ==2){ var ans_1= xx;        
           if(xx_fst=="-"){ var ans_1 = "-"+ans_1;} 
               return ans_1; } 
    var xx=m_fix(xx,FIX_COL); 
    var inv_flag =0 ;   
     var comp_xx_01 = m_mtx_real_str_comp(xx,1);   
     if( comp_xx_01 == 1 ){
     var xx = m_mtx_real_div(1,xx);                       
     var inv_flag =1 ;                 
      }
     var sum_ref = 0 ; 
      var ATAN05="0.46364760900080611621425623146121440202853705428612026381093308872019786416574170530060028398488789255652985225119083751350581818162501115547153056994410562071933626616488010153250275598792580551685388916747823728653879391801251719948401395583818511509502163330649387215460973207855555720860146322756524";
   var ATAN05=m_fix(ATAN05,FIX_COL);  
 var comp_xx_05 = m_mtx_real_str_comp(xx,0.5);                       
       if(comp_xx_05 ==3){  //20210916              
         var sum_ref = m_mtx_real_add(sum_ref, ATAN05); var xx=0;}   
       if(comp_xx_05 ==1){  //20210916 
         var sum_ref = m_mtx_real_add(sum_ref, ATAN05);   
         var data_a = m_mtx_real_sub(xx,0.5);    
         var data_b = m_mtx_real_div(xx,2);     
         var data_c = m_mtx_real_add(1,data_b);   
         var xx=  m_mtx_real_div(data_a,data_c); } 
    var ATAN025= "0.24497866312686415417208248121127581091414409838118406712737591466735511958764209657453415766870199136383480449003711837429548542099505997695898696061420373520127708738758165572158671598263855063205220878730675014341562336348263956369780852159107324583523813507629995556890112583026626233025991575328102";
    var ATAN025=m_fix(ATAN025,FIX_COL); //20211130  
      var comp_xx_025 = m_mtx_real_str_comp(xx,0.25);
       if(comp_xx_025 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN025);         
                        var xx=0;}                 
       if(comp_xx_025 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN025);
         var data_a = m_mtx_real_sub(xx,0.25); 
         var data_b = m_mtx_real_div(xx,4); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
     if( DECI_DGT > 16){ 
     var ATAN0125= "0.12435499454676143503135484916387102557317019176980408991511411911572226742756675862371059431335333032637905130343837904381116308396839504671224378687171138859102401250904002718788102654925876989000973265906011694932561477352380174653752050574821602248006715464219160658033901853095048722664103400886537";
     var ATAN0125=m_fix(ATAN0125,FIX_COL); //20211130 
     var comp_xx_0125 = m_mtx_real_str_comp(xx,0.125);                       
     if(comp_xx_0125 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN0125);  
                          var xx=0;} 
     if(comp_xx_0125 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN0125);
         var data_a = m_mtx_real_sub(xx,0.125); 
         var data_b = m_mtx_real_div(xx,8); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
    var ATAN00625= "0.06241880999595734847397911298550511360627388779749919460752781689869026721680345781396936172340611606164582642436956535402027683203445637073513324665932735205942294213070022641609329327604292108100586400928953010289820372883356522890896705132176920381641458615932279452226864404048949804368016652239930";
     var ATAN00625=m_fix(ATAN00625,FIX_COL); //20211130
     var comp_xx_00625 = m_mtx_real_str_comp(xx,0.0625);                       
        if(comp_xx_00625 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN00625);  
                          var xx=0;}
        if(comp_xx_00625 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN00625);
         var data_a = m_mtx_real_sub(xx,0.0625); 
         var data_b = m_mtx_real_div(xx,16); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
  
     var ATAN003125= "0.03123983343026827625371174489249097703249566372540004025531558625579642101943244717896297220075854500601141107647794733431560074278425159984884114970704621980281740118371157127162075412096575491837354388843301430976517237326708811190144997643726266684576376464311844490704217654584073903270233049377841";
     var ATAN003125=m_fix(ATAN003125,FIX_COL); //20211130 
     var comp_xx_003125 = m_mtx_real_str_comp(xx,0.03125);                       
       if(comp_xx_003125 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN003125);  
                                var xx=0;}
       if(comp_xx_003125 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN003125);
         var data_a = m_mtx_real_sub(xx,0.03125); 
         var data_b = m_mtx_real_div(xx,32); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
      var ATAN0015625= "0.01562372862047683080280152125657031891111413980090541788141050739666477417640177912326444505513603460166170240257394210400208236381646661415010752710224612289497038722959923795561936987812119366678800470489196142064888954917615637890939265835172002852364270217945820855538105701228571278859817366860600";
     var ATAN0015625=m_fix(ATAN0015625,FIX_COL); //20211130 
     var comp_xx_0015625 = m_mtx_real_str_comp(xx,0.015625);                       
       if(comp_xx_0015625 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN0015625);  
                                       var xx=0;}
       if(comp_xx_0015625 ==1){ 
         var sum_ref = m_mtx_real_add(sum_ref, ATAN0015625);
         var data_a = m_mtx_real_sub(xx,0.015625); 
         var data_b = m_mtx_real_div(xx,64); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
   if( DECI_DGT > 50){ 
    var ATAN00078125="0.00781234106010111129646339184219928162122281172501472355745390224838987204533523137930264204013581201516597412499471821348553302353878092180560926844402769223609048129950759908514659506357037982796854621058316149983252239761135382160304008718116505749512456340612407081598444109949379452801588288052721";
    var ATAN00078125=m_fix(ATAN00078125,FIX_COL); //20211130
    var comp_xx_00078125 = m_mtx_real_str_comp(xx,0.0078125);
       if(comp_xx_00078125 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN00078125);  
                                         var xx=0;}                 
       if(comp_xx_00078125 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN00078125);
         var data_a = m_mtx_real_sub(xx,0.0078125); 
         var data_b = m_mtx_real_div(xx,128); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
    var ATAN000390625= "0.00390623013196697182762866531142438714035749011520285621521309514901134416395438020849570902245610003216537092105621743197739851169094193763433748357178045652815821069538880673548467226805287847028493548043934144577530709541405499465179424023469505939281452728188082297824958005181075759661688815370309";
    var ATAN000390625=m_fix(ATAN000390625,FIX_COL); //20211130 
    var comp_xx_000390625 = m_mtx_real_str_comp(xx,0.00390625);  
       if(comp_xx_000390625 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN000390625);  
                                      var xx=0;}              
       if(comp_xx_000390625 ==1){  
         var sum_ref = m_mtx_real_add(sum_ref, ATAN000390625);
         var data_a = m_mtx_real_sub(xx,0.00390625); 
         var data_b = m_mtx_real_div(xx,256); 
         var data_c = m_mtx_real_add(1,data_b); 
         var xx=  m_mtx_real_div(data_a,data_c); }
    var ATAN0001953125= "0.00195312251647881868512148262507671393161074677723351033905753396043108530313709797291591649670908583185874038382886814154571853990623041741008586008558418180554351461813286228938261948029610639939417726706738951705431210865010982992756459534154078665034104794028469563423062388328742618642562229121381";
     var ATAN0001953125=m_fix(ATAN0001953125,FIX_COL);    
     var comp_xx_0001953125 = m_mtx_real_str_comp(xx,0.001953125);                     
       if(comp_xx_0001953125 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN0001953125);  
                                        var xx=0;}  
       if(comp_xx_0001953125 ==1){  
       var sum_ref = m_mtx_real_add(sum_ref, ATAN0001953125);
       var data_a = m_mtx_real_sub(xx,0.001953125); 
       var data_b = m_mtx_real_div(xx,512);      
       var data_c = m_mtx_real_add(1,data_b); 
       var xx=  m_mtx_real_div(data_a,data_c); }
   if( DECI_DGT > 150){   
     var ATAN00009765625= "0.00097656218955931943040343019971729085163419701581008759004900725226763752035508454423581560302772747151329615923475615560028030019450898599859643846480343517498211853084646751392792362942417529030419460985728010663319644662176337731300628076961207172493394559869667997215661553994740459731535987767223";
     var ATAN00009765625=m_fix(ATAN00009765625,FIX_COL); 
     var comp_xx_00009765625 = m_mtx_real_str_comp(xx,0.0009765625);                       
        if(comp_xx_00009765625 ==3){var sum_ref = m_mtx_real_add(sum_ref, ATAN00009765625);  
                                   var xx=0;} 
       if(comp_xx_00009765625 ==1){  
       var sum_ref = m_mtx_real_add(sum_ref, ATAN00009765625);
       var data_a = m_mtx_real_sub(xx,0.0009765625); 
       var data_b = m_mtx_real_div(xx,1024);      
       var data_c = m_mtx_real_add(1,data_b); 
       var xx=  m_mtx_real_div(data_a,data_c); }
    }}}
     if( DECI_DGT <=16){
      var BB = m_mtx_unit_inv_lg_100_table_a(); }
    else{ var BB = m_mtx_unit_inv_lg_100_table();}    
     if(xx !=0){ 
      var AA  = m_str_to_mtx(xx) ;      
      var XX = AA;  
      var nn=101  ; 
      var AA2 = m_mtx_point_mul(AA,AA) ;
        for(var i = 1 ; i < nn ; i=i+2){       
         var BB_i = m_mtx_row_table(BB,i);          
           if(i ==1){
            var SS = AA;     
            var XX = AA;}                      
            else{
             var XX  = m_mtx_point_mul(XX,AA2);             
             var XXI = m_mtx_point_mul(XX,BB_i);
                                       }
             var data_rem = i % 4;
                if(data_rem ==1 &&  i != 1){
                   var SS =  m_mtx_point_add(SS,XXI); }
                if(data_rem ==3 &&  i != 1){
                   var SS =  m_mtx_point_sub(SS,XXI); }
                                                    }     
         
             var  SS = m_mtx_cell_five(SS);   
             var  sum_total = m_mtx_cell_five_show(SS); 
             var  sum_total_t = m_mtx_real_add(sum_total,sum_ref); 
      }
         else{  var  sum_total_t = sum_ref; }
               if(inv_flag =="1"){    
                  var sum_total_t = m_mtx_real_sub(PIDIV2 ,sum_total_t);}
               if(xx_fst=="-"){    
                  var sum_total_t = "-"+ sum_total_t;}
      return sum_total_t; 
     
}


function m_asinh(x){                            
   var xx = x.toString().trim();
   var data_msg = 0;
    var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;} 
   var xx =m_mtx_trim(xx) ; 
  var xx = m_str_e_to_str_point(xx );
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-500)==2 ){ 
   var ans_a=xx ; return  ans_a;}
   var xx_fst = xx.substr(0,1);
    if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
    else { var xx=xx;}
  var comp_xx_60 = m_mtx_real_str_comp(xx,'1e+60');      
       if(comp_xx_60==1){
        var data_t = m_mtx_real_add(xx,xx);
        var ans_1 =m_ln(data_t);
       if(xx_fst=="-"){ var ans_1 = "-"+ans_1;}
           return  ans_1;}
      var xx = m_str_e_to_str(xx); 
   var ans_1=0;
   var data_2x = m_mtx_real_mul(xx,xx);
   var data_2x_1 = m_mtx_real_add(data_2x,1); 
   var data_pow = m_pow(data_2x_1,0.5);    
   var data_pow = m_str_e_to_str(data_pow);  
   var data_t = m_mtx_real_add(xx,data_pow);
        ans_1 =m_ln(data_t);
     if(xx_fst=="-"){ var ans_1 = "-"+ans_1;}                    
      var ans_1 = ans_1.toString().trim();
return ans_1;

}


function m_acosh(x){                  
  var xx = x.toString().trim();
  var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}
  var xx =m_mtx_trim(xx) ;  
   var xx = m_str_e_to_str_point(xx );
  var xx_fst = xx.substr(0,1);
    if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
     else { var xx=xx;}  
  var ans_1=0;
     if( m_mtx_real_str_comp(x,1)==2 || xx_fst=="-" ){ var ans_1= message_1(3);  return ans_1 ;}      
     if( m_mtx_real_str_comp(x,1)==3 ){ var ans_1 = 0  ; return ans_1 ;} 
   var comp_xx_1 = m_mtx_real_str_comp(xx,'1e+1000');        
     if(comp_xx_1==1){
         var data_t = m_mtx_real_add(xx,xx);
         var ans_1 =m_ln(data_t);
                return ans_1;   } 
    var xx = m_str_e_to_str(xx);
    var data_2x = m_mtx_real_mul(xx,xx);                    
    var data_2x_1 = m_mtx_real_sub(data_2x,1);                    
    var data_pow = m_pow(data_2x_1,0.5);                    
    var data_t = m_mtx_real_add(xx,data_pow);
         ans_1 =m_ln(data_t);
   var ans_1 = ans_1.toString().trim();
return ans_1;
}


function m_atanh(x){                            
var xx = x.toString().trim();
var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
 var xx =m_mtx_trim(xx) ;   
 var xx = m_str_e_to_str_point(xx ); 
 var xx_test_small = m_mtx_str_to_e_a(xx);              
 var xx_test_nub_e =m_str_power(xx_test_small,0);             
 var xx_test_st = m_str_power(xx_test_small,1);          
      if(m_mtx_real_str_comp(xx_test_nub_e,-200)==2 ){ 
  var ans_a=xx ; return  ans_a;} 
  var xx_fst = xx.substr(0,1);
       if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
        else { var xx=xx;}    
       xx = m_str_e_to_str(xx);      
   var ans_1=0;
   var comp_xx_0 = m_mtx_real_str_comp(xx,0);
   var comp_xx_1 = m_mtx_real_str_comp(xx,1);    
   var comp_xx_n1 = m_mtx_real_str_comp(xx,-1);    
      if( comp_xx_n1 == 2 || comp_xx_1 ==1 ){ var ans_1= message_1(4);  return ans_1 ;}    
      if( comp_xx_n1 == 3 || comp_xx_1 ==3 ){ var ans_1= message_1(4);  return ans_1 ;}    
      if( comp_xx_0 == 3 ){ var ans_1 = 0  ; return ans_1 ;}  
   var comp_xx_1 = m_mtx_real_str_comp(xx,1); 
    var data_test = m_mtx_real_sub('1','1e-195');  
    var data_test_up = m_mtx_real_sub('1','1e-200');       
    var comp_xx_data_test = m_mtx_real_str_comp(xx,data_test);  
    var comp_xx_data_test_up = m_mtx_real_str_comp(xx,data_test_up);  
     if((comp_xx_1==2)&& (comp_xx_data_test_up ==1)){                   
            var ans_1= message_1(15);  return ans_1 ; }
   if((comp_xx_data_test_up !=1)&& (comp_xx_data_test !=2)){ 
    var data_a = m_fix(LN2S,250); 
    var xx =  xx.toString();     
    var data_b = m_mtx_real_sub('1',xx); 
    var data_c = m_ln(data_b) 
    var data_d = m_mtx_real_sub(data_a,data_c); 
    var ans_1 = m_mtx_real_div(data_d,2);  }   
    if(comp_xx_data_test ==2){
    var data_a = m_mtx_real_add(1,xx);                     
    var data_b = m_mtx_real_sub(1,xx);                    
    var data_c = m_mtx_real_div(data_a,data_b);           
    var data_d = m_ln(data_c);                            
    var ans_1 = m_mtx_real_div(data_d,2);}     
     if(xx_fst=="-"){ var ans_1 = "-"+ans_1;}                    
    var ans_1 = ans_1.toString().trim();
return ans_1;
}


function m_mtx_row_table(A,row){     
 var AA=A;
 var n=row;
 var BB=m_new_zero_mtx(1,AA[0].length);               
   for(var i=0;i<AA[0].length;i++){ 
     BB[0][i]=AA[n][i];}
   return BB ; 
}


function m_mtx_point_in_int(A,x){      
   var AA=A;
   var xx=m_abs(x);
   var data_row = AA.length;     
   var data_col=AA[0].length;  
       xx="00000"+xx.toString();    
   var xx_lg=xx.length;
    for(var m=0;m<data_row ;m++){        
         for(var n=0;n<data_col;n++){
           if( (xx_lg-(m+n+1)*5) >=0){
             AA[m][n]= xx.substr((xx_lg-(m+n+1)*5),5);    
                                   }
           if(AA[m][n]==""){ AA[m][n]=0;}       
                                      }
                  }
    return AA;
}


function m_mtx_point_in(A,x){      
   var AA=A;
     var xx = m_str_e_to_str(x);  
     var xx_st = xx.toString().trim();
     var data_chk= xx_st.substr(0,1);
     var data_chk_lg= xx_st.length;
        if(data_chk=="-"){
          var xx = xx_st.substr(1,data_chk_lg-1);}
        else{ var xx=xx_st;}
     var data_row = AA.length;     
     var data_col=AA[0].length;  
        xx=xx.toString()+"00000";    
     var xx_lg=xx.length;
       for(var m=0;m<data_row ;m++){        
         for(var n=0;n<data_col;n++){
           AA[m][n]= xx.substr(2+((m+n)*5),5);    
              if(AA[m][n]==""){ AA[m][n]=0;}       
                                 }
                                         }
   return AA;
}


function m_mtx_point_mul_all(A,B){      
 var AA=A;
  var BB=B;
  var data_chk_a = AA[0][0].toString().trim();
  var data_chk_b = BB[0][0].toString().trim();
  var data_chk_a_fst = data_chk_a.substr(0,1);
  var data_chk_b_fst = data_chk_b.substr(0,1);
      if(data_chk_a_fst =="-" ){ 
                     var data_chk_a = data_chk_a.substr(1,data_chk_a.length-1);}
        else{ var data_chk_a = data_chk_a;}
                     AA[0][0]= data_chk_a; 
       if(data_chk_b_fst =="-" ){
                     var data_chk_b = data_chk_b.substr(1,data_chk_b.length-1);}
        else{ var data_chk_b = data_chk_b;}
                      BB[0][0]= data_chk_b;   
   var CC = m_new_zero_mtx(1,MTX_COL);     
       CC = m_mtx_point_mul(A,B);      
       CC = m_mtx_cell_five(CC);
           if(( data_chk_a_fst=="-" && data_chk_b_fst !="-")||( data_chk_a_fst !="-" && data_chk_b_st=="-")){
                            var data_c00= CC[0][0];
                              CC[0][0]= "-"+data_c00 ;} 

   return CC;  
}

function m_mtx_point_mul(A,B){      
  var AA=A;
  var BB=B;
  var data_row_a = AA.length;      
  var data_col_a = AA[0].length;  
  var data_row_b = BB.length;     
  var data_col_b = BB[0].length;  
  var data_chk_a = AA[0][0].toString().trim();
  var data_chk_b = BB[0][0].toString().trim();
  var data_chk_a_fst = data_chk_a.substr(0,1);
  var data_chk_b_fst = data_chk_b.substr(0,1);
     if(data_chk_a_fst =="-" ){ 
                     var data_chk_a = data_chk_a.substr(1,data_chk_a.length-1);}
        else{ var data_chk_a = data_chk_a;}
                     AA[0][0]= data_chk_a; 
       if(data_chk_b_fst =="-" ){
                     var data_chk_b = data_chk_b.substr(1,data_chk_b.length-1);}
        else{ var data_chk_b = data_chk_b;}
                     BB[0][0]= data_chk_b;   
         var data_col_max =0;
           if(data_col_a >= data_col_b){ var data_col_max = data_col_a ;}    
           if(data_col_a < data_col_b){ var data_col_max = data_col_b ;}
  var CC = m_new_zero_mtx(1,data_col_max); 
      for(var i=0;i<data_col_b ;i++){          
          var data_a=  parseInt(BB[0][i]);
        for(var n=0;n<(data_col_a-1-i) ;n++){    
               if(data_a >=0 || data_a<0 ){      
                CC[0][(n+i)+1]= data_a *parseInt(AA[0][n]) + parseInt(CC[0][(n+i)+1]);   
                                          } 
                                            }   
                                       }         
   
           CC[0][0]=0;
   CC = m_mtx_cell_five(CC); 
  return CC;
}


function m_str_e_to_str(x){             
  var xx_st=x.toString().trim();             
   var xx_fst = xx_st.substr(0,1);
   var xx_lg = xx_st.length;
     if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);    
                          xx_lg=xx_lg-1;}
    var pos_pot  = xx_st.indexOf(".");    
    var pos_e  = xx_st.indexOf("e");  
   if(pos_e == -1){ return x ;}                      
       var  nub_x_0 = m_str_power(xx_st,0);         
       var  xx_st_0 = m_str_power(xx_st,1);          
       var nub_pot = nub_x_0.indexOf(".");   
       var flag_e=0;
    if( nub_pot !=-1){                              
         var xx_st = mtx_str_e(xx_st);        
          var flag_e = 1;
                     }
    if( nub_pot ==-1 || flag_e == 1 ){                             
         var  nub_x = m_str_power(xx_st,0);          
              xx_st = m_str_power(xx_st,1);          
           var xx_lg = xx_st.length;             
           var pos_pot  = xx_st.indexOf(".");    
           var xx_chk = xx_lg-pos_pot-1;
     if(xx_chk >= nub_x && pos_pot !=-1){                    
          xx_st = m_mtx_str_element_shift(xx_st,nub_x);     
               nub_x =0;
                             }
            if(xx_chk < nub_x && pos_pot !=-1){                    
                  var data_z=0;
                  var data_z=nub_x - xx_chk;
                     while( data_z >0){
                      xx_st =  xx_st+"0";
                       data_z = data_z -1 ;
                                    }
             xx_st = m_mtx_str_element_shift(xx_st,nub_x);     
               nub_x =0;
                             }
               var nub_x_comp_0 = m_mtx_real_str_comp(nub_x,0);   
              if( nub_x_comp_0==2  && pos_pot !=-1 ){                             
             xx_st = m_mtx_str_element_shift(xx_st,nub_x);     
               nub_x =0;
                             }
              if( nub_x_comp_0==2  && pos_pot == -1 ){                      
                   xx_st =xx_st+"." ;    
                    xx_st = m_mtx_str_element_shift(xx_st,nub_x);         
                       nub_x =0;
                             } 
              if( nub_x_comp_0==1 && pos_pot ==-1){                    
                    while( nub_x_comp_0==1){
                      xx_st =  xx_st+"0";
                      nub_x = m_mtx_real_sub(nub_x,1) ;
                      var nub_x_comp_0 = m_mtx_real_str_comp(nub_x,0);   
                                    }
                   nub_x_comp_0==3;
               
                             }
          }   

        if(xx_fst=="-"){ xx_st="-"+xx_st;}    
         else{ xx_st=xx_st;}
          var xx_st = m_mtx_trim(xx_st) ;   
    return xx_st ;
}

function m_mtx_str_to_e(x){             
 var xx_st=x.toString().trim();             
  var xx_fst = xx_st.substr(0,1);
  var xx_lg = xx_st.length;
     if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);   
                          xx_lg=xx_lg-1;}
       var pos_e  = xx_st.indexOf("e");    
       var pos_point  = xx_st.indexOf("."); 
        var data_msg = xx_st.indexOf("Msg"); 
        if(data_msg !=-1){ return xx_st ;}  
       var data_fst = xx_st.substr(0,1);     
       var data_chk = 1;
       var nub_x =0;
    if(pos_e != -1  ){ return x ;}   
    if(pos_e == -1 && pos_point ==-1 && xx_lg>=2 ){             
            xx_st= xx_st.substr(0,1) +"."+xx_st.substr(1,xx_lg-1)+"e+"+ (xx_lg-1);
                   if(xx_fst=="-"){ xx_st="-"+xx_st;}    
                    else{ xx_st=xx_st;}
                      return xx_st ;}      
    if(pos_e == -1 && pos_point !=-1 && data_fst !=0 && pos_point >1 && xx_lg >3){       
                     xx_st= xx_st.substr(0,1) +"."+xx_st.substr(1,pos_point-1) + xx_st.substr(pos_point+1,xx_lg-pos_point-1)+"e+"+(pos_point-1);
                     if(xx_fst=="-"){ xx_st="-"+xx_st;}    
                       else{ xx_st=xx_st;}
                      return xx_st ;}  
     if(pos_e == -1 && pos_point !=-1 && data_fst ==0 ){       
           var xx_lg = xx_st.length;             
           var pos_pot  = xx_st.indexOf(".");    
            for(var i=0 ;i<xx_lg-1 ;i++){
                var data_chk = xx_st.substr(i+2,1);           
                    if( data_chk ==0){ var nub_x = nub_x+1;}
                    else{ i= xx_lg;}                          
                                          }
           if( nub_x >=1){                    
             xx_st = m_mtx_str_element_shift(xx_st,nub_x+1);    
                             }
           }
        if(xx_fst=="-"){ xx_st="-"+xx_st;}    
         else{ xx_st=xx_st;}  
         var xx_st = m_mtx_trim(xx_st) ;   
          if( nub_x >=1){
            xx_st = xx_st+"e-"+(nub_x+1); }           
           nub_x =0;
    return xx_st ;
}


function m_mtx_str_to_e_a(x){             
var xx_st=x.toString().trim();             
  var xx_fst = xx_st.substr(0,1);
  var xx_lg = xx_st.length;
    if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);    
                          xx_lg=xx_lg-1;}
      var pos_e  = xx_st.indexOf("e");  
      var data_msg = xx_st.indexOf("Msg"); 
         if(data_msg !=-1){ return xx_st ;}  
       var data_fst = xx_st.substr(0,1);     
       var data_chk = 1;
       var nub_x =0;
      if(pos_e  !=-1){
        nub_x = m_str_power(xx_st,0);          
                     }
     var xx_st = m_str_power(xx_st,1);
     var xx_st_lg = xx_st.length;  
      if( xx_st_lg >1 ){   
       var  xx_st1 = m_mtx_str_to_e(xx_st);  
       var  nub_x1 = m_str_power(xx_st1,0);     
       var  nub_x = m_mtx_int_add(nub_x,nub_x1);
       var xx_st = m_str_power(xx_st1,1); 
      } 
     var nub_m= m_nub_m(xx_st);      
     var nub_p= m_nub_p(xx_st);      
     var nub_m_lg = nub_m.toString().length;
     var nub_p_lg = nub_p.toString().length;
     var xx_lg = xx_st.length;             
     var pos_pot  = xx_st.indexOf(".");    
     var data_fst = xx_st.substr(0,1);
         if( nub_m_lg >1 &&  pos_pot  !=-1 &&  data_fst !=0){                    
              xx_st = m_mtx_str_element_shift(xx_st, (-nub_m_lg+1));               
          var nub_x = m_mtx_int_sub(nub_x,1);                
          var nub_x = m_mtx_int_add(nub_x,nub_m_lg);
                            }
          var data_fst = xx_st.substr(0,1);  
            if( nub_m_lg ==1 &&  pos_pot  !=-1 &&  data_fst ==0){                
                   xx_st = m_mtx_str_element_shift(xx_st, 1);                     
           var nub_x = m_mtx_int_sub(nub_x,1);
                             } 
            var nn=1;
                 var data_fst = xx_st.substr(0,1);  
           if( nub_m ==0 &&  pos_pot  !=-1 &&  data_fst ==0){               
              while( nn >0){
               xx_st = m_mtx_str_element_shift(xx_st, 1);            
                  var nub_x = m_mtx_int_sub(nub_x,1);
                           var nub_m= m_nub_m(xx_st);      
                              if(nub_m !=0){ var nn=-1 ;} 
                               }
             
                                                       }
 
       if(xx_fst=="-"){ xx_st="-"+xx_st;}    
         else{ xx_st=xx_st;}  
         var xx_st = m_mtx_trim(xx_st) ;   
           nub_x = m_str_e_to_str(nub_x);             
          if( nub_x < 0){
            xx_st = xx_st+"e"+(nub_x); }           
           if( nub_x == 0){
            xx_st = xx_st; }                       
           if( nub_x > 0){
            xx_st = xx_st+"e+"+(nub_x); }          
           nub_x =0;
          var xx_st=  m_fix_pow_lst(xx_st);    
  return xx_st ;

}

function m_mtx_str_to_e_ne(x){             
 var xx_st=x.toString().trim();             
  var xx_fst = xx_st.substr(0,1);
  var xx_lg = xx_st.length;
      if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);    
                          xx_lg=xx_lg-1;}
       var xx_st_new = xx_st;
       var xx_st = m_mtx_trim(xx_st) ;   
       var pos_e  = xx_st.indexOf("e");  
       var pos_pot  = xx_st.indexOf(".");    
       var data_fst = xx_st.substr(0,1);     
       var xx_lg = xx_st.length;             
     if(pos_e == -1 && pos_pot ==-1 && xx_lg >1 ){       
            for(var i=0; i< xx_st.length;i++){
                 if(data_fst ==0 && xx_lg >1){           
                       xx_st = xx_st.substr(1,xx_lg-1);
                       var data_fst = xx_st.substr(0,1);       
                       var xx_lg = xx_st.length;             
                                 }
                                                }     
             var xx_lg = xx_st.length;             
               if(xx_lg >1){
                 var xx_st_new = xx_st.substr(0,1)+"."+ xx_st.substr(1,xx_lg-1)+"e+"+(xx_lg-1);
                           }
                                                 }
        if(xx_fst=="-"){ xx_st_new="-"+xx_st_new;}    
         else{ xx_st_new=xx_st_new;}  
    return xx_st_new ;
}

function m_mtx_str_to_e_nez(x,n){             
  var xx_st=x.toString().trim();             
  var xx_fst = xx_st.substr(0,1);
  var xx_lg = xx_st.length;
      if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);    
                          xx_lg=xx_lg-1;}
       var xx_st_new = xx_st;
       var xx_st = m_mtx_trim(xx_st) ;   
       var pos_e  = xx_st.indexOf("e");  
       var pos_pot  = xx_st.indexOf(".");    
       var data_fst = xx_st.substr(0,1);     
       var xx_lg = xx_st.length;             
      if(pos_e == -1 && pos_pot ==-1 && xx_lg >=1 ){       
            var xx_st_new = "0."+ xx_st.substr(0,xx_lg);
                                                  }     
        if(xx_fst=="-"){ xx_st_new="-"+xx_st_new;}    
         else{ xx_st_new=xx_st_new;}  
   if(n==0){
       return xx_st_new ;}
    else { return xx_lg ;}
}


function m_mtx_str_to_e_small(x){                
  var xx_st=x.toString().trim();             
  var xx_fst = xx_st.substr(0,1);
  var xx_lg = xx_st.length;
      if(xx_fst=="-"){ xx_st=xx_st.substr(1,xx_lg-1);    
                          xx_lg=xx_lg-1;}
       var xx_st_new = xx_st;
       var xx_st = m_mtx_trim(xx_st) ;   
       var pos_e  = xx_st.indexOf("e");  
       var pos_pot  = xx_st.indexOf(".");    
       var data_fst = xx_st.substr(0,2);     
       var xx_lg = xx_st.length;             
       var data_zero = 1;
       var data_nub = 0;
   if(pos_e == -1 && pos_pot !=-1 && xx_lg >=1 && data_fst=="0."){       
                 for(var i=0;i<xx_lg ;i++){    
                       var data_zero = xx_st.substr(2+i,1);
                            if(data_zero==0){ var data_nub=data_nub+1; } 
                            else {var i =xx_lg ;}  
                                          } 
                              if(data_nub >=1) { xx_st_new = xx_st.substr(data_nub+2,1) + "." + xx_st.substr(data_nub+3,xx_lg-data_nub-3)+"e-"+ (data_nub+1);
                                                }   
 
                                                                        }
        if(xx_fst=="-"){ xx_st_new="-"+xx_st_new;}    
         else{ xx_st_new=xx_st_new;}  
      return xx_st_new ;
}

function m_str_1_point( x ,nub){             
   var xx_st=x.toString().trim();             
  var data_x_fst=xx_st.substr(0,1);
  var data_x_lg=xx_st.length;
  var data_x_pot  =xx_st.indexOf(".");    
  var data_x_e  =xx_st.indexOf("e");
  var data_chk=0;
       if(data_x_pot==-1 && data_x_e==-1 && data_x_fst !="-"){            
           xx_st=xx_st.substr(0,1)+"."+xx_st.substr(1,data_x_lg-1);
                 if(data_x_fst =="-"){
                    xx_st=xx_st.substr(0,2)+"."+xx_st.substr(2,data_x_lg-2);}
                var data_chk = data_chk+ data_x_lg-1 ; 
         }
     if(data_x_fst=="-"){ xx_st=xx_st.substr(1,data_x_lg-1);    
                          data_x_lg=data_x_lg-1;} 
          var xx_st= xx_st.toString().trim();
          var xx_st =m_mtx_trim(xx_st).toString() ;      
          var pos_pot_a  = xx_st.indexOf(".");    
          var  data_x_fst_a =xx_st.substr(0,1);
          var nub_lg = 0;                                 
          var nub_tol = 0;
          var nub_lg = xx_st.length ;                      
            if( nub_lg <=400){ var nub_tol = 400 ;}
           else { var nub_tol = nub_lg ;}
         for(var i=0;i<= nub_tol ;i++){                                             
           if( pos_pot_a ==1 && data_x_fst_a == "0"){    
               xx_st = m_mtx_str_element_shift(xx_st,1);     
                   var data_chk = data_chk-1; 
                   var pos_pot_a  = xx_st.indexOf(".");   
                   var data_x_fst_a =xx_st.substr(0,1);   
                                                   }  
                                            }           
            var pos_pot_a  = xx_st.indexOf(".");   
            var data_x_fst_a =xx_st.substr(0,1);   
          for(var j=0;j< nub_tol ;j++){               
           if( pos_pot_a >1 && data_x_fst_a != "0"){    
               xx_st = m_mtx_str_element_shift(xx_st,-1);     
                   var data_chk = data_chk+1;  
                   var pos_pot_a  = xx_st.indexOf(".");   
                   var data_x_fst_a =xx_st.substr(0,1);   
                                                     }  
                                            }  
    var data_chk = m_mtx_trim(data_chk).toString() ;   
    var xx_st = m_mtx_trim(xx_st).toString() ; 
      if(data_x_fst=="-"){ xx_st="-"+xx_st; }   
      if(nub == 1){ return data_chk ;}  
      if(nub == 0){ return xx_st ;}
 }

function m_mtx_int_mul(x,y){  
  var xx = x.toString();
  var yy = y.toString();
  var xx = xx.toString().trim();
  var yy = yy.toString().trim();
  var xx_fst = xx.substr(0,1);
  var yy_fst = yy.substr(0,1);
  var xx_lg = xx.length;      
  var yy_lg = yy.length;  
   if(xx==0 || yy==0){ var sum_c= 0; return  sum_c;  }
   if(xx==1 || yy==0){ var sum_c= yy; return  sum_c;  }
   if(xx==0 || yy==1){ var sum_c= xx; return  sum_c;  } 
   if(xx_fst =="-" ){ var xx = xx.substr(1,xx_lg-1);
                      var xx_lg = xx_lg-1 ;  }
   else{ var xx = xx;}
   if(yy_fst =="-" ){ var yy = yy.substr(1,yy_lg-1);
                      var yy_lg = yy_lg-1 ;   }
    else{ var yy = yy;}   
  var y_e=0;
  var x_e=0;
  var xy_e =0; 
  var xy_et =0; 
  var y_power=0;
  var x_power=0;
  var xy_power =0;
  var idx_e = xx.indexOf("e");
  var idy_e = yy.indexOf("e");
   if(idx_e !=-1){
      var x_power =m_str_power(xx,0); 
      var x_str =m_str_power(xx,1);
      var xx=x_str;   
      var xx_lg =xx.length;          }
  if(idy_e !=-1){
      var y_power =m_str_power(yy,0); 
      var y_str =m_str_power(yy,1);
      var yy=y_str;
      var yy_lg =yy.length;    
                    }
 var xy_power = m_mtx_int_add(x_power,y_power);  
 var idx_power =0;
 var idy_power =0;
 var idxy_power =0;
 var idx_point = xx.indexOf(".");
 var idy_point = yy.indexOf(".");
  if(idx_point !=-1){var xx = xx.replace(/\./g,""); 
                     var xx_lg =xx.length ;
      var idx_power = xx.length - idx_point ;}
  if(idy_point !=-1){var yy = yy.replace(/\./g,""); 
                     var yy_lg = yy.length;
                     var idy_power = yy.length - idy_point ;}
 var idxy_power = m_mtx_int_add(idx_power,idy_power);   
 var x_e=0; 
 var y_e=0;
 var xy_e=0;
 var xy_et=0;
 var xx = xx.toString().trim();  
 var yy = yy.toString().trim();
  if(yy_lg >=250 ){var yy=yy.substr(0,250) ;
                   var y_e =  yy_lg-250 ;
                   var yy_lg =yy.length;}
 if(xx_lg >=250){var xx=xx.substr(0,250) ;
                  var x_e = xx_lg-250 ;
                  var xx_lg =xx.length;}
  var xy_e = m_mtx_int_add(x_e,y_e);
  var xy_et = m_mtx_int_add(xy_e,xy_power);
  var xy_ett = m_mtx_int_sub(xy_et,idxy_power);
  if(xx_lg < yy_lg){var zz = xx ;    
                    var xx = yy ;     
                    var yy = zz; }
  var AA= m_new_zero_mtx(10,2); 
  var BB= m_new_zero_mtx(1,2); 
  var TT= m_new_zero_mtx(1,1); 
    AA[0][0]= 0;  
    AA[0][1]= 0;
    AA[1][0]= 1;  
    AA[1][1]= xx;
    AA[2][0]= 2; 
    AA[2][1]= m_mtx_int_add(xx , AA[1][1]);
    AA[3][0]= 3;  
    AA[3][1]= m_mtx_int_add(xx , AA[2][1]);
    AA[4][0]= 4;  
    AA[4][1]= m_mtx_int_add(xx , AA[3][1]);
    AA[5][0]= 5;  
    AA[5][1]= m_mtx_int_add(xx , AA[4][1]);
    AA[6][0]= 6;  
    AA[6][1]= m_mtx_int_add(xx , AA[5][1]);
    AA[7][0]= 7;  
    AA[7][1]= m_mtx_int_add(xx , AA[6][1]);
    AA[8][0]= 8;  
    AA[8][1]= m_mtx_int_add(xx , AA[7][1]);
    AA[9][0]= 9;  
    AA[9][1]= m_mtx_int_add(xx , AA[8][1]);
  var yy_lg_t = yy.length;
  var y_n =  yy_lg_t-1;
    TT[0][0] =0;
      for(var i=0;i<yy.length ;i++){
          var nub_y = yy.substr(i,1);
      if(nub_y !=0 ){ TT[0][0] = AA[nub_y][1];}
         if(y_n >0 && nub_y !=0 ){
             for(var j = y_n ;j >0 ;j--){
                 TT[0][0] = TT[0][0]+"0"; }}
   var y_n = y_n-1;
      if(nub_y !=0 ){
         BB[0][1] = m_mtx_int_add(BB[0][1] , TT[0][0] ) ;}
             }
    var sum_a = BB[0][1];
      if((xx_fst =="-" && yy_fst !="-")||(xx_fst !="-" && yy_fst =="-")){ var sum_b = "-"+sum_a;}
      else{ var sum_b = sum_a;}
       sum_b = sum_b.toString().trim(); 
      if(xy_ett > 0){
        sum_c = sum_b+"e+"+xy_ett ; }
      else if(xy_ett < 0){
        sum_c = sum_b+"e"+xy_ett ; } 
      else{ sum_c = sum_b;}
      return  sum_c;  
}
function m_mtx_real_mul(y,x){     
     var  x= x.toString().trim();
     var  x= m_mtx_trim(x);
     var  y= y.toString().trim();
     var  y= m_mtx_trim(y);
     var x_msg = m_mtx_test_msg(x);
     var y_msg = m_mtx_test_msg(y);
     var ans_1=""; 
        if(x_msg !=-1 ){ return x;}     
        if(y_msg !=-1 ){ return y;}
     var data_x_comp_0 = m_mtx_real_str_comp(x,0);     
     var data_y_comp_0 = m_mtx_real_str_comp(y,0);    
      if(data_x_comp_0 ==3 ||  data_y_comp_0 ==3){ var ans_1=0; return ans_1;}       
     var data_x_comp_1 = m_mtx_real_str_comp(x,1);    
      if(data_x_comp_1 ==3 ){ var ans_1=y; return ans_1;}       
     var data_y_comp_1 = m_mtx_real_str_comp(y,1);    
     if(data_y_comp_1 ==3 ){ var ans_1=x; return ans_1;}
   y = m_mtx_str_to_e(y);       
   x = m_mtx_str_to_e(x);         
   y = m_mtx_str_to_e_a(y);       
   x = m_mtx_str_to_e_a(x);       
        var yy=y.toString();
        var yy_st =yy.toString();
        var pos_pot  = yy_st.indexOf(".");    
        var pos_e  = yy_st.indexOf("e");     
        var st_lg = yy_st.length;
        var nub_e_y=0;  
         if(  pos_e != -1){ 
           nub_e_y =m_str_power(yy_st,0);          
           yy_st = m_str_power(yy_st,1);          
                           }
   var data_y_fst=yy_st.substr(0,1);
   var data_y_lg=yy_st.length;
     if(data_y_fst=="-"){ yy_st=yy_st.substr(1,data_y_lg-1);    
                          data_y_lg=data_y_lg-1;} 
        var xx=x.toString();
        var xx_st =xx.toString();
        var pos_pot_x  = xx_st.indexOf(".");    
        var pos_e_x  = xx_st.indexOf("e");     
        var st_lg_x = xx_st.length;
        var nub_e_x=0;   
         if(  pos_e_x != -1){ 
           nub_e_x =m_str_power(xx_st,0);          
           xx_st = m_str_power(xx_st,1);          
                           }
       var data_x_fst=xx_st.substr(0,1);   
       var xx_chk = m_str_1_point( xx_st ,1);       
       var xx_st  = m_str_1_point( xx_st ,0);       
       var yy_chk = m_str_1_point( yy_st ,1);              
       var yy_st  = m_str_1_point( yy_st ,0);             
       var data_chk = m_mtx_real_add(xx_chk,yy_chk) ;   
   var AA = m_str_to_mtx(yy_st) ; 
   var BB = m_str_to_mtx(xx_st) ; 
   var CC = m_mtx_point_mul(AA,BB) ;  
       CC = m_mtx_cell_five(CC);      
      var sum_tt = m_mtx_cell_five_show(CC);   
      var sum_tt = m_mtx_trim(sum_tt) ;   
      var pos_pot_b  = sum_tt.indexOf(".");    
               if(pos_pot_b > 1){                        
                  sum_tt = m_mtx_str_element_shift(sum_tt,1-pos_pot_b);   
                          var data_chk = m_mtx_int_add(data_chk,pos_pot_b);
                          var data_chk = m_mtx_int_sub(data_chk,1);
                                }
                 var sum_tt = m_mtx_trim(sum_tt) ;   
       if( data_y_fst =="-" && data_x_fst !="-"){ var sum_tt = "-"+sum_tt;} 
       if( data_y_fst !="-" && data_x_fst =="-"){ var sum_tt = "-"+sum_tt;} 
           var nub_e_y = m_mtx_trim(nub_e_y) ;   
           var nub_e_x = m_mtx_trim(nub_e_x) ;   
           var data_chk = m_mtx_trim(data_chk) ;   
           var nub_e_t1 =0;
           var nub_e_t =0;
           var nub_e_y_point =0;   
           var nub_e_x_point =0; 
           var nub_e_y_point =  m_str_char(nub_e_y.toString(),".");   
           var nub_e_x_point =  m_str_char(nub_e_x.toString(),".");   
            if( nub_e_y_point ==0 &&  nub_e_x_point ==0){ 
              var nub_e_t1 = m_mtx_int_add(nub_e_y,nub_e_x) ;}           
            else{
              var nub_e_t1 = m_mtx_real_add(nub_e_y,nub_e_x) ;}           
           var nub_e_t1 = m_fix(nub_e_t1,2000);                          

           if( nub_e_y_point ==0 &&  nub_e_x_point ==0){      
              var nub_e_t = m_mtx_int_add(nub_e_t1,data_chk);}    
           else{
            var nub_e_t = m_mtx_real_add(nub_e_t1,data_chk);}      
           var nub_e_t = m_fix(nub_e_t,2000);                          
           var nub_e_t = m_str_e_to_str(nub_e_t); 
         var sum_ttt = 0 ;  
          var  data_nub_e_t_comp_0 = m_mtx_real_str_comp(nub_e_t,0);    
          if(data_nub_e_t_comp_0==1 ){ sum_ttt = sum_tt+"e+"+nub_e_t;}   
          if(data_nub_e_t_comp_0==2 ){ sum_ttt = sum_tt+"e"+nub_e_t;}   
          if(data_nub_e_t_comp_0==3 ){ sum_ttt = sum_tt;}
          if(sum_tt == 0 || sum_tt == "0"){ var sum_ttt = 0 ;} 
          if( nub_e_y_point ==0 &&  nub_e_x_point ==0){
          if( nub_e_t <=10 && nub_e_t >= 0){                            
               sum_ttt = m_str_e_to_str(sum_ttt) ;            
                                }}
   return sum_ttt;
 }

function m_str_e_to_str_point(str){     
  var yy_st=str;
  var yy_st;
  var pos_e  = yy_st.indexOf("e");               
  var st_lg = yy_st.length;
  var yy_st_af = yy_st.substr( pos_e+1,st_lg -pos_e-1);  
  var pos_pot  = yy_st_af.indexOf(".");                  
   if(  pos_e == -1 || pos_pot  ==-1 ){   
           return str; }
   var nub_e_y=0; 
   var nub_e_y =m_str_power(yy_st,0);          
   var yy_st = m_str_power(yy_st,1);  
  var data_tran = MTX_COL; 
      LN10=m_fix(LN10,FIX_COL);
   var yy_st_a1 = m_mtx_real_mul(LN10,nub_e_y);  
   var yy_st_a1 = m_fix(yy_st_a1,2000);            
   var yy_st_a = m_exp(yy_st_a1);                   
    var yy_st_b= m_mtx_real_mul(yy_st,yy_st_a);
                            
 return yy_st_b;   

}



function m_mtx_real_div(y,x){    
   var xx=x.toString().trim();
  var xx=m_mtx_trim(xx).toString(); 
   var yy=y.toString().trim();
  var yy=m_mtx_trim(yy).toString();
   var ans_1 ="";
   var sum_tt ="";
   var flag_ng=0;
   var x_msg = m_mtx_test_msg(x);
   var y_msg = m_mtx_test_msg(y);
     if(x_msg !=-1 ){ return x;}       
     if(y_msg !=-1 ){ return y;}
  var data_comp_xx_0 = m_mtx_real_str_comp(xx,0);       
     if(data_comp_xx_0==3){
        return message_1(29); ;}  
   var data_comp_yy_0 = m_mtx_real_str_comp(yy,0);       
     if(data_comp_yy_0==3){ return 0;}   
   var data_comp_xx_1 = m_mtx_real_str_comp(xx,1);       
     if(data_comp_xx_1==3){
        var ans_1 = yy;                         
       return ans_1 ;}   
  var data_comp_xx_yy = m_mtx_real_str_comp(xx,yy);      
       if(data_comp_xx_yy==3){
                  var ans_1 = 1;                         
                        return ans_1 ;}
   var yy = m_mtx_str_to_e(yy);       
   var xx = m_mtx_str_to_e(xx);        
   var yy = m_mtx_str_to_e_a(yy);       
   var xx = m_mtx_str_to_e_a(xx);        
   var yy_st =yy.toString();
   var pos_pot  = yy_st.indexOf(".");    
   var pos_e  = yy_st.indexOf("e");    
   var st_lg = yy_st.length;
   var nub_e_y=0; 
     if(  pos_e != -1){ 
       nub_e_y =m_str_power(yy_st,0);          
       yy_st = m_str_power(yy_st,1);  }         
   var data_y_fst=yy_st.substr(0,1);
   var data_y_lg=yy_st.length;
     if(data_y_fst=="-"){ yy_st=yy_st.substr(1,data_y_lg-1);    
        data_y_lg=data_y_lg-1;} 
   var xx_st =xx.toString();
   var pos_pot_x  = xx_st.indexOf(".");    
   var pos_e_x  = xx_st.indexOf("e");     
   var st_lg_x = xx_st.length;
   var nub_e_x=0; 
     if(  pos_e_x != -1){ 
       nub_e_x =m_str_power(xx_st,0);          
       xx_st = m_str_power(xx_st,1); }          
   var data_x_fst=xx_st.substr(0,1);
   var data_x_lg=xx_st.length;
   var xx_chk = m_str_1_point( xx_st ,1);             
   var xx_st  = m_str_1_point( xx_st ,0);       
   var yy_chk = m_str_1_point( yy_st ,1);              
   var yy_st  = m_str_1_point( yy_st ,0);             
   var data_chk = m_mtx_real_sub(yy_chk,xx_chk) ; 
   var B = m_str_to_mtx(yy_st) ; 
   var A = m_str_to_mtx(xx_st) ; 
   var sum_tt = m_mtx_reciprocal_div(B,A); 
    var sum_tt = m_mtx_trim(sum_tt) ;
   var sum_tt_fst= sum_tt.substr(0,1);
      if(sum_tt_fst==0){           
       var sum_tt = sum_tt.substr(2,1)+"."+sum_tt.substr(3,sum_tt.length-2);
       var flag_ng=1;    }
    var sum_tt = m_mtx_trim(sum_tt) ;   
       if( data_y_fst =="-" && data_x_fst !="-"){  sum_tt = "-"+sum_tt;} 
       if( data_y_fst !="-" && data_x_fst =="-"){  sum_tt = "-"+sum_tt;} 
    var nub_e_t = m_mtx_real_sub(nub_e_y,nub_e_x) ;       
    var nub_e_t = m_mtx_real_sub(nub_e_t,flag_ng) ;
    var nub_e_t = m_str_e_to_str(nub_e_t);   
    var data_comp_nub_e_t_0 = m_mtx_real_str_comp(nub_e_t,0);       
    var data_comp_sum_tt_0 = m_mtx_real_str_comp(sum_tt,0);
       if(data_comp_nub_e_t_0 == 1 ){ sum_tt = sum_tt+"e+"+nub_e_t;}   
       if(data_comp_nub_e_t_0 == 2 ){ sum_tt = sum_tt+"e"+nub_e_t;}
       if(data_comp_nub_e_t_0 == 3 ){ sum_ttt = sum_tt;}
       if(data_comp_sum_tt_0 == 3){ var sum_tt = 0 ;}       
   return sum_tt;
}

function m_mtx_reciprocal_div(B,A){    
   var AA = A;                                  
   var BB = B;   
      if(AA[0].length >= BB[0].length){
       var DD = m_new_zero_mtx(1,AA[0].length); }    
      else{ var DD = m_new_zero_mtx(1, BB[0].length);}   
   var DD =  m_mtx_copy_mtx(DD,BB);      
   var DR = m_mtx_divisor_10(AA);                
   var RR = m_new_zero_mtx(1,AA[0].length);     
   var QT = m_new_zero_mtx(1,1);                
   var data_cp = -1;
   var data_qt = "";
   var data_flag=0;
   var data_test=0 ;
   var ans =0;
   var data_test = m_mtx_compare_nub(DD,AA,0);          
     if(data_test==3){ var ans=1; 
                    return ans;}
   var data_tt = 0;
   var data_count = 2000 ;    
    for(var k=0 ; k< data_count ;k++){      
    for(var i=0 ; i< 10 ;i++){            
     var data_cp = m_mtx_compare_nub(DD,DR,i);         
    if( data_cp == 2){
      var data_tt = i-1;
      var data_ttt = data_tt.toString();
      var data_qt = data_qt + data_ttt;
      RR =  m_mtx_sub_nub_b(DD,DR,data_tt);        
      RR =m_mtx_shift_left_1(RR);                       
      DD = RR;
     var i=10 ; }   
     if( data_cp == 1 && i==9){
       var data_qt = data_qt + "9";
       RR =  m_mtx_sub_nub_b(DD,DR,9);        
       RR =m_mtx_shift_left_1(RR); 
       DD =RR;   
       var i=10 ;   
             } 
     if( data_cp == 3 ){
       var data_tt = i;
       var data_ttt = data_tt.toString();
       var data_qt = data_qt +  data_ttt;
       RR =  m_mtx_sub_nub_b(DD,DR,data_tt);
       var data_qt = data_qt.substr(0,1) + "." + data_qt.substr(1,data_qt.length-1);  
       var data_qt = m_mtx_trim(data_qt) ;
        return data_qt ; }} }  
       var data_qt = data_qt.substr(0,1) + "." + data_qt.substr(1,data_qt.length-1);
       var data_qt = data_qt.toString() ; 
       var data_qt = m_mtx_trim(data_qt) ;
   return data_qt ;
 }


function m_mtx_divisor_10(A){      
   var AA = m_mtx_cell_five(A);
   var NN = m_new_zero_mtx(10,AA[0].length);    
   var SS = m_new_zero_mtx(1,AA[0].length);    
   var i=0;
    for(var i=1; i< 10 ;i++){        
       SS = m_mtx_add(SS,AA);  
       NN = m_mtx_a_copy_to_n_b(SS,0,NN,i);  } 
  return NN;
}

function m_mtx_a_copy_to_n_b(A,nub_a,B,nub_b){       
  var AA = m_mtx_cell_five(A);
  var nub_a = parseInt(nub_a);  
  var mtx_lg = AA[0].length ;
  var mtx_lg_1 = mtx_lg +1  ;
  var mtx_lg_2 = mtx_lg +2  ;
  var NN = B;   
  var nub_b = parseInt(nub_b); 
   for(var i= 0  ; i < mtx_lg_2 ;i++){ 
     if(( i >= 0) && (i< mtx_lg)){ 
      var data_a = AA[nub_a][i];
       NN[nub_b][i] =  data_a; }
     if( i==mtx_lg){   NN[nub_b][i] = nub_b;}   
     if( i==mtx_lg_1){
       var data_a = AA[0][0];     
       var data_a_lg = data_a.length;
      NN[nub_b][i] =  data_a_lg;}
                                 }
return NN;
 }
 
function m_mtx_shift_left_1(A){               
   var AA = m_mtx_cell_five(A);            
   var NN = m_new_zero_mtx(1,AA[0].length);   
     for(var i= 0  ; i < AA[0].length ;i++){ 
     if( i==0){                        
       var data_a = AA[0][i];     
       var data_b = AA[0][i+1];
       var data_a = data_a.toString();
       var data_b = data_b.toString();
       NN[0][i] = data_a + data_b.substr(0,1);}
     if( i>0 && (i < AA[0].length-1)){
       var data_a = AA[0][i];     
       var data_b = AA[0][i+1];
       var data_a = data_a.toString();
       var data_b = data_b.toString();
       NN[0][i] = data_a.substr(1,4) + data_b.substr(0,1);}
     if( i == (AA[0].length-1)){
       var data_a = AA[0][i];     
       var data_a = data_a.toString();
        NN[0][i] = data_a.substr(1,4) +"0" ;} 
          }  
 return NN;
 }

function m_mtx_compare_nub(A,B,nub_b){          
  var AA =A;
  var BB =B;
  var nub =nub_b ;
  var ans_1 = 0;
  var data_a = 0;     
  var data_b = 0;
  var data_c = AA[0].length - 1;
    for(var i= 0  ; i < AA[0].length ;i++){ 
     var data_a = parseInt(AA[0][i]);     
     var data_b = parseInt(BB[nub][i]);
    if(data_a > data_b ){ var ans_1 = 1 ; return ans_1 ;}
    if(data_a < data_b ){ var ans_1 = 2 ; return ans_1 ;}
    if( (i== data_c) && ( data_a == data_b )){ var ans_1 = 3 ; return ans_1 ;}
      }
    return ans_1;
}

function m_mtx_compare(A,B){         
  var AA =A;
  var AA = m_mtx_cell_five(AA); 
  var BB =B;
  var BB = m_mtx_cell_five(BB);
  var ans_1 = 0;
  var data_a = 0;     
  var data_b = 0;
  var data_c = AA[0].length - 1;
   for(var i= 0  ; i < AA[0].length ;i++){ 
    var data_a = parseInt(AA[0][i]);     
    var data_b = parseInt(BB[0][i]);
   if(data_a > data_b ){ var ans_1 = 1 ; return ans_1 ;}
   if(data_a < data_b ){ var ans_1 = 2 ; return ans_1 ;}
   if( (i== data_c) && ( data_a == data_b )){ var ans_1 = 3 ; return ans_1 ;}
       }
    return ans_1;
}


function m_mtx_borrow(A){    
   var DD =A;
    for(var i= DD[0].length-1 ; i>0 ;i--){       
     var data_s =parseInt(DD[0][i]);
    if( data_s < 0){ 
      while(data_s < 0){                
        DD[0][i] =100000 + parseInt(DD[0][i]) ;  
        DD[0][i-1] = parseInt(DD[0][i-1]) -1; 
       var data_s =parseInt(DD[0][i]);}}}
  return DD;
}


function m_mtx_sub_nub_b(A,B,nub_b){      
 var AA =A;
 var BB =B;
 var nub =nub_b;
 var CC=m_new_zero_mtx(1,AA[0].length);  
  for(var i=0;i<AA[0].length ;i++){     
    var data_a=AA[0][i];
    var data_b=BB[nub][i];
    CC[0][i]=parseInt(data_a) - parseInt(data_b);}
    CC = m_mtx_borrow(CC);  
    CC = m_mtx_cell_five(CC); 
return CC;
}

function m_mtx_sub(A,B){      
 var AA =A;
 var BB =B;
 var CC=m_new_zero_mtx(1,AA[0].length);  
  for(var i=0;i<AA[0].length ;i++){     
    var data_a=AA[0][i];
    var data_b=BB[0][i];
     CC[0][i]=parseInt(data_a) - parseInt(data_b);}
     CC = m_mtx_borrow(CC);  
    CC = m_mtx_cell_five(CC);  
return CC;
}

function m_mtx_carry(A){       
  var SS =A;
   for(var i= SS[0].length-1 ; i>1 ;i--){         
    var data_s = SS[0][i].toString();
    var data_s_lng = data_s.length ;
   if( data_s_lng >5){  SS[0][i] = data_s.substr(data_s_lng-5,5);  
    var data_s_b = data_s.substr(0,data_s_lng-5); 
    SS[0][i-1] = parseInt(SS[0][i-1]) + parseInt(data_s_b); } } 
   return SS;
}

function m_mtx_add(A,B){      
 var AA =A;
 var BB =B;
 var CC=m_new_zero_mtx(1,AA[0].length);  
  for(var i=0;i<AA[0].length ;i++){     
    var data_a=AA[0][i];
    var data_b=BB[0][i];
    CC[0][i]=parseInt(data_a) + parseInt(data_b);  }
    CC = m_mtx_carry(CC);   
    CC = m_mtx_cell_five(CC);       
return CC;
}

function m_mtx_cell_five(A){     
     var AA=A;
     var data_row = AA.length;   
     var data_col=AA[0].length;  
        if(A==0){ return A;}
     var count_a = 1 ;
       while( count_a >= 1 ){
   for(var i=0 ;i< 3 ;i++){      
    for(var k=1; k< data_col ;k++){         
                var data_b = parseInt( AA[0][k]);
                var data_b_str = data_b.toString();
                       if(data_b_str.length >= 6 ){       
                          var data_c= data_b_str.substr(0,data_b_str.length-5);
                           AA[0][k-1] = m_mtx_int_add(AA[0][k-1],data_c);  
                           AA[0][k]=   data_b_str.substr(data_b_str.length-5,5 );  
                                              } 
                                  } 
                         } 
              for(var n=1 ;n< data_col; n++){                
                    var data_n = (AA[0][n]).toString();
                    var data_lg = data_n.length;
                       if(data_lg >=6){ var count_a = 1;                       
                                                  n = data_col ; }     
                       else{ var count_a =0;}                

                                             }   
               }  
           for(var m = 1 ;m< data_col; m++){                
                    var data_m = (AA[0][m]).toString();
                    var data_lg_m = data_m.length;
                       while(data_lg_m < 5){
                             AA[0][m]="0"+AA[0][m];
                               data_lg_m=data_lg_m+1;
                                             }
                                              }   
  return AA;
 }

function m_mtx_cell_five_int(A){      
  var AA=A;                           
  var data_row = AA.length;        
  var data_col=AA[0].length;       
  var count_a = 1 ;
  while( count_a >= 1 ){
   for(var i=0 ;i< 3 ;i++){      
    for(var k=0; k< data_col-1 ;k++){         
        var data_b = parseInt( AA[0][k]);
        var data_b_str = data_b.toString();
      if(data_b_str.length >= 6 && data_b > 0 ){       
        var data_c= data_b_str.substr(0,data_b_str.length-5);
           AA[0][k+1]= parseInt(AA[0][k+1]) + parseInt(data_c);  
           AA[0][k]=   data_b_str.substr(data_b_str.length-5,5 );  
                                              } 
                                  } 
                      } 
      for(var n=0 ;n< data_col-1; n++){                
         var data_b_n = parseInt( AA[0][n]);
         var data_n = (AA[0][n]).toString();
         var data_lg = data_n.length;
       if(data_lg >=6 &&  data_b_n >0){ var count_a = 1;                       
                                       n = data_col ; }     
       else{ var count_a =0;}                 
                                             }   
               }  
      for(var m = 0 ;m< data_col-1; m++){               
          var data_b_m = parseInt( AA[0][m]); 
          var data_m = (AA[0][m]).toString();
          var data_lg_m = data_m.length;
          var data_fst = data_m.substr(0,1);
           while(data_lg_m < 5 &&  data_b_m >=0 ){       
                 AA[0][m]="0"+AA[0][m];
                 data_lg_m=data_lg_m+1;
                                                            }

          while(data_lg_m < 6 &&  data_fst =="-" ){      
                 AA[0][m]="-0"+data_m.substr(1,data_lg-1);
                 data_lg_m=data_lg_m+1;
                                           }
                                             }   
  return AA;
 }

function m_mtx_cell_five_brow(A){      
  var AA=A;
  var data_row = AA.length;   
     var data_col=AA[0].length;  
      for(var i=0;i<data_row ;i++){
       for(var j= data_col-1;j > 0 ;j--){   
         var data_a = parseInt(AA[i][j]);
            while(data_a < 0){
              AA[i][j]=100000+parseInt(AA[i][j]) ;  
              AA[i][j-1]=parseInt(AA[i][j-1])-1 ;
                data_a = parseInt(AA[i][j]); 
                           }
                                         }
                                    }
     return AA ;
}

function m_mtx_value_col_max(A){        
   var AA=A;
  var data_row = AA.length;   
  var data_col=AA[0].length;  
  var col_nub = -1;
  var data_a = 0;    
   for(var i= 0 ; i < data_col ;i++){ 
       var data_a = parseInt(AA[0][i]);
      if( data_a !=0){
        var col_nub =i;
                     }
                          }
     return col_nub ;
}

function m_mtx_cell_five_brow_int(A){      
  var AA=A;
  var data_row = AA.length;   
  var data_col=AA[0].length;  
  var data_nub =  m_mtx_value_col_max(AA);        
     for(var j= 0 ; j < data_nub ;j++){       
         var data_a = parseInt(AA[0][j]);
       if(  data_a < 0){
       while(data_a < 0){
         AA[0][j]=100000 + parseInt(AA[0][j]) ;  
         AA[0][j+1]=parseInt(AA[0][j+1]) - 1 ;
             data_a = parseInt(AA[0][j]);   
                            } 
                                      } 
                                        } 
    return AA ;
}

function m_mtx_cell_five_show_int(A,B){      
    var AA=A;
    var data_row = AA.length;   
    var data_col=AA[0].length;  
    var data_str_a = "";
    var data_str_b = "";
    var data_str = "";
    var data_cunt = data_col-1;
       for(var i=0;i< data_cunt ;i++){  
        var data_a = AA[0][i];
        var data_a1= data_a.toString();
        var data_str_a =  data_a1 + data_str_a; 
        var data_str_a = data_str_a.toString();
                                      } 
      while(data_str_a.substr(0,1)=="0"){ data_str_a = data_str_a.substr(1,data_str_a.length);}  
        var data_str_b = m_mtx_cell_five_show(B);
        var data_str_b = data_str_b.toString();  
          if(data_str_a !="" ){
             data_str = data_str_a+ data_str_b.substr(1,data_str_b.length-1);  
                             }
          else{  data_str = "0"+ data_str_b.substr(1,data_str_b.length-1);}                 
     return data_str;
}

function m_mtx_cell_five_show(A){      
     var AA=A;
     var data_row = AA.length;   
     var data_col=AA[0].length;  
     var data_str = "";
      if(AA[0][0].toString() == "-0"){  AA[0][0]="-00000";}  
         for(var i=(data_row-1) ;i >=0  ;i--){       
         for(var j=(data_col-1);j >=0 ;j--){  
             var data_a= AA[i][j];
             var data_b= data_a.toString();
           while( data_b.length < 5  &&  AA[i][j] >= 0){   
                  data_b="0"+data_b;                      
                    }
           while( data_b.length < 6  &&  AA[i][j] < 0){    
                  data_b=data_b.substr(0,1)+"0"+data_b.substr(1,data_b.length-1);    
                      }
             var data_str=  data_b +data_str ;
                                      }  
                                        } 
             var data_result = AA[0][0].toString();
             var data_result_lg = data_result.length;
                if(data_result_lg <= 5 && AA[0][0] >=0){
                       data_str ="0."+data_str ;  
                                           }
              else if(data_result_lg <= 6 && AA[0][0] < 0){       
                      data_str ="-0."+data_str.substr(1,data_str.length) ;  
                                           }
              else if(data_result_lg > 5 && AA[0][0] < 0) {data_str = data_str.substr(0,data_result.length-5)+"."+data_str.substr(data_result.length-5,data_str.length);}  
              else{data_str = data_str.substr(0,data_result.length-5)+"."+data_str.substr(data_result.length-5,data_str.length);}  
             while(data_str.substr(data_str.length-1,1)=="0"){
                var data_str = data_str.substr(0,data_str.length-1);}  
                var data_t_fst = data_str.substr(0,1);
                var data_t_sec = data_str.substr(1,1);
             if(data_t_fst=="." ){  var data_str="0"+data_str ; }    
             if(data_t_fst=="-" && data_t_sec=="."){  var data_str="-0."+ data_str.substr(2,(data_str.length-2)) ; }     
        var data_str = m_mtx_trim(data_str) ;    
     return data_str;
}

function m_mtx_insert_blank(A,row_nub){      
     var AA = A;
   var nub = row_nub;
   var data_row = AA.length;   
   var data_col = AA[0].length;  
   var BB= m_new_zero_mtx(data_row+1,data_col);              
   var data_nub=0;
   var data_shift=0; 
     for(var i = 0 ; i < data_row; i++){
       for(var j = 0 ; j < data_col; j++){ 
         if(i >= nub){ var data_nub = 1;}
           var data_shift =  i + data_nub;
         BB[data_shift][j]= AA[i][j];
                                          }
                                     }
  
         return BB;
}

function m_mtx_insert_blank_col(A,col_nub){      
     var AA = A;
     var nub = col_nub;
     var data_row = AA.length;   
     var data_col = AA[0].length;  
     var BB= m_new_zero_mtx(data_row,data_col+1);             
     for(var i = 0 ; i < data_row; i++){       
          var data_nub=0;
          var data_shift=0; 
        for(var j = 0 ; j < data_col; j++){ 
          if(j >= nub){ var data_nub = 1;}
            var data_shift =  j + data_nub;
            BB[i][data_shift]= AA[i][j];
                                        }
                                      }
     
         return BB;
}

function m_mtx_update_col_index(A,col_nub){      
     var AA = A;
    var nub = parseInt(col_nub);
    var data_row = AA.length;   
    var data_col = AA[0].length;  
     for(var i = 0 ; i < data_row; i++){       
       for(var j = 0 ; j < data_col; j++){ 
          if(j == nub){  
             AA[i][j]= i;
                       }                  
                                           }

                                      }
   
         return AA;
}

function m_mtx_delete_one(A,row_nub){      
var AA = A;
    var nub = row_nub;
    var data_row = AA.length;   
    var data_col = AA[0].length;  
    var BB= m_new_zero_mtx(data_row-1,data_col);             
    var data_nub=0;
    var data_shift=0; 
     for(var i = 0 ; i < data_row-1; i++){
       for(var j = 0 ; j < data_col; j++){ 
         if(i >= nub){ var data_nub = 1;}
            var data_shift =  i + data_nub;
            BB[i][j]= AA[data_shift][j];
                                          }
                                     }
        return BB;
}

function m_mtx_sort_col_nub( X ,col_nub ,property){      
    var AA = X;
     var nub = col_nub;
     var ad = property;
     var data_row = AA.length;   
     var data_col = AA[0].length;  
     var BB= m_new_zero_mtx(1,data_col);             
  for(var k=0; k< data_row+1 ; k++){      
       for(var i=0; i< data_row ; i++){      
           var data_i_up = AA[i][nub];
             if( i < (data_row -1)){    
                var data_i_down = AA[i+1][nub];
                                } 
      if(i< data_row-1){       
          var data_comp_a  =  m_mtx_real_str_comp(data_i_up ,data_i_down);      
            if(ad=="A"){             
            if( data_comp_a  == 2 ){        
                for(var j=0;j <data_col;j++){
                    BB[0][j]=AA[i][j] ;            
                    AA[i][j] = AA[i+1][j];          
                    AA[i+1][j]= BB[0][j];
                                                }  
                                                       }      
                 
                         }   
            if(ad !="A"){           
            if(  data_comp_a  == 1 ){     
              for(var j=0;j <data_col;j++){
                    BB[0][j]=AA[i][j] ;            
                    AA[i][j] = AA[i+1][j];          
                    AA[i+1][j]= BB[0][j];
                                             }  
                                                       }      
                  
                         }   
                         }  
            if( i == (data_row-1) ){              
               var data_i_upup = AA[i-1][nub];    
               var data_comp_b  =  m_mtx_real_str_comp(data_i_upup ,data_i_up);      
               if((data_comp_b ==2  && ad=="A")||       
                  (data_comp_b ==1  && ad != "A")){         
                    for(var j=0;j <data_col;j++){
                       BB[0][j]=AA[i-1][j] ;    
                       AA[i-1][j] = AA[i][j];  
                       AA[i][j]= BB[0][j];
                                                } 

                                       }   

                                            }  

                                      }   

                                        }    
 
   return AA;
    }
  
function m_exp_ln(x){              
  var xx = x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(xx,"Msg") ;  
    if(data_msg >=1){ var ans_a = xx ; return  ans_a ;}   
  var xx = m_str_e_to_str_point(xx );      
  var xx_e = m_mtx_str_to_e(xx);             
  var xx_e = m_mtx_str_to_e_a(xx_e); 
  var nub_x = m_str_power(xx_e ,0);     
  var xx_e_st = m_str_power(xx_e ,1);  
  var xx_e_st_fst=xx_e_st.substr(0,1);  
  var  data_xx_comp_0 = m_mtx_real_str_comp(xx_e_st,0);     
    if ( data_xx_comp_0 == 3){ var ans_t = message_1(13) ;  return ans_t;}
    if (xx_e_st_fst == "-") {  var ans_t = message_1(5); return ans_t;} 
   return xx ; }
function m_ln_exp(x){    
   var xx=x.toString().trim();
   var data_msg =  m_str_char(x,"Msg") ;                     
    if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx = m_str_e_to_str_point(xx );     
   var xx = m_fix(xx,FIX_COL);  
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);           
   var p_comp_datalg  =  m_mtx_real_str_comp(xx_test_nub_e,201);        
     if( p_comp_datalg ==1  ){
   var ans_1 = message_1(23);return  ans_1  }     
   var xx = m_str_e_to_str(xx);     
   return xx ;
        }
function m_sin_asin(x){             
   var zz = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var zz = m_str_e_to_str_point(zz );     
   var zz = m_fix(zz,FIX_COL) ;   
   var xx_test_small = m_mtx_str_to_e_a(zz);              
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
   var ans_a= message_1(1);  return ans_a;} 
   var zz_fst=zz.substr(0,1);
   if(zz_fst=="-"){
      var zz = zz.substr(1,zz.length-1);}
  var data_comp_zz_1   =  m_mtx_real_str_comp(zz,1);       
      if(data_comp_zz_1 ==1 ) {  var ans_1= message_1(1);  return ans_1; }     
   return x ;}
  
function m_sin_acos(x){              
   var zz = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var zz = m_str_e_to_str_point(zz );     
   var zz = m_fix(zz,FIX_COL) ;   
   var xx_test_small = m_mtx_str_to_e_a(zz);              
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
   var ans_a= message_1(1);  return ans_a;}  
   var zz_fst=zz.substr(0,1);
   if(zz_fst=="-"){
   var zz = zz.substr(1,zz.length-1);}
   var data_comp_zz_1   =  m_mtx_real_str_comp(zz,1);       
    if(data_comp_zz_1 ==1 ) {  var ans_1= message_1(1);  return ans_1; }  
   var data_a = m_mtx_real_mul(zz,zz);    
   var data_b = m_mtx_real_sub(1,data_a); 
   var data_c = m_pow(data_b,0.5);         
     return data_c;}


function m_sin_atan(x){                
   var xx = x.toString().trim();
       PIDIV2=m_fix(PIDIV2,FIX_COL);  
       PIDIV4=m_fix(PIDIV4,FIX_COL);  
   var data_msg = 0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx =m_mtx_trim(xx) ; 
   var xx = m_str_e_to_str_point(xx );     
   var xx = m_mtx_str_to_e_a(xx);          
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
   var xx_fst = xx.substr(0,1);
    if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
    else { var xx=xx;} 
   var data_a = m_mtx_real_mul(xx,xx);     
   var data_b = m_mtx_real_add(1,data_a);  
   var data_c = m_pow(data_b,0.5);         
   var data_d = m_mtx_real_div(xx,data_c);
   if(xx_fst =="-"){ var data_d ="-"+data_d;}
   return data_d;}  


 function m_asin_sin(x){ 
   var xx=x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}       
   var xx =m_mtx_trim(xx) ;
   var xx_af =0;
   var xx_af_p =0; 
   var xx_af_e =0; 
   var ans_1 = "";
   var ans_a = "";
   var ans_a_s = "";
   var flag_1_2=0; 
   var flag_3_4=0; 
   var xx_fst ="" ;
   var idx_e = xx.indexOf("e");
     if( idx_e >0){
     var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
     var xx_af_p =  m_str_char(xx_af,".") ;   
     var xx_af_e =  m_str_char(xx_af,"e") ;     
        if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
        if(xx_af_p >=2 || xx_af_e>=1){ 
     var ans_1 = message_1(30);  return  ans_1;}  }                          
    var xx = m_mtx_str_to_e_a(xx);            
    var xx_test_small = xx;                      
    var xx_test_nub_e =m_str_power(xx_test_small,0);             
     if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   return  ans_1 ; }
   var xx_fst = xx.substr(0,1);                                          
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }  
    PIDIV2= m_fix(PIDIV2,FIX_COL); 
    PIMUL2 = m_fix(PIMUL2,FIX_COL); 
    SQRT2 = m_fix(SQRT2,FIX_COL);
   var com_zz_pidiv2 =0;
    var zz = m_mtx_real_div(xx,PIMUL2); 
    var zz = m_str_e_to_str(zz);   
    var zz_m = m_nub_m(zz) ;        
    var zz_p = m_nub_p(zz) ;  
    var zz_m = m_mtx_trim(zz_m) ;  
    var zz_p = m_mtx_trim(zz_p) ;
    var zz_p_t=m_fix(zz_p,200);       
    var zz_p_t =m_mtx_trim(zz_p_t) ; 
    if( zz_p_t >='0.75' && zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1,zz_p_t); var zz_p = m_mtx_real_sub(1,zz_p); var flag_3_4=1 ; }  
    else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t,0.5); var zz_p = m_mtx_real_sub(zz_p,0.5); var flag_3_4=1 ; }  
    else if( zz_p_t >='0.25' && zz_p_t <'0.5'){ var zz_p_t = m_mtx_real_sub(0.5,zz_p_t);var zz_p = m_mtx_real_sub(0.5,zz_p); var flag_1_2=1 ; } 
    else if( zz_p_t <'0.25'){ var zz_p = zz_p ;var flag_1_2=1 ; }  
     var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);     
     if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_2=1 ;}   
      else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }  
    if(xx_fst !="-" && flag_3_4 ==1){ var data_cle_b ="-"+data_cle_b;}
    else if(xx_fst =="-" && flag_1_2 ==1){ var data_cle_b ="-"+data_cle_b;} 
    else { var data_cle_b = data_cle_b;}
     return data_cle_b ; }

function m_asin_cos(x){     
  var xx=x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
    if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
  var xx =m_mtx_trim(xx) ;
  var xx_af =0;
  var xx_af_p =0; 
  var xx_af_e =0; 
  var ans_1 = "";
  var ans_a = "";
  var ans_a_s = ""; 
  var flag_2_3=0; 
  var flag_1_4=0; 
  var xx_fst ="" ;
  var idx_e = xx.indexOf("e");
    if( idx_e >0){
      var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
      var xx_af_p =  m_str_char(xx_af,".") ;   
      var xx_af_e =  m_str_char(xx_af,"e") ;     
    if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
    if(xx_af_p >=2 || xx_af_e>=1){ 
      var ans_1 = message_1(30);  return  ans_1;}  }                          
  var xx = m_mtx_str_to_e_a(xx);            
  var xx_test_small = xx;             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
    if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   return  ans_1 ; } 
  var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }   
       PIDIV2= m_fix(PIDIV2,FIX_COL); 
      PIMUL2 = m_fix(PIMUL2,FIX_COL); 
  var com_zz_pidiv2 =0;
  var zz = m_mtx_real_div(xx,PIMUL2);  
  var zz = m_str_e_to_str(zz);   
  var zz_m = m_nub_m(zz) ;         
  var zz_p = m_nub_p(zz) ;  
  var zz_m = m_mtx_trim(zz_m) ;  
  var zz_p = m_mtx_trim(zz_p) ; 
  var zz_p_t=m_fix(zz_p,200);            
  var zz_p_t =m_mtx_trim(zz_p_t) ;   
   if( zz_p_t >='0.75'&& zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1,zz_p_t); var zz_p = m_mtx_real_sub(1,zz_p); var flag_1_4=1;  }   
   else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t,0.5); var zz_p = m_mtx_real_sub(zz_p,0.5); var flag_2_3=1 ; }   
   else if( zz_p_t >='0.25'&& zz_p_t <'0.5' ){ var zz_p_t = m_mtx_real_sub(0.5,zz_p_t); var zz_p = m_mtx_real_sub(0.5,zz_p);var flag_2_3=1 ; } 
   else if( zz_p_t <'0.25'){var zz_p =  zz_p ;var flag_1_4=1 ; }   
 var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);      
   if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_4=1 ;}   
   else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }        
 var ans_a = m_mtx_real_sub(PIDIV2,data_cle_b);
   if( flag_2_3 ==1){ var ans_a ="-"+ans_a;} 
   if( flag_1_4 ==1){ var ans_a = ans_a;} 
     return ans_a ; }
  
 function m_cos_asin(x){               
   var zz = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var zz = m_str_e_to_str_point(zz );     
   var zz = m_fix(zz,FIX_COL) ;   
   var xx_test_small = m_mtx_str_to_e_a(zz);              
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
   var ans_a= message_1(1);  return ans_a;}  
   var zz_fst=zz.substr(0,1);
    if(zz_fst=="-"){
   var zz = zz.substr(1,zz.length-1);}
   var data_comp_zz_1   =  m_mtx_real_str_comp(zz,1);       
      if(data_comp_zz_1 ==1 ) {  var ans_1= message_1(1);  return ans_1; }     
   var x_fst=x.substr(0,1);
        if(x_fst=="-"){
   var x = x.substr(1,x.length-1);}  
   var data_a = m_mtx_real_mul(x,x);     
   var data_b = m_mtx_real_sub(1,data_a); 
   var data_c = m_pow(data_b,0.5);        
      return data_c;}
 
function m_cos_atan(x){                
   var xx = x.toString().trim();
       PIDIV2=m_fix(PIDIV2,FIX_COL);  
       PIDIV4=m_fix(PIDIV4,FIX_COL);  
   var data_msg = 0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx =m_mtx_trim(xx) ; 
   var xx = m_str_e_to_str_point(xx );     
   var xx = m_mtx_str_to_e_a(xx);          
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
   var xx_fst = xx.substr(0,1);
    if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
    else { var xx=xx;} 

      var data_a = m_mtx_real_mul(xx,xx);     
      var data_b = m_mtx_real_add(1,data_a); 
      var data_c = m_pow(data_b,0.5);         
      var data_d = m_mtx_real_div(1,data_c);
  return data_d;} 
 function m_cos_acos(x){  var xx = x.toString().trim();
   var data_msg =0;
   var ans_a="";  
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
      var ans_a= message_1(2);  return ans_a;}      
   var xx =m_mtx_trim(xx) ;
   var xx = m_str_e_to_str_point(xx );      
       xx = m_str_e_to_str(xx);  
   var xx_fst = xx.substr(0,1);
     if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
     else { var xx=xx;}                     
   var ans_1=0;
   var data_comp_xx_0   =  m_mtx_real_str_comp(xx,0); 
   var data_comp_xx_1   =  m_mtx_real_str_comp(xx,1);      
   var data_comp_x_1    =  m_mtx_real_str_comp(x,1); 
   var data_comp_x_n1   =  m_mtx_real_str_comp(x,-1);
     if( data_comp_xx_1==1){  var ans_1= message_1(2);  return ans_1; }   
     if(xx_fst=="-"){ var xx="-"+xx;}  
     else{var xx=xx;}
   return xx ; }

function m_acos_cos(x){          
  var xx=x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
    if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
  var xx =m_mtx_trim(xx) ;
  var xx_af =0;
  var xx_af_p =0; 
  var xx_af_e =0; 
  var ans_1 = "";
  var ans_a = "";
  var ans_a_s = "";
   var xx_fst ="" ;
  var idx_e = xx.indexOf("e");
    if( idx_e >0){
      var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
      var xx_af_p =  m_str_char(xx_af,".") ;   
      var xx_af_e =  m_str_char(xx_af,"e") ;     
    if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
    if(xx_af_p >=2 || xx_af_e>=1){ 
      var ans_1 = message_1(30);  return  ans_1;}  }                          
  var xx = m_mtx_str_to_e_a(xx);            
  var xx_test_small = m_mtx_str_to_e_a(xx);             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
    if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   return  ans_1 ; }  
  var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }   
      PIDIV2= m_fix(PIDIV2,FIX_COL); 
      PIMUL2 = m_fix(PIMUL2,FIX_COL);
   var com_zz_pidiv2 =0;
   var zz = m_mtx_real_div(xx,PIMUL2);  
   var zz = m_str_e_to_str(zz);   
   var zz_m = m_nub_m(zz) ;         
   var zz_p = m_nub_p(zz) ;  
    var zz_m = m_mtx_trim(zz_m) ;  
    var zz_p = m_mtx_trim(zz_p) ; 
    var zz_p_t=m_fix(zz_p,200);            
    var zz_p_t =m_mtx_trim(zz_p_t) ;
      if( zz_p_t >'0.5' &&  zz_p_t <= '1'){  var zz_p = m_mtx_real_sub(1,zz_p);  }   
      else{ var zz_p =zz_p;}
     var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p);     
     var ans_t= data_cle_b;
   return ans_t ; }

function m_acos_sin(x){            
  var xx=x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}       
   var xx =m_mtx_trim(xx) ;
   var xx_af =0;
   var xx_af_p =0; 
   var xx_af_e =0;
   var ans_1 = "";
   var ans_a = "";
   var ans_a_s = "";
   var flag_1_2=0; 
   var flag_3_4=0; 
   var xx_fst ="" ;  
   var idx_e = xx.indexOf("e");
     if( idx_e >0){
     var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
     var xx_af_p =  m_str_char(xx_af,".") ;   
     var xx_af_e =  m_str_char(xx_af,"e") ;     
        if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
        if(xx_af_p >=2 || xx_af_e>=1){ 
     var ans_1 = message_1(30);  return  ans_1;}  }                          
  var xx = m_mtx_str_to_e_a(xx);            
  var xx_test_small = xx;                      
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
    if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   return  ans_1 ; } 
  var xx_fst = xx.substr(0,1);                                           
    if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }  
    PIDIV2= m_fix(PIDIV2,FIX_COL); 
    PIMUL2 = m_fix(PIMUL2,FIX_COL);
    SQRT2 = m_fix(SQRT2,FIX_COL); 
  var com_zz_pidiv2 =0;
  var zz = m_mtx_real_div(xx,PIMUL2); 
  var zz = m_str_e_to_str(zz);   
  var zz_m = m_nub_m(zz) ;        
  var zz_p = m_nub_p(zz) ;  
  var zz_m = m_mtx_trim(zz_m) ;  
  var zz_p = m_mtx_trim(zz_p) ;
  var zz_p_t=m_fix(zz_p,200);       
  var zz_p_t =m_mtx_trim(zz_p_t) ; 
    if( zz_p_t >='0.75' && zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1,zz_p_t); var zz_p = m_mtx_real_sub(1,zz_p); var flag_3_4=1 ; }  
    else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t,0.5); var zz_p = m_mtx_real_sub(zz_p,0.5); var flag_3_4=1 ; } 
  else if( zz_p_t >='0.25' && zz_p_t <'0.5'){ var zz_p_t = m_mtx_real_sub(0.5,zz_p_t);var zz_p = m_mtx_real_sub(0.5,zz_p); var flag_1_2=1 ; }  
    else if( zz_p_t <'0.25'){ var zz_p = zz_p ;var flag_1_2=1 ; }  
  var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);      
   if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_2=1 ;}   
   else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }  
  var ans_t ="";
   if(flag_1_2==1 && xx_fst !="-"){
     var ans_t = m_mtx_real_sub(PIDIV2,data_cle_b);}
   if(flag_1_2==1 && xx_fst !="-"){
     var ans_t = m_mtx_real_add(PIDIV2,data_cle_b);}  
   if(flag_3_4==1 && xx_fst !="-"){
     var ans_t = m_mtx_real_add(PIDIV2,data_cle_b);}  
   if(flag_3_4==1 && xx_fst =="-"){
     var ans_t = m_mtx_real_sub(PIDIV2,data_cle_b);}
   else {var ans_t = m_mtx_real_add(PIDIV2,data_cle_b);}
   return ans_t ; }    
   
function m_tan_asin(x){                
   var zz = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var zz = m_str_e_to_str_point(zz );     
   var zz = m_fix(zz,FIX_COL) ;   
   var xx_test_small = m_mtx_str_to_e_a(zz);              
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
   var ans_a= message_1(1);  return ans_a;}  
   var zz_fst=zz.substr(0,1);
   if(zz_fst=="-"){
   var zz = zz.substr(1,zz.length-1);}
   var data_comp_zz_1   =  m_mtx_real_str_comp(zz,1);       
      if(data_comp_zz_1 ==1 ) {  var ans_1= message_1(1);  return ans_1; }  
   var x_fst=x.substr(0,1);
        if(x_fst=="-"){
   var x = x.substr(1,x.length-1);}  
   var data_a = m_mtx_real_mul(x,x);     
   var data_b = m_mtx_real_sub(1,data_a); 
   var data_c = m_pow(data_b,0.5);        
   var data_d = m_mtx_real_div(x,data_c); 
     if(x_fst=="-"){var data_d ="-"+ data_d ;}
   return data_d;}

  function m_tan_acos(x){   
  var xx = x.toString().trim();
   var data_msg =0;
   var ans_a="";  
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
     if((m_mtx_real_str_comp(xx_test_nub_e,0)==1 )&& (m_mtx_real_str_comp(xx_test_st,0)!=3  )){  
      var ans_a= message_1(2);  return ans_a;}      
   var xx =m_mtx_trim(xx) ;
   var xx = m_str_e_to_str_point(xx );      
       xx = m_str_e_to_str(xx); 
   var xx_fst = xx.substr(0,1);
     if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
     else { var xx=xx;}  
   var ans_1=0;
   var data_comp_xx_0   =  m_mtx_real_str_comp(xx,0); 
   var data_comp_xx_1   =  m_mtx_real_str_comp(xx,1);      
   var data_comp_x_1    =  m_mtx_real_str_comp(x,1); 
   var data_comp_x_n1   =  m_mtx_real_str_comp(x,-1);
     if( data_comp_xx_1==1){  var ans_1= message_1(2);  return ans_1; }   
     if(xx_fst=="-"){ var xx="-"+xx;}  
      else{var xx=xx;}

      var data_a = m_mtx_real_mul(xx,xx);     
      var data_b = m_mtx_real_sub(1,data_a); 
      var data_c = m_pow(data_b,0.5);        
      var data_d = m_mtx_real_div(data_c,xx); 
   return data_d ; }   


function m_tan_atan(x){
   var xx = x.toString().trim();
   var data_msg = 0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx =m_mtx_trim(xx) ; 
   var xx = m_str_e_to_str_point(xx );     
   var xx = m_mtx_str_to_e_a(xx);          
   var xx_test_small = m_mtx_str_to_e_a(xx);             
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1);          
   return xx ; }
function m_atan_tan(x){     
 var xx=x.toString().trim();
 var data_msg =0;
 var data_msg =  m_str_char(x,"Msg") ;  
    if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
 var xx =m_mtx_trim(xx) ;
 var xx_af =0;
 var xx_af_p =0; 
 var xx_af_e =0; 
 var ans_1 = "";
 var ans_a = "";
 var ans_a_s = "";  
 var flag_2_4=0; 
 var flag_1_3=0; 
 var xx_fst ="" ; 
 var idx_e = xx.indexOf("e");
   if( idx_e >0){
     var xx_af = xx.substr(idx_e+1,xx.length-idx_e);   
     var xx_af_p =  m_str_char(xx_af,".") ;   
     var xx_af_e =  m_str_char(xx_af,"e") ;     
   if(xx_af_p ==1){  var xx = m_str_e_to_str_point(x); }
   if(xx_af_p >=2 || xx_af_e>=1){ 
     var ans_1 = message_1(30);  return  ans_1;} }                          
  var xx = m_mtx_str_to_e_a(xx);           
  var data_cle =0;     
  var xx_test_small = xx;             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
  var xx_test_st = m_str_power(xx_test_small,1);          
   if(m_mtx_real_str_comp(xx_test_nub_e,200)==1 ){ var ans_1 = message_1(16);   return  ans_1 ; } 
  var xx_fst = xx.substr(0,1);
      if(xx_fst =="-"){ var xx = xx.substr(1,xx.length-1); }  //20211223
  var com_zz_pidiv2 =0;
  
     var zz = m_mtx_real_div(xx,PIMUL2); 
     var zz = m_str_e_to_str(zz);   
     var zz_m = m_nub_m(zz) ;         
     var zz_p = m_nub_p(zz) ;  
     var zz_m = m_mtx_trim(zz_m) ;  
     var zz_p = m_mtx_trim(zz_p) ; 
     var flag_2_4=0 ;    
     var flag_1_3=0 ;
     var zz_p_t=m_fix(zz_p,200);   
     var zz_p_t =m_mtx_trim(zz_p_t) ; 
     if( zz_p_t =='0.25'|| zz_p_t =='0.75'){  var ans_1 = message_1(11);  return ans_1 ;  }
     if( zz_p_t >='0.75' && zz_p_t <'1'){ var zz_p_t = m_mtx_real_sub(1 ,zz_p_t); var zz_p = m_mtx_real_sub(1 ,zz_p); var flag_2_4=1 ; }    
     else if( zz_p_t >='0.5' && zz_p_t <'0.75'){ var zz_p_t = m_mtx_real_sub(zz_p_t ,0.5); var zz_p = m_mtx_real_sub(zz_p ,0.5); var flag_1_3=1 ; }  
     else if( zz_p_t >='0.25' && zz_p_t <'0.5'){ var zz_p_t = m_mtx_real_sub(0.5 ,zz_p_t); var zz_p = m_mtx_real_sub(0.5 ,zz_p);  var flag_2_4=1 ; } 
     else if( zz_p_t <'0.25'  ){  var zz_p =zz_p;var flag_1_3=1 ; } 
      var com_zz_pidiv2 = m_mtx_real_str_comp(xx, PIDIV2);  
     if(com_zz_pidiv2 !=1 ){var data_cle_b = xx; var flag_1_3=1 ;}   
      else{ var data_cle_b = m_mtx_real_mul(PIMUL2,zz_p); }  
   if(xx_fst =="-" && flag_1_3 ==1){ var data_cle_b ="-"+data_cle_b;}
   if(xx_fst !="-" && flag_2_4 ==1){ var data_cle_b ="-"+data_cle_b;}
      return data_cle_b ;  }
function m_sinh_asinh(x){ 
   var xx = x.toString().trim();
   var data_msg = 0;
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}                                   
   var xx =m_mtx_trim(xx) ;
   var xx = m_str_e_to_str_point(xx );     
   var xx = m_str_e_to_str(xx);      
   return xx ;  }
 function m_asinh_sinh(x){ 
  var xx = x.toString().trim();
  var data_msg =0;
  var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}                                 
  var xx =m_mtx_trim(xx) ;  
  var xx = m_str_e_to_str_point(xx );           
  var xx_test_small = m_mtx_str_to_e_a(xx);             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
    if(m_mtx_real_str_comp(xx_test_nub_e,201)==1 ){ 
    var ans_a= message_1(24) ; return  ans_a;}     
   return xx ;}
 
function m_cosh_acosh(x){ 
   var xx = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
      if(data_msg >=1){ var ans_a = x ; return  ans_a ;}                                       
   var xx =m_mtx_trim(xx) ;    
   var xx = m_str_e_to_str_point(xx );     
   var xx_fst = xx.substr(0,1);
    if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
     else { var xx=xx;}  
    if( m_mtx_real_str_comp(xx,1)==2 || xx_fst=="-" ){ var ans_1= message_1(3);  return ans_1 ;}      
   return x ;}
      
function m_acosh_cosh(x){ 
   var xx = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
  var xx =m_mtx_trim(xx) ;
  var xx = m_str_e_to_str_point(xx );     
    
  var xx_test_small = m_mtx_str_to_e_a(xx);             
  var xx_test_nub_e =m_str_power(xx_test_small,0);             
     if(m_mtx_real_str_comp(xx_test_nub_e,201)==1 ){ 
          var ans_a= message_1(25) ; return  ans_a;} 
   var xx_fst = xx.substr(0,1);
       if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
        else { var xx=xx;}
    return xx ; }
    
function m_tanh_atanh(x){         
   var xx = x.toString().trim();
   var xx_s =xx;
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
     if(data_msg >=1){ var ans_a = x ; return  ans_a ;}                                   
   var xx =m_mtx_trim(xx) ; 
   var xx = m_str_e_to_str_point(xx );     
   var xx_test_small = m_mtx_str_to_e_a(xx);              
   var xx_test_nub_e =m_str_power(xx_test_small,0);             
   var xx_test_st = m_str_power(xx_test_small,1); 
   var xx_fst = xx.substr(0,1);
       if(xx_fst=="-"){ var xx=xx.substr(1,xx.length-1);}   
        else { var xx=xx;}    
       xx = m_str_e_to_str(xx);      
    var comp_xx_0 = m_mtx_real_str_comp(xx,0);
    var comp_xx_1 = m_mtx_real_str_comp(xx,1);    
    var comp_xx_n1 = m_mtx_real_str_comp(xx,-1);    
      if( comp_xx_n1 == 2 || comp_xx_1 ==1 ){ var ans_1= message_1(4);  return ans_1 ;}    
      if( comp_xx_n1 == 3 || comp_xx_1 ==3 ){ var ans_1= message_1(4);  return ans_1 ;}    
    var comp_xx_1 = m_mtx_real_str_comp(xx,1); 
    var data_test_up = m_mtx_real_sub('1','1e-9999');     
    var comp_xx_data_test_up = m_mtx_real_str_comp(xx,data_test_up); 
     if((comp_xx_1==2)&& (comp_xx_data_test_up ==1)){                   
    var ans_1= message_1(15);  return ans_1 ; }
   return xx_s ;}
  function m_atanh_tanh(x){                 
   var xx = x.toString().trim();
   var data_msg =0;
   var data_msg =  m_str_char(x,"Msg") ;  
       if(data_msg >=1){ var ans_a = x ; return  ans_a ;}   
   var xx =m_mtx_trim(xx) ;
  return xx ; }
 
 function m_replace_eq(x){                       
    var xx = x.toString().trim();
    var xx = xx.replace(/\)π/g , "\)\*π");   
    var xx = xx.replace(/\)\°/g , "\)\*°");
    var xx = xx.replace(/0π/g , "0\*π");   
    var xx = xx.replace(/1π/g , "1\*π");   
    var xx = xx.replace(/2π/g , "2\*π");   
    var xx = xx.replace(/3π/g , "3\*π");   
    var xx = xx.replace(/4π/g , "4\*π");   
    var xx = xx.replace(/5π/g , "5\*π");   
    var xx = xx.replace(/6π/g , "6\*π");   
    var xx = xx.replace(/7π/g , "7\*π");   
    var xx = xx.replace(/8π/g , "8\*π");   
    var xx = xx.replace(/9π/g , "9\*π");   
    var xx = xx.replace(/\°π/g , "\°\*π");  
    var xx = xx.replace(/π\°/g , "π*\°");
  return xx ; }  

 function calculate(item_1){
 s_chang_visible_all();          
             MTX_COL = m_deci_dgt();
             DECI_DGT = m_deci_dgt_1(); 
             FIX_COL = m_add_sub_fix_cols();
              m_gol_fix(); 
          var str_part_lg= string_lg_1();             
          var str_cursor_pos = cursor_position();     
        if(str_part_lg >str_cursor_pos){  
                cursor_sec_recal_t( );                
                                         } 
          var item_a=calc.input.value;  
          var it = calc.input.value;
          var this_s = it.toString().trim();           
          var this_it = m_del4_2f_char(it,';').toString().trim();        
          var this_it_s = this_it; 
          var this_it = mtx_str_inpt_chk_bf(this_it);
                var nub_Msg = m_str_char(this_it,"Msg") ;      
                if(nub_Msg !=0){
                         document.getElementById('input').value+=" "+this_it +";";
                   newline_1(); 
                   scroll_cursor();
                      return;}
         var this_function = this_it;                                                      
         var this_it =  m_str_spec_part_af_minus_sum(this_it); 
         var this_it = m_replace_eq(this_it);
         var this_it_copy =  this_it ;                            
         var this_it_copy = this_it_copy.replace(/asinh/g , "arsinh");    
         var this_it_copy = this_it_copy.replace(/acosh/g , "arcosh");    
         var this_it_copy = this_it_copy.replace(/atanh/g , "artanh"); 
              if(this_function!=this_it_copy && this_it_copy !="" && this_it_copy !=0){ var function_data="="+this_it_copy;}   
              else{ var function_data ="";} 
          var this_it = m_str_sub_ngt_bf(this_it); 
          var this_it = m_str_math_replacec(this_it);   
          var this_it =  m_oct_nb(this_it);                 
          var data_chk1 = s_check_str_char(this_it_s,"(" );   
          var data_chk2 = s_check_str_char(this_it_s,")" );   
               if((data_chk1 - data_chk2) !=0){
                       document.getElementById('input').value+=" "+"<- error'('!= ')'->"+";"; 
                        var value_copy=" "+"<- error'('!= ')'->"+";"; 
                        BACK_MTX[0][BACK_COUNT] = value_copy+"_";              
                        BACK_COUNT = BACK_COUNT+1; 
                   newline_1(); 
                   scroll_cursor();
                      return;
                                          }
              var data_equal = s_check_str_equal(this_it_s);    
                 if(data_equal > 0){
                  document.getElementById('input').value+=" "+"<- sorry '=' or ' ' no support->"+";";
                   var value_copy=" "+"<- sorry '=' or ' ' no support->"+";"; 
                   BACK_MTX[0][BACK_COUNT] = value_copy+"_";              
                    BACK_COUNT = BACK_COUNT+1;
                    newline_1(); 
                    scroll_cursor();
                       return;
                                          }
            
              var data_equation =  s_check_str_equation(this_it );   
                  if(data_equation !="" || data_equation ==null){
                      document.getElementById('input').value+=" "+"<- sorry 'equation' no support->"+";";
                      var value_copy=" "+"<- sorry 'equation' no support->"+";";
                    BACK_MTX[0][BACK_COUNT] = value_copy+"_";              
                       BACK_COUNT = BACK_COUNT+1; 
                          newline_1(); 
                          scroll_cursor(); 
                         return;
                                          }
                this_it = m_str_sub_ngt_bf(this_it); 
                this_it = m_ext_in_funct(this_it);  
                this_it = m_ext_in_funct_2(this_it); 
                this_it = this_it.replace(/Q/g , "-"); 
                    var this_it_fst=this_it.substr(0,2);      
                        if(this_it_fst=="-\(" || this_it_fst=="-m"){ var this_it=this_it.substr(1,this_it.length-1);}   
               var this_it_pi_part = this_it.substr(0,50);    
               var this_it_pi_lst_part = this_it.substr(this_it.length-5 ,5);    
               if((this_it.length >=17 && this_it >=10000000000000000)||(this_it_pi_part=="3.141592653589793238462643383279502884197169399375" )||(this_it_pi_part=="0.017453292519943295769236907684886127134428718885")){
                   this_it="'"+this_it+"'";}    
              else{
                 this_it=this_it.toString(); 
                   }
           var this_it=  mtx_str_e_chk_to_str(this_it); 
            var this_data = eval(this_it);  
           
           
            var this_data_error = this_data;     
                this_data=this_data.toString();    
            var this_data_fst = this_data.substr(0,1);
                     if((this_it_fst=="-\("||  this_it_fst=="-m") && this_data_fst=="-" && this_data !=0){         
                          this_data= this_data.substr(1,this_data.length-1) ;}  
                       if((this_it_fst=="-\("||  this_it_fst=="-m") && this_data_fst!="-"  && this_data !=0){
                         this_data= "-"+this_data ;} 
             var  this_data = m_str_e_to_str_point(this_data );
             var  this_data = m_mtx_str_to_e_a(this_data);
             var  nub_x = m_str_power(this_data,0);   
                  if(m_abs(nub_x)<11  && m_abs(nub_x)>0 ){
                       this_data = m_str_e_to_str(this_data);             
                                            }
        var this_data_abs=m_abs(this_data);  
        var this_data_str = m_mtx_e_str(this_data ,1);  
            var data_er_rg ="";
            var data_er_rg = m_sub_error_rg(this_data); 
          
      if( parseFloat(this_data_str) >=0 || parseFloat(this_data_str) < 0){   
              if(data_er_rg != this_data.toString()){   
                  var value_copy=function_data+"="+data_er_rg+";";
                  document.getElementById('input').value = this_s.toString().trim()+function_data+"="+data_er_rg+";";  
                                                             }
               else{
               var deci_dgt= parseInt(document.getElementById('5_0').value); 
               var value_copy =function_data +'='+m_fix(this_data.toString(),deci_dgt).toString()+';'; 
               document.getElementById('input').value = this_s.toString().trim()+function_data+"="+m_fix(this_data.toString(),deci_dgt).toString()+";";    
                               }
                                           }
       else {
          var error_str=this_data_error ;
              error_str=m_str_spc_inter_2word( error_str,"<","->"); 
           if(error_str ==""){ var error_str="system error";}
          document.getElementById('input').value=this_s.toString().trim();  
          document.getElementById('input').value+=" "+error_str+";"; 
         var value_copy=" "+error_str+";"; 
             }
          BACK_MTX[0][BACK_COUNT] = value_copy+"_";              
          BACK_COUNT = BACK_COUNT+1; 
          newline_1();
           s_chang_sum("=");    
           scroll_cursor();    
           click_init() ; 
         }

     function str_inser(str ,index_it, wd){          
       var str=str ;              
       var index_it=index_it;    
       var wd = wd ;             
       var str_leg = str.length;
       var str_new=str.substr(0,index_it) +wd+ str.substr((index_it),str_leg);
           return str_new  ;
       }
  
   function str_wdnb(str,index_it){          
      var str=str ;              
      var index_it=index_it;    
      var str_leg = str.length;
      var nb =0 ; 
           for(var i=index_it; i<str_leg;i++){
               var nb_new = str.substr(index_it,index_it+1) ;
                    if( (nb_new <=9 && nb_new>=0)||( nb_new =".") ||( nb_new ="π")){
                             nb=nb+1;                                               }
                                           }
           
         return nb ;
       }






      
